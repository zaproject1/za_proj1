/*

Copyright (C) 2015 by Marijn Haverbeke <marijnh@gmail.com> and others

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
(function(f){if("object"==typeof exports&&"object"==typeof module)module.exports=f();else{if("function"==typeof define&&define.amd)return define([],f);this.CodeMirror=f()}})(function(){function f(a,c){if(!(this instanceof f))return new f(a,c);this.options=c=c?Ta(c):{};Ta(zf,c,!1);T(c);var k=c.value;"string"==typeof k&&(k=new Ca(k,c.mode,null,c.lineSeparator));this.doc=k;var p=new f.inputStyles[c.inputStyle](this),p=this.display=new G(a,k,p);p.wrapper.CodeMirror=this;H(this);y(this);c.lineWrapping&&
(this.display.wrapper.className+=" CodeMirror-wrap");c.autofocus&&!oc&&p.input.focus();C(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new pc,keySeq:null,specialChars:null};var z=this;R&&11>Z&&setTimeout(function(){z.display.input.reset(!0)},20);Af(this);ke||(Bf(),ke=!0);q(this);this.curOp.forceUpdate=!0;le(this,k);c.autofocus&&!oc||z.hasFocus()?setTimeout(qc(Hd,
this),20):rc(this);for(var b in Sb)if(Sb.hasOwnProperty(b))Sb[b](this,c[b],me);fa(this);c.finishInit&&c.finishInit(this);for(k=0;k<Id.length;++k)Id[k](this);Ua(this);oa&&c.lineWrapping&&"optimizelegibility"==getComputedStyle(p.lineDiv).textRendering&&(p.lineDiv.style.textRendering="auto")}function G(a,c,k){this.input=k;this.scrollbarFiller=K("div",null,"CodeMirror-scrollbar-filler");this.scrollbarFiller.setAttribute("cm-not-content","true");this.gutterFiller=K("div",null,"CodeMirror-gutter-filler");
this.gutterFiller.setAttribute("cm-not-content","true");this.lineDiv=K("div",null,"CodeMirror-code");this.selectionDiv=K("div",null,null,"position: relative; z-index: 1");this.cursorDiv=K("div",null,"CodeMirror-cursors");this.measure=K("div",null,"CodeMirror-measure");this.lineMeasure=K("div",null,"CodeMirror-measure");this.lineSpace=K("div",[this.measure,this.lineMeasure,this.selectionDiv,this.cursorDiv,this.lineDiv],null,"position: relative; outline: none");this.mover=K("div",[K("div",[this.lineSpace],
"CodeMirror-lines")],null,"position: relative");this.sizer=K("div",[this.mover],"CodeMirror-sizer");this.sizerWidth=null;this.heightForcer=K("div",null,null,"position: absolute; height: "+ne+"px; width: 1px;");this.gutters=K("div",null,"CodeMirror-gutters");this.lineGutter=null;this.scroller=K("div",[this.sizer,this.heightForcer,this.gutters],"CodeMirror-scroll");this.scroller.setAttribute("tabIndex","-1");this.wrapper=K("div",[this.scrollbarFiller,this.gutterFiller,this.scroller],"CodeMirror");R&&
8>Z&&(this.gutters.style.zIndex=-1,this.scroller.style.paddingRight=0);oa||tb&&oc||(this.scroller.draggable=!0);a&&(a.appendChild?a.appendChild(this.wrapper):a(this.wrapper));this.reportedViewFrom=this.reportedViewTo=this.viewFrom=this.viewTo=c.first;this.view=[];this.externalMeasured=this.renderedView=null;this.lastWrapHeight=this.lastWrapWidth=this.viewOffset=0;this.updateLineNumbers=null;this.nativeBarWidth=this.barHeight=this.barWidth=0;this.scrollbarsClipped=!1;this.lineNumWidth=this.lineNumInnerWidth=
this.lineNumChars=null;this.alignWidgets=!1;this.maxLine=this.cachedCharWidth=this.cachedTextHeight=this.cachedPaddingH=null;this.maxLineLength=0;this.maxLineChanged=!1;this.wheelDX=this.wheelDY=this.wheelStartX=this.wheelStartY=null;this.shift=!1;this.activeTouch=this.selForContextMenu=null;k.init(this)}function I(a){a.doc.mode=f.getMode(a.options,a.doc.modeOption);l(a)}function l(a){a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null)});a.doc.frontier=a.doc.first;ob(a,
100);a.state.modeGen++;a.curOp&&za(a)}function s(a){var c=A(a.display),k=a.options.lineWrapping,p=k&&Math.max(5,a.display.scroller.clientWidth/E(a.display)-3);return function(z){if(ub(a.doc,z))return 0;var b=0;if(z.widgets)for(var d=0;d<z.widgets.length;d++)z.widgets[d].height&&(b+=z.widgets[d].height);return k?b+(Math.ceil(z.text.length/p)||1)*c:b+c}}function n(a){var c=a.doc,k=s(a);c.iter(function(a){var c=k(a);c!=a.height&&ab(a,c)})}function y(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,
"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-");wb(a)}function B(a){H(a);za(a);setTimeout(function(){ja(a)},20)}function H(a){var c=a.display.gutters,k=a.options.gutters;xb(c);for(var p=0;p<k.length;++p){var z=k[p],b=c.appendChild(K("div",null,"CodeMirror-gutter "+z));"CodeMirror-linenumbers"==z&&(a.display.lineGutter=b,b.style.width=(a.display.lineNumWidth||1)+"px")}c.style.display=p?"":"none";w(a)}function w(a){a.display.sizer.style.marginLeft=a.display.gutters.offsetWidth+"px"}function r(a){if(0==
a.height)return 0;for(var c=a.text.length,k,p=a;k=yb(p,!0);)k=k.find(0,!0),p=k.from.line,c+=k.from.ch-k.to.ch;for(p=a;k=yb(p,!1);)k=k.find(0,!0),c-=p.text.length-k.from.ch,p=k.to.line,c+=p.text.length-k.to.ch;return c}function x(a){var c=a.display;a=a.doc;c.maxLine=L(a,a.first);c.maxLineLength=r(c.maxLine);c.maxLineChanged=!0;a.iter(function(a){var p=r(a);p>c.maxLineLength&&(c.maxLineLength=p,c.maxLine=a)})}function T(a){var c=sa(a.gutters,"CodeMirror-linenumbers");-1==c&&a.lineNumbers?a.gutters=
a.gutters.concat(["CodeMirror-linenumbers"]):-1<c&&!a.lineNumbers&&(a.gutters=a.gutters.slice(0),a.gutters.splice(c,1))}function v(a){var c=a.display,k=c.gutters.offsetWidth,p=Math.round(a.doc.height+sc(a.display));return{clientHeight:c.scroller.clientHeight,viewHeight:c.wrapper.clientHeight,scrollWidth:c.scroller.scrollWidth,clientWidth:c.scroller.clientWidth,viewWidth:c.wrapper.clientWidth,barLeft:a.options.fixedGutter?k:0,docHeight:p,scrollHeight:p+J(a)+c.barHeight,nativeBarWidth:c.nativeBarWidth,
gutterWidth:k}}function D(a,c,k){this.cm=k;var p=this.vert=K("div",[K("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),z=this.horiz=K("div",[K("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");a(p);a(z);M(p,"scroll",function(){p.clientHeight&&c(p.scrollTop,"vertical")});M(z,"scroll",function(){z.clientWidth&&c(z.scrollLeft,"horizontal")});this.checkedOverlay=!1;R&&8>Z&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function aa(){}function C(a){a.display.scrollbars&&
(a.display.scrollbars.clear(),a.display.scrollbars.addClass&&tc(a.display.wrapper,a.display.scrollbars.addClass));a.display.scrollbars=new f.scrollbarModel[a.options.scrollbarStyle](function(c){a.display.wrapper.insertBefore(c,a.display.scrollbarFiller);M(c,"mousedown",function(){a.state.focused&&setTimeout(function(){a.display.input.focus()},0)});c.setAttribute("cm-not-content","true")},function(c,k){"horizontal"==k?Tb(a,c):uc(a,c)},a);a.display.scrollbars.addClass&&vc(a.display.wrapper,a.display.scrollbars.addClass)}
function u(a,c){c||(c=v(a));var k=a.display.barWidth,p=a.display.barHeight;S(a,c);for(var z=0;4>z&&k!=a.display.barWidth||p!=a.display.barHeight;z++)k!=a.display.barWidth&&a.options.lineWrapping&&ka(a),S(a,v(a)),k=a.display.barWidth,p=a.display.barHeight}function S(a,c){var k=a.display,p=k.scrollbars.update(c);k.sizer.style.paddingRight=(k.barWidth=p.right)+"px";k.sizer.style.paddingBottom=(k.barHeight=p.bottom)+"px";p.right&&p.bottom?(k.scrollbarFiller.style.display="block",k.scrollbarFiller.style.height=
p.bottom+"px",k.scrollbarFiller.style.width=p.right+"px"):k.scrollbarFiller.style.display="";p.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(k.gutterFiller.style.display="block",k.gutterFiller.style.height=p.bottom+"px",k.gutterFiller.style.width=c.gutterWidth+"px"):k.gutterFiller.style.display=""}function Ha(a,c,k){var p=k&&null!=k.top?Math.max(0,k.top):a.scroller.scrollTop,p=Math.floor(p-a.lineSpace.offsetTop),z=k&&null!=k.bottom?k.bottom:p+a.wrapper.clientHeight,p=zb(c,p),
z=zb(c,z);if(k&&k.ensure){var b=k.ensure.from.line;k=k.ensure.to.line;b<p?(p=b,z=zb(c,bb(L(c,b))+a.wrapper.clientHeight)):Math.min(k,c.lastLine())>=z&&(p=zb(c,bb(L(c,k))-a.wrapper.clientHeight),z=k)}return{from:p,to:Math.max(z,p+1)}}function ja(a){var c=a.display,k=c.view;if(c.alignWidgets||c.gutters.firstChild&&a.options.fixedGutter){for(var p=va(c)-c.scroller.scrollLeft+a.doc.scrollLeft,z=c.gutters.offsetWidth,b=p+"px",d=0;d<k.length;d++)if(!k[d].hidden){a.options.fixedGutter&&k[d].gutter&&(k[d].gutter.style.left=
b);var e=k[d].alignable;if(e)for(var g=0;g<e.length;g++)e[g].style.left=b}a.options.fixedGutter&&(c.gutters.style.left=p+z+"px")}}function fa(a){if(!a.options.lineNumbers)return!1;var c=a.doc,c=ga(a.options,c.first+c.size-1),k=a.display;if(c.length!=k.lineNumChars){var p=k.measure.appendChild(K("div",[K("div",c)],"CodeMirror-linenumber CodeMirror-gutter-elt")),z=p.firstChild.offsetWidth,p=p.offsetWidth-z;k.lineGutter.style.width="";k.lineNumInnerWidth=Math.max(z,k.lineGutter.offsetWidth-p)+1;k.lineNumWidth=
k.lineNumInnerWidth+p;k.lineNumChars=k.lineNumInnerWidth?c.length:-1;k.lineGutter.style.width=k.lineNumWidth+"px";w(a);return!0}return!1}function ga(a,c){return String(a.lineNumberFormatter(c+a.firstLineNumber))}function va(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function Ia(a,c,k){var p=a.display;this.viewport=c;this.visible=Ha(p,a.doc,c);this.editorIsHidden=!p.wrapper.offsetWidth;this.wrapperHeight=p.wrapper.clientHeight;this.wrapperWidth=p.wrapper.clientWidth;
this.oldDisplayWidth=Ea(a);this.force=k;this.dims=ta(a);this.events=[]}function Q(a,c){var k=a.display,p=a.doc;if(c.editorIsHidden)return pb(a),!1;if(!c.force&&c.visible.from>=k.viewFrom&&c.visible.to<=k.viewTo&&(null==k.updateLineNumbers||k.updateLineNumbers>=k.viewTo)&&k.renderedView==k.view&&0==oe(a))return!1;fa(a)&&(pb(a),c.dims=ta(a));var z=p.first+p.size,b=Math.max(c.visible.from-a.options.viewportMargin,p.first),d=Math.min(z,c.visible.to+a.options.viewportMargin);k.viewFrom<b&&20>b-k.viewFrom&&
(b=Math.max(p.first,k.viewFrom));k.viewTo>d&&20>k.viewTo-d&&(d=Math.min(z,k.viewTo));qb&&(b=Jd(a.doc,b),d=pe(a.doc,d));p=b!=k.viewFrom||d!=k.viewTo||k.lastWrapHeight!=c.wrapperHeight||k.lastWrapWidth!=c.wrapperWidth;z=a.display;0==z.view.length||b>=z.viewTo||d<=z.viewFrom?(z.view=dd(a,b,d),z.viewFrom=b):(z.viewFrom>b?z.view=dd(a,b,z.viewFrom).concat(z.view):z.viewFrom<b&&(z.view=z.view.slice(Ab(a,b))),z.viewFrom=b,z.viewTo<d?z.view=z.view.concat(dd(a,z.viewTo,d)):z.viewTo>d&&(z.view=z.view.slice(0,
Ab(a,d))));z.viewTo=d;k.viewOffset=bb(L(a.doc,k.viewFrom));a.display.mover.style.top=k.viewOffset+"px";d=oe(a);if(!p&&0==d&&!c.force&&k.renderedView==k.view&&(null==k.updateLineNumbers||k.updateLineNumbers>=k.viewTo))return!1;b=cb();4<d&&(k.lineDiv.style.display="none");ba(a,k.updateLineNumbers,c.dims);4<d&&(k.lineDiv.style.display="");k.renderedView=k.view;b&&cb()!=b&&b.offsetHeight&&b.focus();xb(k.cursorDiv);xb(k.selectionDiv);k.gutters.style.height=k.sizer.style.minHeight=0;p&&(k.lastWrapHeight=
c.wrapperHeight,k.lastWrapWidth=c.wrapperWidth,ob(a,400));k.updateLineNumbers=null;return!0}function la(a,c){for(var k=c.viewport,p=!0;;p=!1){if(!p||!a.options.lineWrapping||c.oldDisplayWidth==Ea(a))if(k&&null!=k.top&&(k={top:Math.min(a.doc.height+sc(a.display)-Na(a),k.top)}),c.visible=Ha(a.display,a.doc,k),c.visible.from>=a.display.viewFrom&&c.visible.to<=a.display.viewTo)break;if(!Q(a,c))break;ka(a);p=v(a);Bb(a);qa(a,p);u(a,p)}c.signal(a,"update",a);if(a.display.viewFrom!=a.display.reportedViewFrom||
a.display.viewTo!=a.display.reportedViewTo)c.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=a.display.viewFrom,a.display.reportedViewTo=a.display.viewTo}function $(a,c){var k=new Ia(a,c);if(Q(a,k)){ka(a);la(a,k);var p=v(a);Bb(a);qa(a,p);u(a,p);k.finish()}}function qa(a,c){a.display.sizer.style.minHeight=c.docHeight+"px";var k=c.docHeight+a.display.barHeight;a.display.heightForcer.style.top=k+"px";a.display.gutters.style.height=Math.max(k+J(a),c.clientHeight)+
"px"}function ka(a){a=a.display;for(var c=a.lineDiv.offsetTop,k=0;k<a.view.length;k++){var p=a.view[k],z;if(!p.hidden){if(R&&8>Z){var b=p.node.offsetTop+p.node.offsetHeight;z=b-c;c=b}else z=p.node.getBoundingClientRect(),z=z.bottom-z.top;b=p.line.height-z;2>z&&(z=A(a));if(.001<b||-.001>b)if(ab(p.line,z),W(p.line),p.rest)for(z=0;z<p.rest.length;z++)W(p.rest[z])}}}function W(a){if(a.widgets)for(var c=0;c<a.widgets.length;++c)a.widgets[c].height=a.widgets[c].node.offsetHeight}function ta(a){for(var c=
a.display,k={},p={},z=c.gutters.clientLeft,b=c.gutters.firstChild,d=0;b;b=b.nextSibling,++d)k[a.options.gutters[d]]=b.offsetLeft+b.clientLeft+z,p[a.options.gutters[d]]=b.clientWidth;return{fixedPos:va(c),gutterTotalWidth:c.gutters.offsetWidth,gutterLeft:k,gutterWidth:p,wrapperWidth:c.wrapper.clientWidth}}function ba(a,c,k){function p(c){var k=c.nextSibling;oa&&Va&&a.display.currentWheelTarget==c?c.style.display="none":c.parentNode.removeChild(c);return k}for(var z=a.display,b=a.options.lineNumbers,
d=z.lineDiv,e=d.firstChild,g=z.view,z=z.viewFrom,h=0;h<g.length;h++){var m=g[h];if(!m.hidden)if(m.node&&m.node.parentNode==d){for(;e!=m.node;)e=p(e);e=b&&null!=c&&c<=z&&m.lineNumber;m.changes&&(-1<sa(m.changes,"gutter")&&(e=!1),ra(a,m,z,k));e&&(xb(m.lineNumber),m.lineNumber.appendChild(document.createTextNode(ga(a.options,z))));e=m.node.nextSibling}else{var f=Kd(a,m,z,k);d.insertBefore(f,e)}z+=m.size}for(;e;)e=p(e)}function ra(a,c,k,p){for(var z=0;z<c.changes.length;z++){var b=c.changes[z];if("text"==
b){var b=c,d=b.text.className,e=ca(a,b);b.text==b.node&&(b.node=e.pre);b.text.parentNode.replaceChild(e.pre,b.text);b.text=e.pre;e.bgClass!=b.bgClass||e.textClass!=b.textClass?(b.bgClass=e.bgClass,b.textClass=e.textClass,ha(b)):d&&(b.text.className=d)}else if("gutter"==b)Ub(a,c,k,p);else if("class"==b)ha(c);else if("widget"==b){b=a;d=c;e=p;d.alignable&&(d.alignable=null);for(var g=d.node.firstChild,h=void 0;g;g=h)h=g.nextSibling,"CodeMirror-linewidget"==g.className&&d.node.removeChild(g);wc(b,d,e)}}c.changes=
null}function t(a){a.node==a.text&&(a.node=K("div",null,null,"position: relative"),a.text.parentNode&&a.text.parentNode.replaceChild(a.node,a.text),a.node.appendChild(a.text),R&&8>Z&&(a.node.style.zIndex=2));return a.node}function ca(a,c){var k=a.display.externalMeasured;return k&&k.line==c.line?(a.display.externalMeasured=null,c.measure=k.measure,k.built):qe(a,c)}function ha(a){var c=a.bgClass?a.bgClass+" "+(a.line.bgClass||""):a.line.bgClass;c&&(c+=" CodeMirror-linebackground");if(a.background)c?
a.background.className=c:(a.background.parentNode.removeChild(a.background),a.background=null);else if(c){var k=t(a);a.background=k.insertBefore(K("div",null,c),k.firstChild)}a.line.wrapClass?t(a).className=a.line.wrapClass:a.node!=a.text&&(a.node.className="");a.text.className=(a.textClass?a.textClass+" "+(a.line.textClass||""):a.line.textClass)||""}function Ub(a,c,k,p){c.gutter&&(c.node.removeChild(c.gutter),c.gutter=null);c.gutterBackground&&(c.node.removeChild(c.gutterBackground),c.gutterBackground=
null);if(c.line.gutterClass){var z=t(c);c.gutterBackground=K("div",null,"CodeMirror-gutter-background "+c.line.gutterClass,"left: "+(a.options.fixedGutter?p.fixedPos:-p.gutterTotalWidth)+"px; width: "+p.gutterTotalWidth+"px");z.insertBefore(c.gutterBackground,c.text)}var b=c.line.gutterMarkers;if(a.options.lineNumbers||b){var z=t(c),d=c.gutter=K("div",null,"CodeMirror-gutter-wrapper","left: "+(a.options.fixedGutter?p.fixedPos:-p.gutterTotalWidth)+"px");a.display.input.setUneditable(d);z.insertBefore(d,
c.text);c.line.gutterClass&&(d.className+=" "+c.line.gutterClass);!a.options.lineNumbers||b&&b["CodeMirror-linenumbers"]||(c.lineNumber=d.appendChild(K("div",ga(a.options,k),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+p.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.display.lineNumInnerWidth+"px")));if(b)for(c=0;c<a.options.gutters.length;++c)k=a.options.gutters[c],(z=b.hasOwnProperty(k)&&b[k])&&d.appendChild(K("div",[z],"CodeMirror-gutter-elt","left: "+p.gutterLeft[k]+"px; width: "+
p.gutterWidth[k]+"px"))}}function Kd(a,c,k,p){var z=ca(a,c);c.text=c.node=z.pre;z.bgClass&&(c.bgClass=z.bgClass);z.textClass&&(c.textClass=z.textClass);ha(c);Ub(a,c,k,p);wc(a,c,p);return c.node}function wc(a,c,k){xc(a,c.line,c,k,!0);if(c.rest)for(var p=0;p<c.rest.length;p++)xc(a,c.rest[p],c,k,!1)}function xc(a,c,k,p,z){if(c.widgets){var b=t(k),d=0;for(c=c.widgets;d<c.length;++d){var e=c[d],g=K("div",[e.node],"CodeMirror-linewidget");e.handleMouseEvents||g.setAttribute("cm-ignore-events","true");var h=
e,m=g,f=p;if(h.noHScroll){(k.alignable||(k.alignable=[])).push(m);var A=f.wrapperWidth;m.style.left=f.fixedPos+"px";h.coverGutter||(A-=f.gutterTotalWidth,m.style.paddingLeft=f.gutterTotalWidth+"px");m.style.width=A+"px"}h.coverGutter&&(m.style.zIndex=5,m.style.position="relative",h.noHScroll||(m.style.marginLeft=-f.gutterTotalWidth+"px"));a.display.input.setUneditable(g);z&&e.above?b.insertBefore(g,k.gutter||k.text):b.appendChild(g);wa(e,"redraw")}}}function yc(a){return F(a.line,a.ch)}function Cb(a,
c){return 0>P(a,c)?c:a}function db(a,c){return 0>P(a,c)?a:c}function Vb(a){a.state.focused||(a.display.input.focus(),Hd(a))}function ma(a){return a.options.readOnly||a.doc.cantEdit}function Aa(a,c,k,p,z){var b=a.doc;a.display.shift=!1;p||(p=b.sel);var d=a.state.pasteIncoming||"paste"==z,e=b.splitLines(c),g=null;if(d&&1<p.ranges.length)if(Oa&&Oa.join("\n")==c){if(0==p.ranges.length%Oa.length)for(var g=[],h=0;h<Oa.length;h++)g.push(b.splitLines(Oa[h]))}else e.length==p.ranges.length&&(g=ed(e,function(a){return[a]}));
for(h=p.ranges.length-1;0<=h;h--){var m=p.ranges[h],f=m.from(),A=m.to();m.empty()&&(k&&0<k?f=F(f.line,f.ch-k):a.state.overwrite&&!d&&(A=F(A.line,Math.min(L(b,A.line).text.length,A.ch+U(e).length))));m=a.curOp.updateInput;f={from:f,to:A,text:g?g[h%g.length]:e,origin:z||(d?"paste":a.state.cutIncoming?"cut":"+input")};Wb(a.doc,f);wa(a,"inputRead",a,f)}c&&!d&&zc(a,c);Xb(a);a.curOp.updateInput=m;a.curOp.typing=!0;a.state.pasteIncoming=a.state.cutIncoming=!1}function Db(a,c){var k=a.clipboardData&&a.clipboardData.getData("text/plain");
if(k)return a.preventDefault(),ma(c)||c.options.disableInput||da(c,function(){Aa(c,k,0,null,"paste")}),!0}function zc(a,c){if(a.options.electricChars&&a.options.smartIndent)for(var k=a.doc.sel,p=k.ranges.length-1;0<=p;p--){var z=k.ranges[p];if(!(100<z.head.ch||p&&k.ranges[p-1].head.line==z.head.line)){var b=a.getModeAt(z.head),d=!1;if(b.electricChars)for(var e=0;e<b.electricChars.length;e++){if(-1<c.indexOf(b.electricChars.charAt(e))){d=Ac(a,z.head.line,"smart");break}}else b.electricInput&&b.electricInput.test(L(a.doc,
z.head.line).text.slice(0,z.head.ch))&&(d=Ac(a,z.head.line,"smart"));d&&wa(a,"electricInput",a,z.head.line)}}}function Yb(a){for(var c=[],k=[],p=0;p<a.doc.sel.ranges.length;p++){var z=a.doc.sel.ranges[p].head.line,z={anchor:F(z,0),head:F(z+1,0)};k.push(z);c.push(a.getRange(z.anchor,z.head))}return{text:c,ranges:k}}function Pa(a){a.setAttribute("autocorrect","off");a.setAttribute("autocapitalize","off");a.setAttribute("spellcheck","false")}function Zb(a){this.cm=a;this.prevInput="";this.pollingFast=
!1;this.polling=new pc;this.hasSelection=this.inaccurateSelection=!1;this.composing=null}function Bc(){var a=K("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),c=K("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");oa?a.style.width="1000px":a.setAttribute("wrap","off");$b&&(a.style.border="1px solid black");Pa(a);return c}function Ja(a){this.cm=a;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=
null;this.polling=new pc;this.gracePeriod=!1}function Cc(a,c){var k=ac(a,c.line);if(!k||k.hidden)return null;var p=L(a.doc,c.line),k=Wa(k,p,c.line),p=Xa(p),z="left";p&&(z=fd(p,c.ch)%2?"right":"left");k=Dc(k.map,c.ch,z);k.offset="right"==k.collapse?k.end:k.start;return k}function ib(a,c){c&&(a.bad=!0);return a}function X(a,c,k){var p;if(c==a.display.lineDiv){p=a.display.lineDiv.childNodes[k];if(!p)return ib(a.clipPos(F(a.display.viewTo-1)),!0);c=null;k=0}else for(p=c;;p=p.parentNode){if(!p||p==a.display.lineDiv)return null;
if(p.parentNode&&p.parentNode==a.display.lineDiv)break}for(var z=0;z<a.display.view.length;z++){var b=a.display.view[z];if(b.node==p)return bc(b,c,k)}}function bc(a,c,k){function p(c,k,p){for(var b=-1;b<(m?m.length:0);b++)for(var z=0>b?h.map:m[b],d=0;d<z.length;d+=3){var e=z[d+2];if(e==c||e==k){k=Y(0>b?a.line:a.rest[b]);b=z[d]+p;if(0>p||e!=c)b=z[d+(p?1:0)];return F(k,b)}}}var b=a.text.firstChild,d=!1;if(!c||!Ld(b,c))return ib(F(Y(a.line),0),!0);if(c==b&&(d=!0,c=b.childNodes[k],k=0,!c))return k=a.rest?
U(a.rest):a.line,ib(F(Y(k),k.text.length),d);var e=3==c.nodeType?c:null,g=c;e||1!=c.childNodes.length||3!=c.firstChild.nodeType||(e=c.firstChild,k&&(k=e.nodeValue.length));for(;g.parentNode!=b;)g=g.parentNode;var h=a.measure,m=h.maps;if(c=p(e,g,k))return ib(c,d);b=g.nextSibling;for(e=e?e.nodeValue.length-k:0;b;b=b.nextSibling){if(c=p(b,b.firstChild,0))return ib(F(c.line,c.ch-e),d);e+=b.textContent.length}g=g.previousSibling;for(e=k;g;g=g.previousSibling){if(c=p(g,g.firstChild,-1))return ib(F(c.line,
c.ch+e),d);e+=b.textContent.length}}function Eb(a,c,k,p,b){function d(a){return function(c){return c.id==a}}function e(c){if(1==c.nodeType){var k=c.getAttribute("cm-text");if(null!=k)""==k&&(k=c.textContent.replace(/\u200b/g,"")),g+=k;else{var k=c.getAttribute("cm-marker"),f;if(k)c=a.findMarks(F(p,0),F(b+1,0),d(+k)),c.length&&(f=c[0].find())&&(g+=Fb(a.doc,f.from,f.to).join(m));else if("false"!=c.getAttribute("contenteditable")){for(f=0;f<c.childNodes.length;f++)e(c.childNodes[f]);/^(pre|div|p)$/i.test(c.nodeName)&&
(h=!0)}}}else 3==c.nodeType&&(c=c.nodeValue)&&(h&&(g+=m,h=!1),g+=c)}for(var g="",h=!1,m=a.doc.lineSeparator();;){e(c);if(c==k)break;c=c.nextSibling}return g}function Ya(a,c){this.ranges=a;this.primIndex=c}function V(a,c){this.anchor=a;this.head=c}function Fa(a,c){var k=a[c];a.sort(function(a,c){return P(a.from(),c.from())});c=sa(a,k);for(k=1;k<a.length;k++){var p=a[k],b=a[k-1];if(0<=P(b.to(),p.from())){var d=db(b.from(),p.from()),e=Cb(b.to(),p.to()),p=b.empty()?p.from()==p.head:b.from()==b.head;k<=
c&&--c;a.splice(--k,2,new V(p?e:d,p?d:e))}}return new Ya(a,c)}function Ga(a,c){return new Ya([new V(a,c||a)],0)}function N(a,c){if(c.line<a.first)return F(a.first,0);var k=a.first+a.size-1;if(c.line>k)return F(k,L(a,k).text.length);var k=L(a,c.line).text.length,p=c.ch,k=null==p||p>k?F(c.line,k):0>p?F(c.line,0):c;return k}function jb(a,c){return c>=a.first&&c<a.first+a.size}function Gb(a,c,k,p){return a.cm&&a.cm.display.shift||a.extend?(a=c.anchor,p&&(c=0>P(k,a),c!=0>P(p,a)?(a=k,k=p):c!=0>P(k,p)&&
(k=p)),new V(a,k)):new V(p||k,k)}function eb(a,c,k,p){ea(a,new Ya([Gb(a,a.sel.primary(),c,k)],0),p)}function Ec(a,c,k){for(var p=[],b=0;b<a.sel.ranges.length;b++)p[b]=Gb(a,a.sel.ranges[b],c[b],null);c=Fa(p,a.sel.primIndex);ea(a,c,k)}function cc(a,c,k,p){var b=a.sel.ranges.slice(0);b[c]=k;ea(a,Fa(b,a.sel.primIndex),p)}function gd(a,c){var k={ranges:c.ranges,update:function(c){this.ranges=[];for(var k=0;k<c.length;k++)this.ranges[k]=new V(N(a,c[k].anchor),N(a,c[k].head))}};na(a,"beforeSelectionChange",
a,k);a.cm&&na(a.cm,"beforeSelectionChange",a.cm,k);return k.ranges!=c.ranges?Fa(k.ranges,k.ranges.length-1):c}function Fc(a,c,k){var p=a.history.done,b=U(p);b&&b.ranges?(p[p.length-1]=c,Hb(a,c,k)):ea(a,c,k)}function ea(a,c,k){Hb(a,c,k);c=a.sel;var p=a.cm?a.cm.curOp.id:NaN,b=a.history,d=k&&k.origin,e;if(!(e=p==b.lastSelOp)&&(e=d&&b.lastSelOrigin==d)&&!(e=b.lastModTime==b.lastSelTime&&b.lastOrigin==d)){e=U(b.done);var g=d.charAt(0);e="*"==g||"+"==g&&e.ranges.length==c.ranges.length&&e.somethingSelected()==
c.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}e?b.done[b.done.length-1]=c:hd(c,b.done);b.lastSelTime=+new Date;b.lastSelOrigin=d;b.lastSelOp=p;k&&!1!==k.clearRedo&&re(b.undone)}function Hb(a,c,k){if(Qa(a,"beforeSelectionChange")||a.cm&&Qa(a.cm,"beforeSelectionChange"))c=gd(a,c);var p=k&&k.bias||(0>P(c.primary().head,a.sel.primary().head)?-1:1);Gc(a,Hc(a,c,p,!0));k&&!1===k.scroll||!a.cm||Xb(a.cm)}function Gc(a,c){c.equals(a.sel)||(a.sel=c,a.cm&&(a.cm.curOp.updateInput=
a.cm.curOp.selectionChanged=!0,se(a.cm)),wa(a,"cursorActivity",a))}function Ic(a){Gc(a,Hc(a,a.sel,null,!1),fb)}function Hc(a,c,k,p){for(var b,d=0;d<c.ranges.length;d++){var e=c.ranges[d],g=Ib(a,e.anchor,k,p),h=Ib(a,e.head,k,p);if(b||g!=e.anchor||h!=e.head)b||(b=c.ranges.slice(0,d)),b[d]=new V(g,h)}return b?Fa(b,c.primIndex):c}function Ib(a,c,k,p){var b=!1,d=c,e=k||1;a.cantEdit=!1;a:for(;;){var g=L(a,d.line);if(g.markedSpans)for(var h=0;h<g.markedSpans.length;++h){var m=g.markedSpans[h],f=m.marker;
if((null==m.from||(f.inclusiveLeft?m.from<=d.ch:m.from<d.ch))&&(null==m.to||(f.inclusiveRight?m.to>=d.ch:m.to>d.ch))){if(p&&(na(f,"beforeCursorEnter"),f.explicitlyCleared))if(g.markedSpans){--h;continue}else break;if(f.atomic){h=f.find(0>e?-1:1);if(0==P(h,d)&&(h.ch+=e,0>h.ch?h=h.line>a.first?N(a,F(h.line-1)):null:h.ch>g.text.length&&(h=h.line<a.first+a.size-1?F(h.line+1,0):null),!h)){if(b){if(!p)return Ib(a,c,k,!0);a.cantEdit=!0;return F(a.first,0)}b=!0;h=c;e=-e}d=h;continue a}}}return d}}function Bb(a){a.display.input.showSelection(a.display.input.prepareSelection())}
function Jb(a,c){for(var k=a.doc,p={},b=p.cursors=document.createDocumentFragment(),d=p.selection=document.createDocumentFragment(),e=0;e<k.sel.ranges.length;e++)if(!1!==c||e!=k.sel.primIndex){var g=k.sel.ranges[e],h=g.empty();(h||a.options.showCursorWhenSelecting)&&dc(a,g.head,b);h||ec(a,g,d)}return p}function dc(a,c,k){c=d(a,c,"div",null,null,!a.options.singleCursorHeightPerLine);var p=k.appendChild(K("div","\u00a0","CodeMirror-cursor"));p.style.left=c.left+"px";p.style.top=c.top+"px";p.style.height=
Math.max(0,c.bottom-c.top)*a.options.cursorHeight+"px";c.other&&(a=k.appendChild(K("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor")),a.style.display="",a.style.left=c.other.left+"px",a.style.top=c.other.top+"px",a.style.height=.85*(c.other.bottom-c.other.top)+"px")}function ec(a,c,k){function p(a,c,k,p){0>c&&(c=0);c=Math.round(c);p=Math.round(p);g.appendChild(K("div",null,"CodeMirror-selected","position: absolute; left: "+a+"px; top: "+c+"px; width: "+(null==k?f-a:k)+"px; height: "+
(p-c)+"px"))}function z(c,k,z){var d=L(e,c),cd=d.text.length,g,h;Cf(Xa(d),k||0,null==z?cd:z,function(e,vb,pa){var Da=b(a,F(c,e),"div",d,"left"),A,l;e==vb?(A=Da,pa=l=Da.left):(A=b(a,F(c,vb-1),"div",d,"right"),"rtl"==pa&&(pa=Da,Da=A,A=pa),pa=Da.left,l=A.right);null==k&&0==e&&(pa=m);3<A.top-Da.top&&(p(pa,Da.top,null,Da.bottom),pa=m,Da.bottom<A.top&&p(pa,Da.bottom,null,A.top));null==z&&vb==cd&&(l=f);if(!g||Da.top<g.top||Da.top==g.top&&Da.left<g.left)g=Da;if(!h||A.bottom>h.bottom||A.bottom==h.bottom&&
A.right>h.right)h=A;pa<m+1&&(pa=m);p(pa,A.top,l-pa,A.bottom)});return{start:g,end:h}}var d=a.display,e=a.doc,g=document.createDocumentFragment(),h=Jc(a.display),m=h.left,f=Math.max(d.sizerWidth,Ea(a)-d.sizer.offsetLeft)-h.right,d=c.from();c=c.to();if(d.line==c.line)z(d.line,d.ch,c.ch);else{var A=L(e,d.line),h=L(e,c.line),h=gb(A)==gb(h),d=z(d.line,d.ch,h?A.text.length+1:null).end;c=z(c.line,h?0:null,c.ch).start;h&&(d.top<c.top-2?(p(d.right,d.top,null,d.bottom),p(m,c.top,c.left,c.bottom)):p(d.right,
d.top,c.left-d.right,d.bottom));d.bottom<c.top&&p(m,d.bottom,null,c.top)}k.appendChild(g)}function kb(a){if(a.state.focused){var c=a.display;clearInterval(c.blinker);var k=!0;c.cursorDiv.style.visibility="";0<a.options.cursorBlinkRate?c.blinker=setInterval(function(){c.cursorDiv.style.visibility=(k=!k)?"":"hidden"},a.options.cursorBlinkRate):0>a.options.cursorBlinkRate&&(c.cursorDiv.style.visibility="hidden")}}function ob(a,c){a.doc.mode.startState&&a.doc.frontier<a.display.viewTo&&a.state.highlight.set(c,
qc(Md,a))}function Md(a){var c=a.doc;c.frontier<c.first&&(c.frontier=c.first);if(!(c.frontier>=a.display.viewTo)){var k=+new Date+a.options.workTime,p=rb(c.mode,Ba(a,c.frontier)),b=[];c.iter(c.frontier,Math.min(c.first+c.size,a.display.viewTo+500),function(d){if(c.frontier>=a.display.viewFrom){var e=d.styles,g=d.text.length>a.options.maxHighlightLength,h=te(a,d,g?rb(c.mode,p):p,!0);d.styles=h.styles;var m=d.styleClasses;(h=h.classes)?d.styleClasses=h:m&&(d.styleClasses=null);m=!e||e.length!=d.styles.length||
m!=h&&(!m||!h||m.bgClass!=h.bgClass||m.textClass!=h.textClass);for(h=0;!m&&h<e.length;++h)m=e[h]!=d.styles[h];m&&b.push(c.frontier);d.stateAfter=g?p:rb(c.mode,p)}else d.text.length<=a.options.maxHighlightLength&&Nd(a,d.text,p),d.stateAfter=0==c.frontier%5?rb(c.mode,p):null;++c.frontier;if(+new Date>k)return ob(a,a.options.workDelay),!0});b.length&&da(a,function(){for(var c=0;c<b.length;c++)lb(a,b[c],"text")})}}function id(a,c,k){for(var p,b,d=a.doc,e=k?-1:c-(a.doc.mode.innerMode?1E3:100);c>e;--c){if(c<=
d.first)return d.first;var g=L(d,c-1);if(g.stateAfter&&(!k||c<=d.frontier))return c;g=Za(g.text,null,a.options.tabSize);if(null==b||p>g)b=c-1,p=g}return b}function Ba(a,c,k){var p=a.doc,b=a.display;if(!p.mode.startState)return!0;var d=id(a,c,k),e=d>p.first&&L(p,d-1).stateAfter,e=e?rb(p.mode,e):Df(p.mode);p.iter(d,c,function(k){Nd(a,k.text,e);k.stateAfter=d==c-1||0==d%5||d>=b.viewFrom&&d<b.viewTo?rb(p.mode,e):null;++d});k&&(p.frontier=d);return e}function sc(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}
function Jc(a){if(a.cachedPaddingH)return a.cachedPaddingH;var c=Ka(a.measure,K("pre","x")),c=window.getComputedStyle?window.getComputedStyle(c):c.currentStyle,c={left:parseInt(c.paddingLeft),right:parseInt(c.paddingRight)};isNaN(c.left)||isNaN(c.right)||(a.cachedPaddingH=c);return c}function J(a){return ne-a.display.nativeBarWidth}function Ea(a){return a.display.scroller.clientWidth-J(a)-a.display.barWidth}function Na(a){return a.display.scroller.clientHeight-J(a)-a.display.barHeight}function Wa(a,
c,k){if(a.line==c)return{map:a.measure.map,cache:a.measure.cache};for(var p=0;p<a.rest.length;p++)if(a.rest[p]==c)return{map:a.measure.maps[p],cache:a.measure.caches[p]};for(p=0;p<a.rest.length;p++)if(Y(a.rest[p])>k)return{map:a.measure.maps[p],cache:a.measure.caches[p],before:!0}}function ac(a,c){if(c>=a.display.viewFrom&&c<a.display.viewTo)return a.display.view[Ab(a,c)];var k=a.display.externalMeasured;if(k&&c>=k.lineN&&c<k.lineN+k.size)return k}function mb(a,c){var k=Y(c),p=ac(a,k);p&&!p.text?
p=null:p&&p.changes&&(ra(a,p,k,ta(a)),a.curOp.forceUpdate=!0);if(!p){var b;b=gb(c);p=Y(b);b=a.display.externalMeasured=new ue(a.doc,b,p);b.lineN=p;p=b.built=qe(a,b);b.text=p.pre;Ka(a.display.lineMeasure,p.pre);p=b}k=Wa(p,c,k);return{line:c,view:p,rect:null,map:k.map,cache:k.cache,before:k.before,hasHeights:!1}}function Kc(a,c,k,p,b){c.before&&(k=-1);var d=k+(p||"");if(c.cache.hasOwnProperty(d))a=c.cache[d];else{c.rect||(c.rect=c.view.text.getBoundingClientRect());if(!c.hasHeights){var e=c.view,g=
c.rect,h=a.options.lineWrapping,m=h&&Ea(a);if(!e.measure.heights||h&&e.measure.width!=m){var f=e.measure.heights=[];if(h)for(e.measure.width=m,e=e.text.firstChild.getClientRects(),h=0;h<e.length-1;h++){var m=e[h],A=e[h+1];2<Math.abs(m.bottom-A.bottom)&&f.push((m.bottom+A.top)/2-g.top)}f.push(g.bottom-g.top)}c.hasHeights=!0}e=p;h=Dc(c.map,k,e);p=h.node;g=h.start;m=h.end;k=h.collapse;var l;if(3==p.nodeType){for(f=0;4>f;f++){for(;g&&Lc(c.line.text.charAt(h.coverStart+g));)--g;for(;h.coverStart+m<h.coverEnd&&
Lc(c.line.text.charAt(h.coverStart+m));)++m;if(R&&9>Z&&0==g&&m==h.coverEnd-h.coverStart)l=p.parentNode.getBoundingClientRect();else if(R&&a.options.lineWrapping){var q=Kb(p,g,m).getClientRects();l=q.length?q["right"==e?q.length-1:0]:Od}else l=Kb(p,g,m).getBoundingClientRect()||Od;if(l.left||l.right||0==g)break;m=g;--g;k="right"}R&&11>Z&&((q=!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI)||(null!=Pd?q=Pd:(f=Ka(a.display.measure,K("span","x")),q=f.getBoundingClientRect(),
f=Kb(f,0,1).getBoundingClientRect(),q=Pd=1<Math.abs(q.left-f.left)),q=!q),q||(q=screen.logicalXDPI/screen.deviceXDPI,f=screen.logicalYDPI/screen.deviceYDPI,l={left:l.left*q,right:l.right*q,top:l.top*f,bottom:l.bottom*f}))}else 0<g&&(k=e="right"),l=a.options.lineWrapping&&1<(q=p.getClientRects()).length?q["right"==e?q.length-1:0]:p.getBoundingClientRect();!(R&&9>Z)||g||l&&(l.left||l.right)||(l=(l=p.parentNode.getClientRects()[0])?{left:l.left,right:l.left+E(a.display),top:l.top,bottom:l.bottom}:Od);
q=l.top-c.rect.top;p=l.bottom-c.rect.top;g=(q+p)/2;e=c.view.measure.heights;for(f=0;f<e.length-1&&!(g<e[f]);f++);k={left:("right"==k?l.right:l.left)-c.rect.left,right:("left"==k?l.left:l.right)-c.rect.left,top:f?e[f-1]:0,bottom:e[f]};l.left||l.right||(k.bogus=!0);a.options.singleCursorHeightPerLine||(k.rtop=q,k.rbottom=p);a=k;a.bogus||(c.cache[d]=a)}return{left:a.left,right:a.right,top:b?a.rtop:a.top,bottom:b?a.rbottom:a.bottom}}function Dc(a,c,k){for(var p,b,d,e,g=0;g<a.length;g+=3){var h=a[g],m=
a[g+1];if(c<h)b=0,d=1,e="left";else if(c<m)b=c-h,d=b+1;else if(g==a.length-3||c==m&&a[g+3]>c)d=m-h,b=d-1,c>=m&&(e="right");if(null!=b){p=a[g+2];h==m&&k==(p.insertLeft?"left":"right")&&(e=k);if("left"==k&&0==b)for(;g&&a[g-2]==a[g-3]&&a[g-1].insertLeft;)p=a[(g-=3)+2],e="left";if("right"==k&&b==m-h)for(;g<a.length-3&&a[g+3]==a[g+4]&&!a[g+5].insertLeft;)p=a[(g+=3)+2],e="right";break}}return{node:p,start:b,end:d,collapse:e,coverStart:h,coverEnd:m}}function Mc(a){if(a.measure&&(a.measure.cache={},a.measure.heights=
null,a.rest))for(var c=0;c<a.rest.length;c++)a.measure.caches[c]={}}function Nc(a){a.display.externalMeasure=null;xb(a.display.lineMeasure);for(var c=0;c<a.display.view.length;c++)Mc(a.display.view[c])}function wb(a){Nc(a);a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=null;a.options.lineWrapping||(a.display.maxLineChanged=!0);a.display.lineNumChars=null}function fc(a,c,k,p){if(c.widgets)for(var b=0;b<c.widgets.length;++b)if(c.widgets[b].above){var d=Oc(c.widgets[b]);
k.top+=d;k.bottom+=d}if("line"==p)return k;p||(p="local");c=bb(c);c="local"==p?c+a.display.lineSpace.offsetTop:c-a.display.viewOffset;if("page"==p||"window"==p)a=a.display.lineSpace.getBoundingClientRect(),c+=a.top+("window"==p?0:window.pageYOffset||(document.documentElement||document.body).scrollTop),p=a.left+("window"==p?0:window.pageXOffset||(document.documentElement||document.body).scrollLeft),k.left+=p,k.right+=p;k.top+=c;k.bottom+=c;return k}function Ra(a,c,k){if("div"==k)return c;var p=c.left;
c=c.top;"page"==k?(p-=window.pageXOffset||(document.documentElement||document.body).scrollLeft,c-=window.pageYOffset||(document.documentElement||document.body).scrollTop):"local"!=k&&k||(k=a.display.sizer.getBoundingClientRect(),p+=k.left,c+=k.top);a=a.display.lineSpace.getBoundingClientRect();return{left:p-a.left,top:c-a.top}}function b(a,c,k,p,b){p||(p=L(a.doc,c.line));var d=p;c=c.ch;p=Kc(a,mb(a,p),c,b);return fc(a,d,p,k)}function d(a,c,k,p,b,d){function e(c,g){var h=Kc(a,b,c,g?"right":"left",d);
g?h.left=h.right:h.right=h.left;return fc(a,p,h,k)}function g(a,c){var k=h[c],p=k.level%2;a==Qd(k)&&c&&k.level<h[c-1].level?(k=h[--c],a=Rd(k)-(k.level%2?0:1),p=!0):a==Rd(k)&&c<h.length-1&&k.level<h[c+1].level&&(k=h[++c],a=Qd(k)-k.level%2,p=!1);return p&&a==k.to&&a>k.from?e(a-1):e(a,p)}p=p||L(a.doc,c.line);b||(b=mb(a,p));var h=Xa(p);c=c.ch;if(!h)return e(c);var m=fd(h,c),m=g(c,m);null!=Pc&&(m.other=g(c,Pc));return m}function e(a,c){var k=0;c=N(a.doc,c);a.options.lineWrapping||(k=E(a.display)*c.ch);
var p=L(a.doc,c.line),b=bb(p)+a.display.lineSpace.offsetTop;return{left:k,right:k,top:b,bottom:b+p.height}}function g(a,c,k,p){a=F(a,c);a.xRel=p;k&&(a.outside=!0);return a}function m(a,c,k){var p=a.doc;k+=a.display.viewOffset;if(0>k)return g(p.first,0,!0,-1);var b=zb(p,k),d=p.first+p.size-1;if(b>d)return g(p.first+p.size-1,L(p,d).text.length,!0,1);0>c&&(c=0);for(p=L(p,b);;)if(b=h(a,p,b,c,k),d=(p=yb(p,!1))&&p.find(0,!0),p&&(b.ch>d.from.ch||b.ch==d.from.ch&&0<b.xRel))b=Y(p=d.to.line);else return b}
function h(a,c,k,p,b){function e(p){p=d(a,F(k,p),"line",c,A);m=!0;if(h>p.bottom)return p.left-f;if(h<p.top)return p.left+f;m=!1;return p.left}var h=b-bb(c),m=!1,f=2*a.display.wrapper.clientWidth,A=mb(a,c),l=Xa(c),q=c.text.length;b=jd(c);var t=kd(c),E=e(b),n=m,u=e(t),v=m;if(p>u)return g(k,t,v,1);for(;;){if(l?t==b||t==Sd(c,b,1):1>=t-b){l=p<E||p-E<=u-p?b:t;for(p-=l==b?E:u;Lc(c.text.charAt(l));)++l;return g(k,l,l==b?n:v,-1>p?-1:1<p?1:0)}var r=Math.ceil(q/2),s=b+r;if(l)for(var s=b,w=0;w<r;++w)s=Sd(c,s,
1);w=e(s);if(w>p){t=s;u=w;if(v=m)u+=1E3;q=r}else b=s,E=w,n=m,q-=r}}function A(a){if(null!=a.cachedTextHeight)return a.cachedTextHeight;if(null==Lb){Lb=K("pre");for(var c=0;49>c;++c)Lb.appendChild(document.createTextNode("x")),Lb.appendChild(K("br"));Lb.appendChild(document.createTextNode("x"))}Ka(a.measure,Lb);c=Lb.offsetHeight/50;3<c&&(a.cachedTextHeight=c);xb(a.measure);return c||1}function E(a){if(null!=a.cachedCharWidth)return a.cachedCharWidth;var c=K("span","xxxxxxxxxx"),k=K("pre",[c]);Ka(a.measure,
k);c=c.getBoundingClientRect();c=(c.right-c.left)/10;2<c&&(a.cachedCharWidth=c);return c||10}function q(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ef};gc?gc.ops.push(a.curOp):a.curOp.ownsGroup=gc={ops:[a.curOp],delayedCallbacks:[]}}function Ua(a){if(a=a.curOp.ownsGroup)try{var c=
a.delayedCallbacks,k=0;do{for(;k<c.length;k++)c[k].call(null);for(var p=0;p<a.ops.length;p++){var b=a.ops[p];if(b.cursorActivityHandlers)for(;b.cursorActivityCalled<b.cursorActivityHandlers.length;)b.cursorActivityHandlers[b.cursorActivityCalled++].call(null,b.cm)}}while(k<c.length)}finally{gc=null;for(c=0;c<a.ops.length;c++)a.ops[c].cm.curOp=null;a=a.ops;for(c=0;c<a.length;c++){var b=a[c],k=b.cm,e=p=k.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-
e.scroller.clientWidth,e.heightForcer.style.height=J(k)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=J(k)+"px",e.scrollbarsClipped=!0);b.updateMaxLine&&x(k);b.mustUpdate=b.viewChanged||b.forceUpdate||null!=b.scrollTop||b.scrollToPos&&(b.scrollToPos.from.line<p.viewFrom||b.scrollToPos.to.line>=p.viewTo)||p.maxLineChanged&&k.options.lineWrapping;b.update=b.mustUpdate&&new Ia(k,b.mustUpdate&&{top:b.scrollTop,ensure:b.scrollToPos},b.forceUpdate)}for(c=0;c<a.length;c++)b=
a[c],b.updatedDisplay=b.mustUpdate&&Q(b.cm,b.update);for(c=0;c<a.length;c++)if(b=a[c],k=b.cm,p=k.display,b.updatedDisplay&&ka(k),b.barMeasure=v(k),p.maxLineChanged&&!k.options.lineWrapping&&(e=void 0,e=p.maxLine.text.length,e=Kc(k,mb(k,p.maxLine),e,void 0),b.adjustWidthTo=e.left+3,k.display.sizerWidth=b.adjustWidthTo,b.barMeasure.scrollWidth=Math.max(p.scroller.clientWidth,p.sizer.offsetLeft+b.adjustWidthTo+J(k)+k.display.barWidth),b.maxScrollLeft=Math.max(0,p.sizer.offsetLeft+b.adjustWidthTo-Ea(k))),
b.updatedDisplay||b.selectionChanged)b.preparedSelection=p.input.prepareSelection();for(c=0;c<a.length;c++)b=a[c],k=b.cm,null!=b.adjustWidthTo&&(k.display.sizer.style.minWidth=b.adjustWidthTo+"px",b.maxScrollLeft<k.doc.scrollLeft&&Tb(k,Math.min(k.display.scroller.scrollLeft,b.maxScrollLeft),!0),k.display.maxLineChanged=!1),b.preparedSelection&&k.display.input.showSelection(b.preparedSelection),b.updatedDisplay&&qa(k,b.barMeasure),(b.updatedDisplay||b.startHeight!=k.doc.height)&&u(k,b.barMeasure),
b.selectionChanged&&kb(k),k.state.focused&&b.updateInput&&k.display.input.reset(b.typing),b.focus&&b.focus==cb()&&Vb(b.cm);for(c=0;c<a.length;c++){b=a[c];k=b.cm;p=k.display;e=k.doc;b.updatedDisplay&&la(k,b.update);null==p.wheelStartX||null==b.scrollTop&&null==b.scrollLeft&&!b.scrollToPos||(p.wheelStartX=p.wheelStartY=null);null==b.scrollTop||p.scroller.scrollTop==b.scrollTop&&!b.forceScroll||(e.scrollTop=Math.max(0,Math.min(p.scroller.scrollHeight-p.scroller.clientHeight,b.scrollTop)),p.scrollbars.setScrollTop(e.scrollTop),
p.scroller.scrollTop=e.scrollTop);null==b.scrollLeft||p.scroller.scrollLeft==b.scrollLeft&&!b.forceScroll||(e.scrollLeft=Math.max(0,Math.min(p.scroller.scrollWidth-Ea(k),b.scrollLeft)),p.scrollbars.setScrollLeft(e.scrollLeft),p.scroller.scrollLeft=e.scrollLeft,ja(k));if(b.scrollToPos){var g=void 0,h=N(e,b.scrollToPos.from),g=N(e,b.scrollToPos.to),m=b.scrollToPos.margin;null==m&&(m=0);for(var f=0;5>f;f++){var l=!1,A=d(k,h),q=g&&g!=h?d(k,g):A,q=ld(k,Math.min(A.left,q.left),Math.min(A.top,q.top)-m,Math.max(A.left,
q.left),Math.max(A.bottom,q.bottom)+m),t=k.doc.scrollTop,E=k.doc.scrollLeft;null!=q.scrollTop&&(uc(k,q.scrollTop),1<Math.abs(k.doc.scrollTop-t)&&(l=!0));null!=q.scrollLeft&&(Tb(k,q.scrollLeft),1<Math.abs(k.doc.scrollLeft-E)&&(l=!0));if(!l)break}g=A;b.scrollToPos.isCursor&&k.state.focused&&(Sa(k,"scrollCursorIntoView")||(m=k.display,f=m.sizer.getBoundingClientRect(),h=null,0>g.top+f.top?h=!0:g.bottom+f.top>(window.innerHeight||document.documentElement.clientHeight)&&(h=!1),null==h||Ff||(g=K("div",
"\u200b",null,"position: absolute; top: "+(g.top-m.viewOffset-k.display.lineSpace.offsetTop)+"px; height: "+(g.bottom-g.top+J(k)+m.barHeight)+"px; left: "+g.left+"px; width: 2px;"),k.display.lineSpace.appendChild(g),g.scrollIntoView(h),k.display.lineSpace.removeChild(g))))}h=b.maybeHiddenMarkers;g=b.maybeUnhiddenMarkers;if(h)for(m=0;m<h.length;++m)h[m].lines.length||na(h[m],"hide");if(g)for(m=0;m<g.length;++m)g[m].lines.length&&na(g[m],"unhide");p.wrapper.offsetHeight&&(e.scrollTop=k.display.scroller.scrollTop);
b.changeObjs&&na(k,"changes",k,b.changeObjs);b.update&&b.update.finish()}}}function da(a,c){if(a.curOp)return c();q(a);try{return c()}finally{Ua(a)}}function ia(a,c){return function(){if(a.curOp)return c.apply(a,arguments);q(a);try{return c.apply(a,arguments)}finally{Ua(a)}}}function ua(a){return function(){if(this.curOp)return a.apply(this,arguments);q(this);try{return a.apply(this,arguments)}finally{Ua(this)}}}function xa(a){return function(){var c=this.cm;if(!c||c.curOp)return a.apply(this,arguments);
q(c);try{return a.apply(this,arguments)}finally{Ua(c)}}}function ue(a,c,k){for(var b=this.line=c,d;b=yb(b,!1);)b=b.find(1,!0).line,(d||(d=[])).push(b);this.size=(this.rest=d)?Y(U(this.rest))-k+1:1;this.node=this.text=null;this.hidden=ub(a,c)}function dd(a,c,k){var b=[],d;for(d=c;d<k;)c=new ue(a.doc,L(a.doc,d),d),d+=c.size,b.push(c);return b}function za(a,c,k,b){null==c&&(c=a.doc.first);null==k&&(k=a.doc.first+a.doc.size);b||(b=0);var d=a.display;b&&k<d.viewTo&&(null==d.updateLineNumbers||d.updateLineNumbers>
c)&&(d.updateLineNumbers=c);a.curOp.viewChanged=!0;if(c>=d.viewTo)qb&&Jd(a.doc,c)<d.viewTo&&pb(a);else if(k<=d.viewFrom)qb&&pe(a.doc,k+b)>d.viewFrom?pb(a):(d.viewFrom+=b,d.viewTo+=b);else if(c<=d.viewFrom&&k>=d.viewTo)pb(a);else if(c<=d.viewFrom){var e=md(a,k,k+b,1);e?(d.view=d.view.slice(e.index),d.viewFrom=e.lineN,d.viewTo+=b):pb(a)}else if(k>=d.viewTo)(e=md(a,c,c,-1))?(d.view=d.view.slice(0,e.index),d.viewTo=e.lineN):pb(a);else{var e=md(a,c,c,-1),g=md(a,k,k+b,1);e&&g?(d.view=d.view.slice(0,e.index).concat(dd(a,
e.lineN,g.lineN)).concat(d.view.slice(g.index)),d.viewTo+=b):pb(a)}if(a=d.externalMeasured)k<a.lineN?a.lineN+=b:c<a.lineN+a.size&&(d.externalMeasured=null)}function lb(a,c,k){a.curOp.viewChanged=!0;var b=a.display,d=a.display.externalMeasured;d&&c>=d.lineN&&c<d.lineN+d.size&&(b.externalMeasured=null);c<b.viewFrom||c>=b.viewTo||(a=b.view[Ab(a,c)],null!=a.node&&(a=a.changes||(a.changes=[]),-1==sa(a,k)&&a.push(k)))}function pb(a){a.display.viewFrom=a.display.viewTo=a.doc.first;a.display.view=[];a.display.viewOffset=
0}function Ab(a,c){if(c>=a.display.viewTo)return null;c-=a.display.viewFrom;if(0>c)return null;for(var k=a.display.view,b=0;b<k.length;b++)if(c-=k[b].size,0>c)return b}function md(a,c,k,b){var d=Ab(a,c),e=a.display.view;if(!qb||k==a.doc.first+a.doc.size)return{index:d,lineN:k};for(var g=0,h=a.display.viewFrom;g<d;g++)h+=e[g].size;if(h!=c){if(0<b){if(d==e.length-1)return null;c=h+e[d].size-c;d++}else c=h-c;k+=c}for(;Jd(a.doc,k)!=k;){if(d==(0>b?0:e.length-1))return null;k+=b*e[d-(0>b?1:0)].size;d+=
b}return{index:d,lineN:k}}function oe(a){a=a.display.view;for(var c=0,k=0;k<a.length;k++){var b=a[k];b.hidden||b.node&&!b.changes||++c}return c}function Af(a){function c(){b.activeTouch&&(d=setTimeout(function(){b.activeTouch=null},1E3),e=b.activeTouch,e.end=+new Date)}function k(a,c){if(null==c.left)return!0;var k=c.left-a.left,b=c.top-a.top;return 400<k*k+b*b}var b=a.display;M(b.scroller,"mousedown",ia(a,ve));R&&11>Z?M(b.scroller,"dblclick",ia(a,function(c){if(!Sa(a,c)){var k=Mb(a,c);!k||Td(a,c,
"gutterClick",!0,wa)||nb(a.display,c)||(ya(c),c=a.findWordAt(k),eb(a.doc,c.anchor,c.head))}})):M(b.scroller,"dblclick",function(c){Sa(a,c)||ya(c)});Ud||M(b.scroller,"contextmenu",function(c){we(a,c)});var d,e={end:0};M(b.scroller,"touchstart",function(a){var c;1!=a.touches.length?c=!1:(c=a.touches[0],c=1>=c.radiusX&&1>=c.radiusY);c||(clearTimeout(d),c=+new Date,b.activeTouch={start:c,moved:!1,prev:300>=c-e.end?e:null},1==a.touches.length&&(b.activeTouch.left=a.touches[0].pageX,b.activeTouch.top=a.touches[0].pageY))});
M(b.scroller,"touchmove",function(){b.activeTouch&&(b.activeTouch.moved=!0)});M(b.scroller,"touchend",function(d){var e=b.activeTouch;if(e&&!nb(b,d)&&null!=e.left&&!e.moved&&300>new Date-e.start){var z=a.coordsChar(b.activeTouch,"page"),e=!e.prev||k(e,e.prev)?new V(z,z):!e.prev.prev||k(e,e.prev.prev)?a.findWordAt(z):new V(F(z.line,0),N(a.doc,F(z.line+1,0)));a.setSelection(e.anchor,e.head);a.focus();ya(d)}c()});M(b.scroller,"touchcancel",c);M(b.scroller,"scroll",function(){b.scroller.clientHeight&&
(uc(a,b.scroller.scrollTop),Tb(a,b.scroller.scrollLeft,!0),na(a,"scroll",a))});M(b.scroller,"mousewheel",function(c){xe(a,c)});M(b.scroller,"DOMMouseScroll",function(c){xe(a,c)});M(b.wrapper,"scroll",function(){b.wrapper.scrollTop=b.wrapper.scrollLeft=0});b.dragFunctions={enter:function(c){Sa(a,c)||nd(c)},over:function(c){if(!Sa(a,c)){var k=Mb(a,c);if(k){var b=document.createDocumentFragment();dc(a,k,b);a.display.dragCursor||(a.display.dragCursor=K("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),
a.display.lineSpace.insertBefore(a.display.dragCursor,a.display.cursorDiv));Ka(a.display.dragCursor,b)}nd(c)}},start:function(c){if(R&&(!a.state.draggingText||100>+new Date-ye))nd(c);else if(!Sa(a,c)&&!nb(a.display,c)&&(c.dataTransfer.setData("Text",a.getSelection()),c.dataTransfer.setDragImage&&!ze)){var k=K("img",null,null,"position: fixed; left: 0; top: 0;");k.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";$a&&(k.width=k.height=1,a.display.wrapper.appendChild(k),
k._top=k.offsetTop);c.dataTransfer.setDragImage(k,0,0);$a&&k.parentNode.removeChild(k)}},drop:ia(a,Gf),leave:function(){Ae(a)}};var g=b.input.getField();M(g,"keyup",function(c){Be.call(a,c)});M(g,"keydown",ia(a,Ce));M(g,"keypress",ia(a,De));M(g,"focus",qc(Hd,a));M(g,"blur",qc(rc,a))}function Hf(a){var c=a.display;if(c.lastWrapHeight!=c.wrapper.clientHeight||c.lastWrapWidth!=c.wrapper.clientWidth)c.cachedCharWidth=c.cachedTextHeight=c.cachedPaddingH=null,c.scrollbarsClipped=!1,a.setSize()}function nb(a,
c){for(var k=c.target||c.srcElement;k!=a.wrapper;k=k.parentNode)if(!k||1==k.nodeType&&"true"==k.getAttribute("cm-ignore-events")||k.parentNode==a.sizer&&k!=a.mover)return!0}function Mb(a,c,k,b){var d=a.display;if(!k&&"true"==(c.target||c.srcElement).getAttribute("cm-not-content"))return null;var e,g;k=d.lineSpace.getBoundingClientRect();try{e=c.clientX-k.left,g=c.clientY-k.top}catch(h){return null}c=m(a,e,g);var f;b&&1==c.xRel&&(f=L(a.doc,c.line).text).length==c.ch&&(b=Za(f,f.length,a.options.tabSize)-
f.length,c=F(c.line,Math.max(0,Math.round((e-Jc(a.display).left)/E(a.display))-b)));return c}function ve(a){var c=this.display;if(!(c.activeTouch&&c.input.supportsTouch()||Sa(this,a)))if(c.shift=a.shiftKey,nb(c,a))oa||(c.scroller.draggable=!1,setTimeout(function(){c.scroller.draggable=!0},100));else if(!Td(this,a,"gutterClick",!0,wa)){var k=Mb(this,a);window.focus();switch(Ee(a)){case 1:this.state.selectingText?this.state.selectingText(a):k?If(this,a,k):(a.target||a.srcElement)==c.scroller&&ya(a);
break;case 2:oa&&(this.state.lastMiddleDown=+new Date);k&&eb(this.doc,k);setTimeout(function(){c.input.focus()},20);ya(a);break;case 3:Ud?we(this,a):Jf(this)}}}function If(a,c,k){R?setTimeout(qc(Vb,a),0):a.curOp.focus=cb();var b=+new Date,d;od&&od.time>b-400&&0==P(od.pos,k)?d="triple":pd&&pd.time>b-400&&0==P(pd.pos,k)?(d="double",od={time:b,pos:k}):(d="single",pd={time:b,pos:k});var b=a.doc.sel,e=Va?c.metaKey:c.ctrlKey,g;a.options.dragDrop&&Kf&&!ma(a)&&"single"==d&&-1<(g=b.contains(k))&&(0>P((g=b.ranges[g]).from(),
k)||0<k.xRel)&&(0<P(g.to(),k)||0>k.xRel)?Lf(a,c,k,e):Mf(a,c,k,d,e)}function Lf(a,c,k,b){var d=a.display,e=+new Date,g=ia(a,function(h){oa&&(d.scroller.draggable=!1);a.state.draggingText=!1;hb(document,"mouseup",g);hb(d.scroller,"drop",g);10>Math.abs(c.clientX-h.clientX)+Math.abs(c.clientY-h.clientY)&&(ya(h),!b&&+new Date-200<e&&eb(a.doc,k),oa||R&&9==Z?setTimeout(function(){document.body.focus();d.input.focus()},20):d.input.focus())});oa&&(d.scroller.draggable=!0);a.state.draggingText=g;d.scroller.dragDrop&&
d.scroller.dragDrop();M(document,"mouseup",g);M(d.scroller,"drop",g)}function Mf(a,c,k,b,d){function e(c){if(0!=P(n,c))if(n=c,"rect"==b){for(var d=[],z=a.options.tabSize,g=Za(L(f,k.line).text,k.ch,z),h=Za(L(f,c.line).text,c.ch,z),m=Math.min(g,h),g=Math.max(g,h),h=Math.min(k.line,c.line),cd=Math.min(a.lastLine(),Math.max(k.line,c.line));h<=cd;h++){var vb=L(f,h).text,pa=Fe(vb,m,z);m==g?d.push(new V(F(h,pa),F(h,pa))):vb.length>pa&&d.push(new V(F(h,pa),F(h,Fe(vb,g,z))))}d.length||d.push(new V(k,k));ea(f,
Fa(q.ranges.slice(0,l).concat(d),l),{origin:"*mouse",scroll:!1});a.scrollIntoView(c)}else d=A,z=d.anchor,m=c,"single"!=b&&(c="double"==b?a.findWordAt(c):new V(F(c.line,0),N(f,F(c.line+1,0))),0<P(c.anchor,z)?(m=c.head,z=db(d.from(),c.anchor)):(m=c.anchor,z=Cb(d.to(),c.head))),d=q.ranges.slice(0),d[l]=new V(N(f,z),m),ea(f,Fa(d,l),Vd)}function g(c){var k=++v,d=Mb(a,c,!0,"rect"==b);if(d)if(0!=P(d,n)){a.curOp.focus=cb();e(d);var z=Ha(m,f);(d.line>=z.to||d.line<z.from)&&setTimeout(ia(a,function(){v==k&&
g(c)}),150)}else{var h=c.clientY<u.top?-20:c.clientY>u.bottom?20:0;h&&setTimeout(ia(a,function(){v==k&&(m.scroller.scrollTop+=h,g(c))}),50)}}function h(c){a.state.selectingText=!1;v=Infinity;ya(c);m.input.focus();hb(document,"mousemove",r);hb(document,"mouseup",s);f.history.lastSelOrigin=null}var m=a.display,f=a.doc;ya(c);var A,l,q=f.sel,t=q.ranges;d&&!c.shiftKey?(l=f.sel.contains(k),A=-1<l?t[l]:new V(k,k)):(A=f.sel.primary(),l=f.sel.primIndex);if(c.altKey)b="rect",d||(A=new V(k,k)),k=Mb(a,c,!0,!0),
l=-1;else if("double"==b){var E=a.findWordAt(k);A=a.display.shift||f.extend?Gb(f,A,E.anchor,E.head):E}else"triple"==b?(E=new V(F(k.line,0),N(f,F(k.line+1,0))),A=a.display.shift||f.extend?Gb(f,A,E.anchor,E.head):E):A=Gb(f,A,k);d?-1==l?(l=t.length,ea(f,Fa(t.concat([A]),l),{scroll:!1,origin:"*mouse"})):1<t.length&&t[l].empty()&&"single"==b&&!c.shiftKey?(ea(f,Fa(t.slice(0,l).concat(t.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),q=f.sel):cc(f,l,A,Vd):(l=0,ea(f,new Ya([A],0),Vd),q=f.sel);var n=k,u=m.wrapper.getBoundingClientRect(),
v=0,r=ia(a,function(a){Ee(a)?g(a):h(a)}),s=ia(a,h);a.state.selectingText=s;M(document,"mousemove",r);M(document,"mouseup",s)}function Td(a,c,k,b,d){try{var e=c.clientX,g=c.clientY}catch(h){return!1}if(e>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;b&&ya(c);b=a.display;var m=b.lineDiv.getBoundingClientRect();if(g>m.bottom||!Qa(a,k))return Wd(c);g-=m.top-b.viewOffset;for(m=0;m<a.options.gutters.length;++m){var f=b.gutters.childNodes[m];if(f&&f.getBoundingClientRect().right>=
e)return e=zb(a.doc,g),d(a,k,a,e,a.options.gutters[m],c),Wd(c)}}function Gf(a){var c=this;Ae(c);if(!Sa(c,a)&&!nb(c.display,a)){ya(a);R&&(ye=+new Date);var k=Mb(c,a,!0),b=a.dataTransfer.files;if(k&&!ma(c))if(b&&b.length&&window.FileReader&&window.File){var d=b.length,e=Array(d),g=0;a=function(a,b){if(!c.options.allowDropFileTypes||-1!=sa(c.options.allowDropFileTypes,a.type)){var p=new FileReader;p.onload=ia(c,function(){var a=p.result;/[\x00-\x08\x0e-\x1f]{2}/.test(a)&&(a="");e[b]=a;++g==d&&(k=N(c.doc,
k),a={from:k,to:k,text:c.doc.splitLines(e.join(c.doc.lineSeparator())),origin:"paste"},Wb(c.doc,a),Fc(c.doc,Ga(k,Nb(a))))});p.readAsText(a)}};for(var h=0;h<d;++h)a(b[h],h)}else if(c.state.draggingText&&-1<c.doc.sel.contains(k))c.state.draggingText(a),setTimeout(function(){c.display.input.focus()},20);else try{if(e=a.dataTransfer.getData("Text")){if(c.state.draggingText&&(Va?!a.altKey:!a.ctrlKey))var m=c.listSelections();Hb(c.doc,Ga(k,k));if(m)for(h=0;h<m.length;++h)hc(c.doc,"",m[h].anchor,m[h].head,
"drag");c.replaceSelection(e,"around","paste");c.display.input.focus()}}catch(f){}}}function Ae(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=null)}function uc(a,c){2>Math.abs(a.doc.scrollTop-c)||(a.doc.scrollTop=c,tb||$(a,{top:c}),a.display.scroller.scrollTop!=c&&(a.display.scroller.scrollTop=c),a.display.scrollbars.setScrollTop(c),tb&&$(a),ob(a,100))}function Tb(a,c,k){(k?c==a.doc.scrollLeft:2>Math.abs(a.doc.scrollLeft-c))||(c=Math.min(c,a.display.scroller.scrollWidth-
a.display.scroller.clientWidth),a.doc.scrollLeft=c,ja(a),a.display.scroller.scrollLeft!=c&&(a.display.scroller.scrollLeft=c),a.display.scrollbars.setScrollLeft(c))}function xe(a,c){var k=Ge(c),b=k.x,k=k.y,d=a.display,e=d.scroller,g=e.scrollWidth>e.clientWidth,h=e.scrollHeight>e.clientHeight;if(b&&g||k&&h){if(k&&Va&&oa){var g=c.target,m=d.view;a:for(;g!=e;g=g.parentNode)for(var f=0;f<m.length;f++)if(m[f].node==g){a.display.currentWheelTarget=g;break a}}!b||tb||$a||null==La?(k&&null!=La&&(h=k*La,g=
a.doc.scrollTop,m=g+d.wrapper.clientHeight,0>h?g=Math.max(0,g+h-50):m=Math.min(a.doc.height,m+h+50),$(a,{top:g,bottom:m})),20>qd&&(null==d.wheelStartX?(d.wheelStartX=e.scrollLeft,d.wheelStartY=e.scrollTop,d.wheelDX=b,d.wheelDY=k,setTimeout(function(){if(null!=d.wheelStartX){var a=e.scrollLeft-d.wheelStartX,c=e.scrollTop-d.wheelStartY,a=c&&d.wheelDY&&c/d.wheelDY||a&&d.wheelDX&&a/d.wheelDX;d.wheelStartX=d.wheelStartY=null;a&&(La=(La*qd+a)/(qd+1),++qd)}},200)):(d.wheelDX+=b,d.wheelDY+=k))):(k&&h&&uc(a,
Math.max(0,Math.min(e.scrollTop+k*La,e.scrollHeight-e.clientHeight))),Tb(a,Math.max(0,Math.min(e.scrollLeft+b*La,e.scrollWidth-e.clientWidth))),(!k||k&&h)&&ya(c),d.wheelStartX=null)}}function rd(a,c,k){if("string"==typeof c&&(c=sd[c],!c))return!1;a.display.input.ensurePolled();var b=a.display.shift,d=!1;try{ma(a)&&(a.state.suppressEdits=!0),k&&(a.display.shift=!1),d=c(a)!=He}finally{a.display.shift=b,a.state.suppressEdits=!1}return d}function Nf(a,c,k){for(var b=0;b<a.state.keyMaps.length;b++){var d=
Qc(c,a.state.keyMaps[b],k,a);if(d)return d}return a.options.extraKeys&&Qc(c,a.options.extraKeys,k,a)||Qc(c,a.options.keyMap,k,a)}function td(a,c,k,b){var d=a.state.keySeq;if(d){if(Of(c))return"handled";Pf.set(50,function(){a.state.keySeq==d&&(a.state.keySeq=null,a.display.input.reset())});c=d+" "+c}b=Nf(a,c,b);"multi"==b&&(a.state.keySeq=c);"handled"==b&&wa(a,"keyHandled",a,c,k);if("handled"==b||"multi"==b)ya(k),kb(a);return d&&!b&&/\'$/.test(c)?(ya(k),!0):!!b}function Ie(a,c){var k=Qf(c,!0);return k?
c.shiftKey&&!a.state.keySeq?td(a,"Shift-"+k,c,function(c){return rd(a,c,!0)})||td(a,k,c,function(c){if("string"==typeof c?/^go[A-Z]/.test(c):c.motion)return rd(a,c)}):td(a,k,c,function(c){return rd(a,c)}):!1}function Rf(a,c,k){return td(a,"'"+k+"'",c,function(c){return rd(a,c,!0)})}function Ce(a){this.curOp.focus=cb();if(!Sa(this,a)){R&&11>Z&&27==a.keyCode&&(a.returnValue=!1);var c=a.keyCode;this.display.shift=16==c||a.shiftKey;var k=Ie(this,a);$a&&(Xd=k?c:null,!k&&88==c&&!Je&&(Va?a.metaKey:a.ctrlKey)&&
this.replaceSelection("",null,"cut"));18!=c||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||Sf(this)}}function Sf(a){function c(a){18!=a.keyCode&&a.altKey||(tc(k,"CodeMirror-crosshair"),hb(document,"keyup",c),hb(document,"mouseover",c))}var k=a.display.lineDiv;vc(k,"CodeMirror-crosshair");M(document,"keyup",c);M(document,"mouseover",c)}function Be(a){16==a.keyCode&&(this.doc.sel.shift=!1);Sa(this,a)}function De(a){if(!(nb(this.display,a)||Sa(this,a)||a.ctrlKey&&!a.altKey||Va&&a.metaKey)){var c=
a.keyCode,k=a.charCode;if($a&&c==Xd)Xd=null,ya(a);else if(!$a||a.which&&!(10>a.which)||!Ie(this,a))if(c=String.fromCharCode(null==k?c:k),!Rf(this,a,c))this.display.input.onKeyPress(a)}}function Jf(a){a.state.delayingBlurEvent=!0;setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1,rc(a))},100)}function Hd(a){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1);"nocursor"!=a.options.readOnly&&(a.state.focused||(na(a,"focus",a),a.state.focused=!0,vc(a.display.wrapper,
"CodeMirror-focused"),a.curOp||a.display.selForContextMenu==a.doc.sel||(a.display.input.reset(),oa&&setTimeout(function(){a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),kb(a))}function rc(a){a.state.delayingBlurEvent||(a.state.focused&&(na(a,"blur",a),a.state.focused=!1,tc(a.display.wrapper,"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.display.shift=!1)},150))}function we(a,c){var k;(k=nb(a.display,c))||(k=Qa(a,"gutterContextMenu")?
Td(a,c,"gutterContextMenu",!1,na):!1);if(!k&&!Sa(a,c,"contextmenu"))a.display.input.onContextMenu(c)}function Ke(a,c){if(0>P(a,c.from))return a;if(0>=P(a,c.to))return Nb(c);var k=a.line+c.text.length-(c.to.line-c.from.line)-1,b=a.ch;a.line==c.to.line&&(b+=Nb(c).ch-c.to.ch);return F(k,b)}function Yd(a,c){for(var k=[],b=0;b<a.sel.ranges.length;b++){var d=a.sel.ranges[b];k.push(new V(Ke(d.anchor,c),Ke(d.head,c)))}return Fa(k,a.sel.primIndex)}function Le(a,c,k){return a.line==c.line?F(k.line,a.ch-c.ch+
k.ch):F(k.line+(a.line-c.line),a.ch)}function Me(a,c,k){c={canceled:!1,from:c.from,to:c.to,text:c.text,origin:c.origin,cancel:function(){this.canceled=!0}};k&&(c.update=function(c,k,b,d){c&&(this.from=N(a,c));k&&(this.to=N(a,k));b&&(this.text=b);void 0!==d&&(this.origin=d)});na(a,"beforeChange",a,c);a.cm&&na(a.cm,"beforeChange",a.cm,c);return c.canceled?null:{from:c.from,to:c.to,text:c.text,origin:c.origin}}function Wb(a,c,k){if(a.cm){if(!a.cm.curOp)return ia(a.cm,Wb)(a,c,k);if(a.cm.state.suppressEdits)return}if(Qa(a,
"beforeChange")||a.cm&&Qa(a.cm,"beforeChange"))if(c=Me(a,c,!0),!c)return;if(k=Ne&&!k&&Tf(a,c.from,c.to))for(var b=k.length-1;0<=b;--b)Oe(a,{from:k[b].from,to:k[b].to,text:b?[""]:c.text});else Oe(a,c)}function Oe(a,c){if(1!=c.text.length||""!=c.text[0]||0!=P(c.from,c.to)){var k=Yd(a,c);Pe(a,c,k,a.cm?a.cm.curOp.id:NaN);Rc(a,c,k,Zd(a,c));var b=[];Ob(a,function(a,k){k||-1!=sa(b,a.history)||(Qe(a.history,c),b.push(a.history));Rc(a,c,null,Zd(a,c))})}}function ud(a,c,k){if(!a.cm||!a.cm.state.suppressEdits){for(var b=
a.history,d,e=a.sel,g="undo"==c?b.done:b.undone,h="undo"==c?b.undone:b.done,m=0;m<g.length&&(d=g[m],k?!d.ranges||d.equals(a.sel):d.ranges);m++);if(m!=g.length){for(b.lastOrigin=b.lastSelOrigin=null;;)if(d=g.pop(),d.ranges){hd(d,h);if(k&&!d.equals(a.sel)){ea(a,d,{clearRedo:!1});return}e=d}else break;k=[];hd(e,h);h.push({changes:k,generation:b.generation});b.generation=d.generation||++b.maxGeneration;b=Qa(a,"beforeChange")||a.cm&&Qa(a.cm,"beforeChange");for(m=d.changes.length-1;0<=m;--m){var f=d.changes[m];
f.origin=c;if(b&&!Me(a,f,!1)){g.length=0;break}k.push($d(a,f));e=m?Yd(a,f):U(g);Rc(a,f,e,Re(a,f));!m&&a.cm&&a.cm.scrollIntoView({from:f.from,to:Nb(f)});var l=[];Ob(a,function(a,c){c||-1!=sa(l,a.history)||(Qe(a.history,f),l.push(a.history));Rc(a,f,null,Re(a,f))})}}}}function Se(a,c){if(0!=c&&(a.first+=c,a.sel=new Ya(ed(a.sel.ranges,function(a){return new V(F(a.anchor.line+c,a.anchor.ch),F(a.head.line+c,a.head.ch))}),a.sel.primIndex),a.cm)){za(a.cm,a.first,a.first-c,c);for(var k=a.cm.display,b=k.viewFrom;b<
k.viewTo;b++)lb(a.cm,b,"gutter")}}function Rc(a,c,k,b){if(a.cm&&!a.cm.curOp)return ia(a.cm,Rc)(a,c,k,b);if(c.to.line<a.first)Se(a,c.text.length-1-(c.to.line-c.from.line));else if(!(c.from.line>a.lastLine())){if(c.from.line<a.first){var d=c.text.length-1-(a.first-c.from.line);Se(a,d);c={from:F(a.first,0),to:F(c.to.line+d,c.to.ch),text:[U(c.text)],origin:c.origin}}d=a.lastLine();c.to.line>d&&(c={from:c.from,to:F(d,L(a,d).text.length),text:[c.text[0]],origin:c.origin});c.removed=Fb(a,c.from,c.to);k||
(k=Yd(a,c));a.cm?Uf(a.cm,c,b):ae(a,c,b);Hb(a,k,fb)}}function Uf(a,c,k){var b=a.doc,d=a.display,e=c.from,g=c.to,h=!1,m=e.line;a.options.lineWrapping||(m=Y(gb(L(b,e.line))),b.iter(m,g.line+1,function(a){if(a==d.maxLine)return h=!0}));-1<b.sel.contains(c.from,c.to)&&se(a);ae(b,c,k,s(a));a.options.lineWrapping||(b.iter(m,e.line+c.text.length,function(a){var c=r(a);c>d.maxLineLength&&(d.maxLine=a,d.maxLineLength=c,d.maxLineChanged=!0,h=!1)}),h&&(a.curOp.updateMaxLine=!0));b.frontier=Math.min(b.frontier,
e.line);ob(a,400);k=c.text.length-(g.line-e.line)-1;c.full?za(a):e.line!=g.line||1!=c.text.length||Te(a.doc,c)?za(a,e.line,g.line+1,k):lb(a,e.line,"text");k=Qa(a,"changes");if((b=Qa(a,"change"))||k)c={from:e,to:g,text:c.text,removed:c.removed,origin:c.origin},b&&wa(a,"change",a,c),k&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(c);a.display.selForContextMenu=null}function hc(a,c,k,b,d){b||(b=k);if(0>P(b,k)){var e=b;b=k;k=e}"string"==typeof c&&(c=a.splitLines(c));Wb(a,{from:k,to:b,text:c,origin:d})}
function ld(a,c,k,b,d){var e=a.display,g=A(a.display);0>k&&(k=0);var h=a.curOp&&null!=a.curOp.scrollTop?a.curOp.scrollTop:e.scroller.scrollTop,m=Na(a),f={};d-k>m&&(d=k+m);var l=a.doc.height+sc(e),q=k<g,g=d>l-g;k<h?f.scrollTop=q?0:k:d>h+m&&(k=Math.min(k,(g?l:d)-m),k!=h&&(f.scrollTop=k));h=a.curOp&&null!=a.curOp.scrollLeft?a.curOp.scrollLeft:e.scroller.scrollLeft;a=Ea(a)-(a.options.fixedGutter?e.gutters.offsetWidth:0);(e=b-c>a)&&(b=c+a);10>c?f.scrollLeft=0:c<h?f.scrollLeft=Math.max(0,c-(e?0:10)):b>
a+h-3&&(f.scrollLeft=b+(e?0:10)-a);return f}function vd(a,c,k){null==c&&null==k||wd(a);null!=c&&(a.curOp.scrollLeft=(null==a.curOp.scrollLeft?a.doc.scrollLeft:a.curOp.scrollLeft)+c);null!=k&&(a.curOp.scrollTop=(null==a.curOp.scrollTop?a.doc.scrollTop:a.curOp.scrollTop)+k)}function Xb(a){wd(a);var c=a.getCursor(),k=c,b=c;a.options.lineWrapping||(k=c.ch?F(c.line,c.ch-1):c,b=F(c.line,c.ch+1));a.curOp.scrollToPos={from:k,to:b,margin:a.options.cursorScrollMargin,isCursor:!0}}function wd(a){var c=a.curOp.scrollToPos;
if(c){a.curOp.scrollToPos=null;var k=e(a,c.from),b=e(a,c.to),c=ld(a,Math.min(k.left,b.left),Math.min(k.top,b.top)-c.margin,Math.max(k.right,b.right),Math.max(k.bottom,b.bottom)+c.margin);a.scrollTo(c.scrollLeft,c.scrollTop)}}function Ac(a,c,k,b){var d=a.doc,e;null==k&&(k="add");"smart"==k&&(d.mode.indent?e=Ba(a,c):k="prev");var g=a.options.tabSize,h=L(d,c),m=Za(h.text,null,g);h.stateAfter&&(h.stateAfter=null);var f=h.text.match(/^\s*/)[0],l;if(!b&&!/\S/.test(h.text))l=0,k="not";else if("smart"==k&&
(l=d.mode.indent(e,h.text.slice(f.length),h.text),l==He||150<l)){if(!b)return;k="prev"}"prev"==k?l=c>d.first?Za(L(d,c-1).text,null,g):0:"add"==k?l=m+a.options.indentUnit:"subtract"==k?l=m-a.options.indentUnit:"number"==typeof k&&(l=m+k);l=Math.max(0,l);k="";b=0;if(a.options.indentWithTabs)for(a=Math.floor(l/g);a;--a)b+=g,k+="\t";b<l&&(k+=Ue(l-b));if(k!=f)return hc(d,k,F(c,0),F(c,f.length),"+input"),h.stateAfter=null,!0;for(a=0;a<d.sel.ranges.length;a++)if(g=d.sel.ranges[a],g.head.line==c&&g.head.ch<
f.length){b=F(c,f.length);cc(d,a,new V(b,b));break}}function xd(a,c,k,b){var d=c,e=c;"number"==typeof c?e=L(a,Math.max(a.first,Math.min(c,a.first+a.size-1))):d=Y(c);if(null==d)return null;b(e,d)&&a.cm&&lb(a.cm,d,k);return e}function ic(a,c){for(var k=a.doc.sel.ranges,b=[],d=0;d<k.length;d++){for(var e=c(k[d]);b.length&&0>=P(e.from,U(b).to);){var g=b.pop();if(0>P(g.from,e.from)){e.from=g.from;break}}b.push(e)}da(a,function(){for(var c=b.length-1;0<=c;c--)hc(a.doc,"",b[c].from,b[c].to,"+delete");Xb(a)})}
function be(a,c,k,b,d){function e(c){var b=(d?Sd:Ve)(f,h,k,!0);if(null==b){if(c=!c)c=g+k,c<a.first||c>=a.first+a.size?c=l=!1:(g=c,c=f=L(a,c));if(c)h=d?(0>k?kd:jd)(f):0>k?f.text.length:0;else return l=!1}else h=b;return!0}var g=c.line,h=c.ch,m=k,f=L(a,g),l=!0;if("char"==b)e();else if("column"==b)e(!0);else if("word"==b||"group"==b){var A=null;b="group"==b;c=a.cm&&a.cm.getHelper(c,"wordChars");for(var q=!0;!(0>k)||e(!q);q=!1){var t=f.text.charAt(h)||"\n",t=yd(t,c)?"w":b&&"\n"==t?"n":!b||/\s/.test(t)?
null:"p";!b||q||t||(t="s");if(A&&A!=t){0>k&&(k=1,e());break}t&&(A=t);if(0<k&&!e(!q))break}}m=Ib(a,F(g,h),m,!0);l||(m.hitSide=!0);return m}function We(a,c,k,b){var d=a.doc,e=c.left,g;"page"==b?(g=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),g=c.top+k*(g-(0>k?1.5:.5)*A(a.display))):"line"==b&&(g=0<k?c.bottom+3:c.top-3);for(;;){c=m(a,e,g);if(!c.outside)break;if(0>k?0>=g:g>=d.height){c.hitSide=!0;break}g+=5*k}return c}function O(a,c,k,b){f.defaults[a]=
c;k&&(Sb[a]=b?function(a,c,b){b!=me&&k(a,c,b)}:k)}function Vf(a){var c=a.split(/-(?!$)/);a=c[c.length-1];for(var k,b,d,e,g=0;g<c.length-1;g++){var h=c[g];if(/^(cmd|meta|m)$/i.test(h))e=!0;else if(/^a(lt)?$/i.test(h))k=!0;else if(/^(c|ctrl|control)$/i.test(h))b=!0;else if(/^s(hift)$/i.test(h))d=!0;else throw Error("Unrecognized modifier name: "+h);}k&&(a="Alt-"+a);b&&(a="Ctrl-"+a);e&&(a="Cmd-"+a);d&&(a="Shift-"+a);return a}function zd(a){return"string"==typeof a?sb[a]:a}function jc(a,c,k,b,d){if(b&&
b.shared)return Wf(a,c,k,b,d);if(a.cm&&!a.cm.curOp)return ia(a.cm,jc)(a,c,k,b,d);var e=new Pb(a,d);d=P(c,k);b&&Ta(b,e,!1);if(0<d||0==d&&!1!==e.clearWhenEmpty)return e;e.replacedWith&&(e.collapsed=!0,e.widgetNode=K("span",[e.replacedWith],"CodeMirror-widget"),b.handleMouseEvents||e.widgetNode.setAttribute("cm-ignore-events","true"),b.insertLeft&&(e.widgetNode.insertLeft=!0));if(e.collapsed){if(Xe(a,c.line,c,k,e)||c.line!=k.line&&Xe(a,k.line,c,k,e))throw Error("Inserting collapsed marker partially overlapping an existing one");
qb=!0}e.addToHistory&&Pe(a,{from:c,to:k,origin:"markText"},a.sel,NaN);var g=c.line,h=a.cm,m;a.iter(g,k.line+1,function(a){h&&e.collapsed&&!h.options.lineWrapping&&gb(a)==h.display.maxLine&&(m=!0);e.collapsed&&g!=c.line&&ab(a,0);var b=new Ad(e,g==c.line?c.ch:null,g==k.line?k.ch:null);a.markedSpans=a.markedSpans?a.markedSpans.concat([b]):[b];b.marker.attachLine(a);++g});e.collapsed&&a.iter(c.line,k.line+1,function(c){ub(a,c)&&ab(c,0)});e.clearOnEnter&&M(e,"beforeCursorEnter",function(){e.clear()});
e.readOnly&&(Ne=!0,(a.history.done.length||a.history.undone.length)&&a.clearHistory());e.collapsed&&(e.id=++ce,e.atomic=!0);if(h){m&&(h.curOp.updateMaxLine=!0);if(e.collapsed)za(h,c.line,k.line+1);else if(e.className||e.title||e.startStyle||e.endStyle||e.css)for(b=c.line;b<=k.line;b++)lb(h,b,"text");e.atomic&&Ic(h.doc);wa(h,"markerAdded",h,e)}return e}function Wf(a,c,k,b,d){b=Ta(b);b.shared=!1;var e=[jc(a,c,k,b,d)],g=e[0],h=b.widgetNode;Ob(a,function(a){h&&(b.widgetNode=h.cloneNode(!0));e.push(jc(a,
N(a,c),N(a,k),b,d));for(var m=0;m<a.linked.length;++m)if(a.linked[m].isParent)return;g=U(e)});return new Bd(e,g)}function Ye(a){return a.findMarks(F(a.first,0),a.clipPos(F(a.lastLine())),function(a){return a.parent})}function Xf(a){for(var c=0;c<a.length;c++){var k=a[c],b=[k.primary.doc];Ob(k.primary.doc,function(a){b.push(a)});for(var d=0;d<k.markers.length;d++){var e=k.markers[d];-1==sa(b,e.doc)&&(e.parent=null,k.markers.splice(d--,1))}}}function Ad(a,c,k){this.marker=a;this.from=c;this.to=k}function Sc(a,
c){if(a)for(var k=0;k<a.length;++k){var b=a[k];if(b.marker==c)return b}}function Zd(a,c){if(c.full)return null;var k=jb(a,c.from.line)&&L(a,c.from.line).markedSpans,b=jb(a,c.to.line)&&L(a,c.to.line).markedSpans;if(!k&&!b)return null;var d=c.from.ch,e=c.to.ch,g=0==P(c.from,c.to);if(k)for(var h=0,m;h<k.length;++h){var f=k[h],l=f.marker;if(null==f.from||(l.inclusiveLeft?f.from<=d:f.from<d)||!(f.from!=d||"bookmark"!=l.type||g&&f.marker.insertLeft)){var A=null==f.to||(l.inclusiveRight?f.to>=d:f.to>d);
(m||(m=[])).push(new Ad(l,f.from,A?null:f.to))}}k=m;if(b)for(var h=0,q;h<b.length;++h)if(m=b[h],f=m.marker,null==m.to||(f.inclusiveRight?m.to>=e:m.to>e)||m.from==e&&"bookmark"==f.type&&(!g||m.marker.insertLeft))l=null==m.from||(f.inclusiveLeft?m.from<=e:m.from<e),(q||(q=[])).push(new Ad(f,l?null:m.from-e,null==m.to?null:m.to-e));b=q;g=1==c.text.length;q=U(c.text).length+(g?d:0);if(k)for(e=0;e<k.length;++e)if(h=k[e],null==h.to)(m=Sc(b,h.marker),m)?g&&(h.to=null==m.to?null:m.to+q):h.to=d;if(b)for(e=
0;e<b.length;++e)h=b[e],null!=h.to&&(h.to+=q),null==h.from?(m=Sc(k,h.marker),m||(h.from=q,g&&(k||(k=[])).push(h))):(h.from+=q,g&&(k||(k=[])).push(h));k&&(k=Ze(k));b&&b!=k&&(b=Ze(b));d=[k];if(!g){var g=c.text.length-2,t;if(0<g&&k)for(e=0;e<k.length;++e)null==k[e].to&&(t||(t=[])).push(new Ad(k[e].marker,null,null));for(e=0;e<g;++e)d.push(t);d.push(b)}return d}function Ze(a){for(var c=0;c<a.length;++c){var k=a[c];null!=k.from&&k.from==k.to&&!1!==k.marker.clearWhenEmpty&&a.splice(c--,1)}return a.length?
a:null}function Re(a,c){var k;if(k=c["spans_"+a.id]){for(var b=0,d=[];b<c.text.length;++b)d.push(Yf(k[b]));k=d}else k=null;b=Zd(a,c);if(!k)return b;if(!b)return k;for(d=0;d<k.length;++d){var e=k[d],g=b[d];if(e&&g){var h=0;a:for(;h<g.length;++h){for(var m=g[h],f=0;f<e.length;++f)if(e[f].marker==m.marker)continue a;e.push(m)}}else g&&(k[d]=g)}return k}function Tf(a,c,k){var b=null;a.iter(c.line,k.line+1,function(a){if(a.markedSpans)for(var c=0;c<a.markedSpans.length;++c){var k=a.markedSpans[c].marker;
!k.readOnly||b&&-1!=sa(b,k)||(b||(b=[])).push(k)}});if(!b)return null;a=[{from:c,to:k}];for(c=0;c<b.length;++c){k=b[c];for(var d=k.find(0),e=0;e<a.length;++e){var g=a[e];if(!(0>P(g.to,d.from)||0<P(g.from,d.to))){var h=[e,1],m=P(g.from,d.from),f=P(g.to,d.to);(0>m||!k.inclusiveLeft&&!m)&&h.push({from:g.from,to:d.from});(0<f||!k.inclusiveRight&&!f)&&h.push({from:d.to,to:g.to});a.splice.apply(a,h);e+=h.length-1}}}return a}function $e(a){var c=a.markedSpans;if(c){for(var k=0;k<c.length;++k)c[k].marker.detachLine(a);
a.markedSpans=null}}function af(a,c){if(c){for(var k=0;k<c.length;++k)c[k].marker.attachLine(a);a.markedSpans=c}}function bf(a,c){var k=a.lines.length-c.lines.length;if(0!=k)return k;var k=a.find(),b=c.find(),d=P(k.from,b.from)||(a.inclusiveLeft?-1:0)-(c.inclusiveLeft?-1:0);return d?-d:(k=P(k.to,b.to)||(a.inclusiveRight?1:0)-(c.inclusiveRight?1:0))?k:c.id-a.id}function yb(a,c){var k=qb&&a.markedSpans,b;if(k)for(var d,e=0;e<k.length;++e)d=k[e],d.marker.collapsed&&null==(c?d.from:d.to)&&(!b||0>bf(b,
d.marker))&&(b=d.marker);return b}function Xe(a,c,b,d,e){a=L(a,c);if(a=qb&&a.markedSpans)for(c=0;c<a.length;++c){var g=a[c];if(g.marker.collapsed){var h=g.marker.find(0),m=P(h.from,b)||(g.marker.inclusiveLeft?-1:0)-(e.inclusiveLeft?-1:0),f=P(h.to,d)||(g.marker.inclusiveRight?1:0)-(e.inclusiveRight?1:0);if(!(0<=m&&0>=f||0>=m&&0<=f)&&(0>=m&&(0<P(h.to,b)||g.marker.inclusiveRight&&e.inclusiveLeft)||0<=m&&(0>P(h.from,d)||g.marker.inclusiveLeft&&e.inclusiveRight)))return!0}}}function gb(a){for(var c;c=
yb(a,!0);)a=c.find(-1,!0).line;return a}function Jd(a,c){var b=L(a,c),d=gb(b);return b==d?c:Y(d)}function pe(a,c){if(c>a.lastLine())return c;var b=L(a,c),d;if(!ub(a,b))return c;for(;d=yb(b,!1);)b=d.find(1,!0).line;return Y(b)+1}function ub(a,c){var b=qb&&c.markedSpans;if(b)for(var d,e=0;e<b.length;++e)if(d=b[e],d.marker.collapsed&&(null==d.from||!d.marker.widgetNode&&0==d.from&&d.marker.inclusiveLeft&&de(a,c,d)))return!0}function de(a,c,b){if(null==b.to)return c=b.marker.find(1,!0),de(a,c.line,Sc(c.line.markedSpans,
b.marker));if(b.marker.inclusiveRight&&b.to==c.text.length)return!0;for(var d,e=0;e<c.markedSpans.length;++e)if(d=c.markedSpans[e],d.marker.collapsed&&!d.marker.widgetNode&&d.from==b.to&&(null==d.to||d.to!=b.from)&&(d.marker.inclusiveLeft||b.marker.inclusiveRight)&&de(a,c,d))return!0}function Oc(a){if(null!=a.height)return a.height;var c=a.doc.cm;if(!c)return 0;if(!Ld(document.body,a.node)){var b="position: relative;";a.coverGutter&&(b+="margin-left: -"+c.display.gutters.offsetWidth+"px;");a.noHScroll&&
(b+="width: "+c.display.wrapper.clientWidth+"px;");Ka(c.display.measure,K("div",[a.node],null,b))}return a.height=a.node.offsetHeight}function Zf(a,c,b,d){var e=new Cd(a,b,d),g=a.cm;g&&e.noHScroll&&(g.display.alignWidgets=!0);xd(a,c,"widget",function(c){var b=c.widgets||(c.widgets=[]);null==e.insertAt?b.push(e):b.splice(Math.min(b.length-1,Math.max(0,e.insertAt)),0,e);e.line=c;g&&!ub(a,c)&&(b=bb(c)<a.scrollTop,ab(c,c.height+Oc(e)),b&&vd(g,null,e.height),g.curOp.forceUpdate=!0);return!0});return e}
function cf(a,c){if(a)for(;;){var b=a.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!b)break;a=a.slice(0,b.index)+a.slice(b.index+b[0].length);var d=b[1]?"bgClass":"textClass";null==c[d]?c[d]=b[2]:(new RegExp("(?:^|s)"+b[2]+"(?:$|s)")).test(c[d])||(c[d]+=" "+b[2])}return a}function df(a,c){if(a.blankLine)return a.blankLine(c);if(a.innerMode){var b=f.innerMode(a,c);if(b.mode.blankLine)return b.mode.blankLine(b.state)}}function ee(a,c,b,d){for(var e=0;10>e;e++){d&&(d[0]=f.innerMode(a,b).mode);var g=
a.token(c,b);if(c.pos>c.start)return g}throw Error("Mode "+a.name+" failed to advance stream.");}function ef(a,c,b,d){function e(a){return{start:A.start,end:A.pos,string:A.current(),type:m||null,state:a?rb(g.mode,l):l}}var g=a.doc,h=g.mode,m;c=N(g,c);var f=L(g,c.line),l=Ba(a,c.line,b),A=new Dd(f.text,a.options.tabSize),q;for(d&&(q=[]);(d||A.pos<c.ch)&&!A.eol();)A.start=A.pos,m=ee(h,A,l),d&&q.push(e(!0));return d?q:e()}function ff(a,c,b,d,e,g,h){var m=b.flattenSpans;null==m&&(m=a.options.flattenSpans);
var f=0,l=null,A=new Dd(c,a.options.tabSize),q,t=a.options.addModeClass&&[null];for(""==c&&cf(df(b,d),g);!A.eol();){A.pos>a.options.maxHighlightLength?(m=!1,h&&Nd(a,c,d,A.pos),A.pos=c.length,q=null):q=cf(ee(b,A,d,t),g);if(t){var E=t[0].name;E&&(q="m-"+(q?E+" "+q:E))}if(!m||l!=q){for(;f<A.start;)f=Math.min(A.start,f+5E4),e(f,l);l=q}A.start=A.pos}for(;f<A.pos;)a=Math.min(A.pos,f+5E4),e(a,l),f=a}function te(a,c,b,d){var e=[a.state.modeGen],g={};ff(a,c.text,a.doc.mode,b,function(a,c){e.push(a,c)},g,d);
for(b=0;b<a.state.overlays.length;++b){var h=a.state.overlays[b],m=1,f=0;ff(a,c.text,h.mode,!0,function(a,c){for(var b=m;f<a;){var k=e[m];k>a&&e.splice(m,1,a,e[m+1],k);m+=2;f=Math.min(a,k)}if(c)if(h.opaque)e.splice(b,m-b,a,"cm-overlay "+c),m=b+2;else for(;b<m;b+=2)k=e[b+1],e[b+1]=(k?k+" ":"")+"cm-overlay "+c},g)}return{styles:e,classes:g.bgClass||g.textClass?g:null}}function gf(a,c,b){if(!c.styles||c.styles[0]!=a.state.modeGen){var d=Ba(a,Y(c)),e=te(a,c,c.text.length>a.options.maxHighlightLength?
rb(a.doc.mode,d):d);c.stateAfter=d;c.styles=e.styles;e.classes?c.styleClasses=e.classes:c.styleClasses&&(c.styleClasses=null);b===a.doc.frontier&&a.doc.frontier++}return c.styles}function Nd(a,c,b,d){var e=a.doc.mode;a=new Dd(c,a.options.tabSize);a.start=a.pos=d||0;for(""==c&&df(e,b);!a.eol();)ee(e,a,b),a.start=a.pos}function hf(a,c){if(!a||/^\s*$/.test(a))return null;var b=c.addModeClass?$f:ag;return b[a]||(b[a]=a.replace(/\S+/g,"cm-$&"))}function qe(a,c){var b=K("span",null,null,oa?"padding-right: .1px":
null),b={pre:K("pre",[b],"CodeMirror-line"),content:b,col:0,pos:0,cm:a,splitSpaces:(R||oa)&&a.getOption("lineWrapping")};c.measure={};for(var d=0;d<=(c.rest?c.rest.length:0);d++){var e=d?c.rest[d-1]:c.line,g;b.pos=0;b.addToken=bg;var h;if(null!=fe)h=fe;else{h=Ka(a.display.measure,document.createTextNode("A\u062eA"));var m=Kb(h,0,1).getBoundingClientRect();h=m&&m.left!=m.right?fe=3>Kb(h,1,2).getBoundingClientRect().right-m.right:!1}h&&(g=Xa(e))&&(b.addToken=cg(b.addToken,g));b.map=[];m=c!=a.display.externalMeasured&&
Y(e);a:{h=b;var m=gf(a,e,m),f=e.markedSpans,l=e.text,A=0;if(f)for(var q=l.length,t=0,E=1,n="",u=void 0,v=void 0,r=0,s=void 0,w=void 0,D=void 0,Ua=void 0,x=void 0;;){if(r==t){for(var s=w=D=Ua=v="",x=null,r=Infinity,da=[],ca=0;ca<f.length;++ca){var C=f[ca],B=C.marker;"bookmark"==B.type&&C.from==t&&B.widgetNode?da.push(B):C.from<=t&&(null==C.to||C.to>t||B.collapsed&&C.to==t&&C.from==t)?(null!=C.to&&C.to!=t&&r>C.to&&(r=C.to,w=""),B.className&&(s+=" "+B.className),B.css&&(v=B.css),B.startStyle&&C.from==
t&&(D+=" "+B.startStyle),B.endStyle&&C.to==r&&(w+=" "+B.endStyle),B.title&&!Ua&&(Ua=B.title),B.collapsed&&(!x||0>bf(x.marker,B))&&(x=C)):C.from>t&&r>C.from&&(r=C.from)}if(x&&(x.from||0)==t){jf(h,(null==x.to?q+1:x.to)-t,x.marker,null==x.from);if(null==x.to)break a;x.to==t&&(x=!1)}if(!x&&da.length)for(ca=0;ca<da.length;++ca)jf(h,0,da[ca])}if(t>=q)break;for(da=Math.min(q,r);;){if(n){ca=t+n.length;x||(C=ca>da?n.slice(0,da-t):n,h.addToken(h,C,u?u+s:s,D,t+C.length==r?w:"",Ua,v));if(ca>=da){n=n.slice(da-
t);t=da;break}t=ca;D=""}n=l.slice(A,A=m[E++]);u=hf(m[E++],h.cm.options)}}else for(var E=1;E<m.length;E+=2)h.addToken(h,l.slice(A,A=m[E]),hf(m[E+1],h.cm.options))}e.styleClasses&&(e.styleClasses.bgClass&&(b.bgClass=ge(e.styleClasses.bgClass,b.bgClass||"")),e.styleClasses.textClass&&(b.textClass=ge(e.styleClasses.textClass,b.textClass||"")));0==b.map.length&&b.map.push(0,0,b.content.appendChild(dg(a.display.measure)));0==d?(c.measure.map=b.map,c.measure.cache={}):((c.measure.maps||(c.measure.maps=[])).push(b.map),
(c.measure.caches||(c.measure.caches=[])).push({}))}oa&&/\bcm-tab\b/.test(b.content.lastChild.className)&&(b.content.className="cm-tab-wrap-hack");na(a,"renderLine",a,c.line,b.pre);b.pre.className&&(b.textClass=ge(b.pre.className,b.textClass||""));return b}function bg(a,c,b,d,e,g,h){if(c){var m=a.splitSpaces?c.replace(/ {3,}/g,eg):c,f=a.cm.state.specialChars,l=!1;if(f.test(c))for(var A=document.createDocumentFragment(),q=0;;){f.lastIndex=q;var t=f.exec(c),E=t?t.index-q:c.length-q;if(E){var n=document.createTextNode(m.slice(q,
q+E));R&&9>Z?A.appendChild(K("span",[n])):A.appendChild(n);a.map.push(a.pos,a.pos+E,n);a.col+=E;a.pos+=E}if(!t)break;q+=E+1;"\t"==t[0]?(n=a.cm.options.tabSize,t=n-a.col%n,n=A.appendChild(K("span",Ue(t),"cm-tab")),n.setAttribute("role","presentation"),n.setAttribute("cm-text","\t"),a.col+=t):("\r"==t[0]||"\n"==t[0]?(n=A.appendChild(K("span","\r"==t[0]?"\u240d":"\u2424","cm-invalidchar")),n.setAttribute("cm-text",t[0])):(n=a.cm.options.specialCharPlaceholder(t[0]),n.setAttribute("cm-text",t[0]),R&&
9>Z?A.appendChild(K("span",[n])):A.appendChild(n)),a.col+=1);a.map.push(a.pos,a.pos+1,n);a.pos++}else{a.col+=c.length;var A=document.createTextNode(m);a.map.push(a.pos,a.pos+c.length,A);R&&9>Z&&(l=!0);a.pos+=c.length}if(b||d||e||l||h)return c=b||"",d&&(c+=d),e&&(c+=e),d=K("span",[A],c,h),g&&(d.title=g),a.content.appendChild(d);a.content.appendChild(A)}}function eg(a){for(var c=" ",b=0;b<a.length-2;++b)c+=b%2?" ":"\u00a0";return c+" "}function cg(a,c){return function(b,d,e,g,h,m,f){e=e?e+" cm-force-border":
"cm-force-border";for(var l=b.pos,A=l+d.length;;){for(var q=0;q<c.length;q++){var t=c[q];if(t.to>l&&t.from<=l)break}if(t.to>=A)return a(b,d,e,g,h,m,f);a(b,d.slice(0,t.to-l),e,g,null,m,f);g=null;d=d.slice(t.to-l);l=t.to}}}function jf(a,c,b,d){var e=!d&&b.widgetNode;e&&a.map.push(a.pos,a.pos+c,e);!d&&a.cm.display.input.needsContentAttribute&&(e||(e=a.content.appendChild(document.createElement("span"))),e.setAttribute("cm-marker",b.id));e&&(a.cm.display.input.setUneditable(e),a.content.appendChild(e));
a.pos+=c}function Te(a,c){return 0==c.from.ch&&0==c.to.ch&&""==U(c.text)&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}function ae(a,c,b,d){function e(a,b,k){a.text=b;a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null);null!=a.order&&(a.order=null);$e(a);af(a,k);b=d?d(a):1;b!=a.height&&ab(a,b);wa(a,"change",a,c)}function g(a,c){for(var e=a,h=[];e<c;++e)h.push(new Tc(f[e],b?b[e]:null,d));return h}var h=c.from,m=c.to,f=c.text,l=L(a,h.line),A=L(a,m.line),q=U(f),t=b?b[f.length-1]:null,E=m.line-
h.line;if(c.full)a.insert(0,g(0,f.length)),a.remove(f.length,a.size-f.length);else if(Te(a,c)){var n=g(0,f.length-1);e(A,A.text,t);E&&a.remove(h.line,E);n.length&&a.insert(h.line,n)}else l==A?1==f.length?e(l,l.text.slice(0,h.ch)+q+l.text.slice(m.ch),t):(n=g(1,f.length-1),n.push(new Tc(q+l.text.slice(m.ch),t,d)),e(l,l.text.slice(0,h.ch)+f[0],b?b[0]:null),a.insert(h.line+1,n)):1==f.length?(e(l,l.text.slice(0,h.ch)+f[0]+A.text.slice(m.ch),b?b[0]:null),a.remove(h.line+1,E)):(e(l,l.text.slice(0,h.ch)+
f[0],b?b[0]:null),e(A,q+A.text.slice(m.ch),t),n=g(1,f.length-1),1<E&&a.remove(h.line+1,E-1),a.insert(h.line+1,n));wa(a,"change",a,c)}function Uc(a){this.lines=a;this.parent=null;for(var c=0,b=0;c<a.length;++c)a[c].parent=this,b+=a[c].height;this.height=b}function Vc(a){this.children=a;for(var c=0,b=0,d=0;d<a.length;++d){var e=a[d],c=c+e.chunkSize(),b=b+e.height;e.parent=this}this.size=c;this.height=b;this.parent=null}function Ob(a,c,b){function d(a,e,g){if(a.linked)for(var h=0;h<a.linked.length;++h){var m=
a.linked[h];if(m.doc!=e){var f=g&&m.sharedHist;if(!b||f)c(m.doc,f),d(m.doc,a,f)}}}d(a,null,!0)}function le(a,c){if(c.cm)throw Error("This document is already in use.");a.doc=c;c.cm=a;n(a);I(a);a.options.lineWrapping||x(a);a.options.mode=c.modeOption;za(a)}function L(a,c){c-=a.first;if(0>c||c>=a.size)throw Error("There is no line "+(c+a.first)+" in the document.");for(var b=a;!b.lines;)for(var d=0;;++d){var e=b.children[d],g=e.chunkSize();if(c<g){b=e;break}c-=g}return b.lines[c]}function Fb(a,c,b){var d=
[],e=c.line;a.iter(c.line,b.line+1,function(a){a=a.text;e==b.line&&(a=a.slice(0,b.ch));e==c.line&&(a=a.slice(c.ch));d.push(a);++e});return d}function he(a,c,b){var d=[];a.iter(c,b,function(a){d.push(a.text)});return d}function ab(a,c){var b=c-a.height;if(b)for(var d=a;d;d=d.parent)d.height+=b}function Y(a){if(null==a.parent)return null;var c=a.parent;a=sa(c.lines,a);for(var b=c.parent;b;c=b,b=b.parent)for(var d=0;b.children[d]!=c;++d)a+=b.children[d].chunkSize();return a+c.first}function zb(a,c){var b=
a.first;a:do{for(var d=0;d<a.children.length;++d){var e=a.children[d],g=e.height;if(c<g){a=e;continue a}c-=g;b+=e.chunkSize()}return b}while(!a.lines);for(d=0;d<a.lines.length;++d){e=a.lines[d].height;if(c<e)break;c-=e}return b+d}function bb(a){a=gb(a);for(var c=0,b=a.parent,d=0;d<b.lines.length;++d){var e=b.lines[d];if(e==a)break;else c+=e.height}for(a=b.parent;a;b=a,a=b.parent)for(d=0;d<a.children.length&&(e=a.children[d],e!=b);++d)c+=e.height;return c}function Xa(a){var c=a.order;null==c&&(c=a.order=
fg(a.text));return c}function Ed(a){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOrigin=this.lastSelOrigin=this.lastOp=this.lastSelOp=null;this.generation=this.maxGeneration=a||1}function $d(a,c){var b={from:yc(c.from),to:Nb(c),text:Fb(a,c.from,c.to)};kf(a,b,c.from.line,c.to.line+1);Ob(a,function(a){kf(a,b,c.from.line,c.to.line+1)},!0);return b}function re(a){for(;a.length;)if(U(a).ranges)a.pop();else break}function Pe(a,c,b,d){var e=a.history;e.undone.length=
0;var g=+new Date,h,m;if(m=e.lastOp==d||e.lastOrigin==c.origin&&c.origin&&("+"==c.origin.charAt(0)&&a.cm&&e.lastModTime>g-a.cm.options.historyEventDelay||"*"==c.origin.charAt(0)))e.lastOp==d?(re(e.done),h=U(e.done)):e.done.length&&!U(e.done).ranges?h=U(e.done):1<e.done.length&&!e.done[e.done.length-2].ranges?(e.done.pop(),h=U(e.done)):h=void 0,m=h;if(m){var f=U(h.changes);0==P(c.from,c.to)&&0==P(c.from,f.to)?f.to=Nb(c):h.changes.push($d(a,c))}else for((h=U(e.done))&&h.ranges||hd(a.sel,e.done),h={changes:[$d(a,
c)],generation:e.generation},e.done.push(h);e.done.length>e.undoDepth;)e.done.shift(),e.done[0].ranges||e.done.shift();e.done.push(b);e.generation=++e.maxGeneration;e.lastModTime=e.lastSelTime=g;e.lastOp=e.lastSelOp=d;e.lastOrigin=e.lastSelOrigin=c.origin;f||na(a,"historyAdded")}function hd(a,c){var b=U(c);b&&b.ranges&&b.equals(a)||c.push(a)}function kf(a,c,b,d){var e=c["spans_"+a.id],g=0;a.iter(Math.max(a.first,b),Math.min(a.first+a.size,d),function(b){b.markedSpans&&((e||(e=c["spans_"+a.id]={}))[g]=
b.markedSpans);++g})}function Yf(a){if(!a)return null;for(var c=0,b;c<a.length;++c)a[c].marker.explicitlyCleared?b||(b=a.slice(0,c)):b&&b.push(a[c]);return b?b.length?b:null:a}function kc(a,c,b){for(var d=0,e=[];d<a.length;++d){var g=a[d];if(g.ranges)e.push(b?Ya.prototype.deepCopy.call(g):g);else{var g=g.changes,h=[];e.push({changes:h});for(var m=0;m<g.length;++m){var f=g[m],l;h.push({from:f.from,to:f.to,text:f.text});if(c)for(var A in f)(l=A.match(/^spans_(\d+)$/))&&-1<sa(c,Number(l[1]))&&(U(h)[A]=
f[A],delete f[A])}}}return e}function lf(a,c,b,d){b<a.line?a.line+=d:c<a.line&&(a.line=c,a.ch=0)}function mf(a,c,b,d){for(var e=0;e<a.length;++e){var g=a[e],h=!0;if(g.ranges){g.copied||(g=a[e]=g.deepCopy(),g.copied=!0);for(var m=0;m<g.ranges.length;m++)lf(g.ranges[m].anchor,c,b,d),lf(g.ranges[m].head,c,b,d)}else{for(m=0;m<g.changes.length;++m){var f=g.changes[m];if(b<f.from.line)f.from=F(f.from.line+d,f.from.ch),f.to=F(f.to.line+d,f.to.ch);else if(c<=f.to.line){h=!1;break}}h||(a.splice(0,e+1),e=0)}}}
function Qe(a,c){var b=c.from.line,d=c.to.line,e=c.text.length-(d-b)-1;mf(a.done,b,d,e);mf(a.undone,b,d,e)}function Wd(a){return null!=a.defaultPrevented?a.defaultPrevented:0==a.returnValue}function Ee(a){var c=a.which;null==c&&(a.button&1?c=1:a.button&2?c=3:a.button&4&&(c=2));Va&&a.ctrlKey&&1==c&&(c=3);return c}function Fd(a,c,b){a=a._handlers&&a._handlers[c];return b?a&&0<a.length?a.slice():nf:a||nf}function wa(a,c){function b(a){return function(){a.apply(null,e)}}var d=Fd(a,c,!1);if(d.length){var e=
Array.prototype.slice.call(arguments,2),g;gc?g=gc.delayedCallbacks:Wc?g=Wc:(g=Wc=[],setTimeout(gg,0));for(var h=0;h<d.length;++h)g.push(b(d[h]))}}function gg(){var a=Wc;Wc=null;for(var c=0;c<a.length;++c)a[c]()}function Sa(a,c,b){"string"==typeof c&&(c={type:c,preventDefault:function(){this.defaultPrevented=!0}});na(a,b||c.type,a,c);return Wd(c)||c.codemirrorIgnore}function se(a){var c=a._handlers&&a._handlers.cursorActivity;if(c){a=a.curOp.cursorActivityHandlers||(a.curOp.cursorActivityHandlers=
[]);for(var b=0;b<c.length;++b)-1==sa(a,c[b])&&a.push(c[b])}}function Qa(a,c){return 0<Fd(a,c).length}function lc(a){a.prototype.on=function(a,b){M(this,a,b)};a.prototype.off=function(a,b){hb(this,a,b)}}function pc(){this.id=null}function Ue(a){for(;Gd.length<=a;)Gd.push(U(Gd)+" ");return Gd[a]}function U(a){return a[a.length-1]}function sa(a,c){for(var b=0;b<a.length;++b)if(a[b]==c)return b;return-1}function ed(a,c){for(var b=[],d=0;d<a.length;d++)b[d]=c(a[d],d);return b}function Xc(){}function of(a,
c){var b;Object.create?b=Object.create(a):(Xc.prototype=a,b=new Xc);c&&Ta(c,b);return b}function Ta(a,c,b){c||(c={});for(var d in a)!a.hasOwnProperty(d)||!1===b&&c.hasOwnProperty(d)||(c[d]=a[d]);return c}function qc(a){var c=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,c)}}function yd(a,c){return c?-1<c.source.indexOf("\\w")&&pf(a)?!0:c.test(a):pf(a)}function qf(a){for(var c in a)if(a.hasOwnProperty(c)&&a[c])return!1;return!0}function Lc(a){return 768<=a.charCodeAt(0)&&
hg.test(a)}function K(a,c,b,d){a=document.createElement(a);b&&(a.className=b);d&&(a.style.cssText=d);if("string"==typeof c)a.appendChild(document.createTextNode(c));else if(c)for(b=0;b<c.length;++b)a.appendChild(c[b]);return a}function xb(a){for(var c=a.childNodes.length;0<c;--c)a.removeChild(a.firstChild);return a}function Ka(a,c){return xb(a).appendChild(c)}function cb(){for(var a=document.activeElement;a&&a.root&&a.root.activeElement;)a=a.root.activeElement;return a}function Yc(a){return new RegExp("(^|\\s)"+
a+"(?:$|\\s)\\s*")}function ge(a,c){for(var b=a.split(" "),d=0;d<b.length;d++)b[d]&&!Yc(b[d]).test(c)&&(c+=" "+b[d]);return c}function rf(a){if(document.body.getElementsByClassName)for(var c=document.body.getElementsByClassName("CodeMirror"),b=0;b<c.length;b++){var d=c[b].CodeMirror;d&&a(d)}}function Bf(){var a;M(window,"resize",function(){null==a&&(a=setTimeout(function(){a=null;rf(Hf)},100))});M(window,"blur",function(){rf(rc)})}function dg(a){if(null==ie){var c=K("span","\u200b");Ka(a,K("span",
[c,document.createTextNode("x")]));0!=a.firstChild.offsetHeight&&(ie=1>=c.offsetWidth&&2<c.offsetHeight&&!(R&&8>Z))}a=ie?K("span","\u200b"):K("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");a.setAttribute("cm-text","");return a}function Cf(a,c,b,d){if(!a)return d(c,b,"ltr");for(var e=!1,g=0;g<a.length;++g){var h=a[g];if(h.from<b&&h.to>c||c==b&&h.to==c)d(Math.max(h.from,c),Math.min(h.to,b),1==h.level?"rtl":"ltr"),e=!0}e||d(c,b,"ltr")}function Qd(a){return a.level%2?a.to:
a.from}function Rd(a){return a.level%2?a.from:a.to}function jd(a){return(a=Xa(a))?Qd(a[0]):0}function kd(a){var c=Xa(a);return c?Rd(U(c)):a.text.length}function sf(a,c){var b=L(a.doc,c),d=gb(b);d!=b&&(c=Y(d));d=(b=Xa(d))?b[0].level%2?kd(d):jd(d):0;return F(c,d)}function tf(a,c){var b=sf(a,c.line),d=L(a.doc,b.line),e=Xa(d);return e&&0!=e[0].level?b:(d=Math.max(0,d.text.search(/\S/)),F(b.line,c.line==b.line&&c.ch<=d&&c.ch?0:d))}function fd(a,c){Pc=null;for(var b=0,d;b<a.length;++b){var e=a[b];if(e.from<
c&&e.to>c)return b;if(e.from==c||e.to==c)if(null==d)d=b;else{var g;g=e.level;var h=a[d].level,m=a[0].level;g=g==m?!0:h==m?!1:g<h;if(g)return e.from!=e.to&&(Pc=d),b;e.from!=e.to&&(Pc=b);break}}return d}function je(a,c,b,d){if(!d)return c+b;do c+=b;while(0<c&&Lc(a.text.charAt(c)));return c}function Sd(a,c,b,d){var e=Xa(a);if(!e)return Ve(a,c,b,d);var g=fd(e,c),h=e[g];for(c=je(a,c,h.level%2?-b:b,d);;){if(c>h.from&&c<h.to)return c;if(c==h.from||c==h.to){if(fd(e,c)==g)return c;h=e[g+b];return 0<b==h.level%
2?h.to:h.from}h=e[g+=b];if(!h)return null;c=0<b==h.level%2?je(a,h.to,-1,d):je(a,h.from,1,d)}}function Ve(a,c,b,d){c+=b;if(d)for(;0<c&&Lc(a.text.charAt(c));)c+=b;return 0>c||c>a.text.length?null:c}var Ma=navigator.userAgent,uf=navigator.platform,tb=/gecko\/\d/i.test(Ma),vf=/MSIE \d/.test(Ma),wf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ma),R=vf||wf,Z=R&&(vf?document.documentMode||6:wf[1]),oa=/WebKit\//.test(Ma),ig=oa&&/Qt\/\d+\.\d+/.test(Ma),jg=/Chrome\//.test(Ma),$a=/Opera\//.test(Ma),ze=/Apple Computer/.test(navigator.vendor),
kg=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(Ma),Ff=/PhantomJS/.test(Ma),$b=/AppleWebKit/.test(Ma)&&/Mobile\/\w+/.test(Ma),oc=$b||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(Ma),Va=$b||/Mac/.test(uf),lg=/win/i.test(uf),Qb=$a&&Ma.match(/Version\/(\d*\.\d*)/);Qb&&(Qb=Number(Qb[1]));Qb&&15<=Qb&&($a=!1,oa=!0);var xf=Va&&(ig||$a&&(null==Qb||12.11>Qb)),Ud=tb||R&&9<=Z,Ne=!1,qb=!1;D.prototype=Ta({update:function(a){var c=a.scrollWidth>a.clientWidth+1,b=a.scrollHeight>a.clientHeight+1,d=a.nativeBarWidth;
b?(this.vert.style.display="block",this.vert.style.bottom=c?d+"px":"0",this.vert.firstChild.style.height=Math.max(0,a.scrollHeight-a.clientHeight+(a.viewHeight-(c?d:0)))+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0");c?(this.horiz.style.display="block",this.horiz.style.right=b?d+"px":"0",this.horiz.style.left=a.barLeft+"px",this.horiz.firstChild.style.width=a.scrollWidth-a.clientWidth+(a.viewWidth-a.barLeft-(b?d:0))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width=
"0");!this.checkedOverlay&&0<a.clientHeight&&(0==d&&this.overlayHack(),this.checkedOverlay=!0);return{right:b?d:0,bottom:c?d:0}},setScrollLeft:function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a)},setScrollTop:function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a)},overlayHack:function(){this.horiz.style.minHeight=this.vert.style.minWidth=Va&&!kg?"12px":"18px";var a=this,c=function(c){(c.target||c.srcElement)!=a.vert&&(c.target||c.srcElement)!=a.horiz&&ia(a.cm,ve)(c)};M(this.vert,
"mousedown",c);M(this.horiz,"mousedown",c)},clear:function(){var a=this.horiz.parentNode;a.removeChild(this.horiz);a.removeChild(this.vert)}},D.prototype);aa.prototype=Ta({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},aa.prototype);f.scrollbarModel={"native":D,"null":aa};Ia.prototype.signal=function(a,c){Qa(a,c)&&this.events.push(arguments)};Ia.prototype.finish=function(){for(var a=0;a<this.events.length;a++)na.apply(null,this.events[a])};
var F=f.Pos=function(a,c){if(!(this instanceof F))return new F(a,c);this.line=a;this.ch=c},P=f.cmpPos=function(a,c){return a.line-c.line||a.ch-c.ch},Oa=null;Zb.prototype=Ta({init:function(a){function c(a){if(d.somethingSelected())Oa=d.getSelections(),b.inaccurateSelection&&(b.prevInput="",b.inaccurateSelection=!1,g.value=Oa.join("\n"),mc(g));else if(d.options.lineWiseCopyCut){var c=Yb(d);Oa=c.text;"cut"==a.type?d.setSelections(c.ranges,null,fb):(b.prevInput="",g.value=c.text.join("\n"),mc(g))}else return;
"cut"==a.type&&(d.state.cutIncoming=!0)}var b=this,d=this.cm,e=this.wrapper=Bc(),g=this.textarea=e.firstChild;a.wrapper.insertBefore(e,a.wrapper.firstChild);$b&&(g.style.width="0px");M(g,"input",function(){R&&9<=Z&&b.hasSelection&&(b.hasSelection=null);b.poll()});M(g,"paste",function(a){if(Db(a,d))return!0;d.state.pasteIncoming=!0;b.fastPoll()});M(g,"cut",c);M(g,"copy",c);M(a.scroller,"paste",function(c){nb(a,c)||(d.state.pasteIncoming=!0,b.focus())});M(a.lineSpace,"selectstart",function(c){nb(a,
c)||ya(c)});M(g,"compositionstart",function(){var a=d.getCursor("from");b.composing&&b.composing.range.clear();b.composing={start:a,range:d.markText(a,d.getCursor("to"),{className:"CodeMirror-composing"})}});M(g,"compositionend",function(){b.composing&&(b.poll(),b.composing.range.clear(),b.composing=null)})},prepareSelection:function(){var a=this.cm,c=a.display,b=a.doc,e=Jb(a);if(a.options.moveInputWithCursor){var a=d(a,b.sel.primary().head,"div"),b=c.wrapper.getBoundingClientRect(),g=c.lineDiv.getBoundingClientRect();
e.teTop=Math.max(0,Math.min(c.wrapper.clientHeight-10,a.top+g.top-b.top));e.teLeft=Math.max(0,Math.min(c.wrapper.clientWidth-10,a.left+g.left-b.left))}return e},showSelection:function(a){var c=this.cm.display;Ka(c.cursorDiv,a.cursors);Ka(c.selectionDiv,a.selection);null!=a.teTop&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")},reset:function(a){if(!this.contextMenuPending){var c,b,d=this.cm,e=d.doc;d.somethingSelected()?(this.prevInput="",c=e.sel.primary(),b=(c=Je&&(100<
c.to().line-c.from().line||1E3<(b=d.getSelection()).length))?"-":b||d.getSelection(),this.textarea.value=b,d.state.focused&&mc(this.textarea),R&&9<=Z&&(this.hasSelection=b)):a||(this.prevInput=this.textarea.value="",R&&9<=Z&&(this.hasSelection=null));this.inaccurateSelection=c}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!oc||cb()!=this.textarea))try{this.textarea.focus()}catch(a){}},blur:function(){this.textarea.blur()},
resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var a=this;a.pollingFast||a.polling.set(this.cm.options.pollInterval,function(){a.poll();a.cm.state.focused&&a.slowPoll()})},fastPoll:function(){function a(){b.poll()||c?(b.pollingFast=!1,b.slowPoll()):(c=!0,b.polling.set(60,a))}var c=!1,b=this;b.pollingFast=!0;b.polling.set(20,a)},poll:function(){var a=this.cm,c=this.textarea,b=this.prevInput;if(this.contextMenuPending||
!a.state.focused||mg(c)&&!b&&!this.composing||ma(a)||a.options.disableInput||a.state.keySeq)return!1;var d=c.value;if(d==b&&!a.somethingSelected())return!1;if(R&&9<=Z&&this.hasSelection===d||Va&&/[\uf700-\uf7ff]/.test(d))return a.display.input.reset(),!1;if(a.doc.sel==a.display.selForContextMenu){var e=d.charCodeAt(0);8203!=e||b||(b="\u200b");if(8666==e)return this.reset(),this.cm.execCommand("undo")}for(var g=0,e=Math.min(b.length,d.length);g<e&&b.charCodeAt(g)==d.charCodeAt(g);)++g;var h=this;da(a,
function(){Aa(a,d.slice(g),b.length-g,null,h.composing?"*compose":null);1E3<d.length||-1<d.indexOf("\n")?c.value=h.prevInput="":h.prevInput=d;h.composing&&(h.composing.range.clear(),h.composing.range=a.markText(h.composing.start,a.getCursor("to"),{className:"CodeMirror-composing"}))});return!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){R&&9<=Z&&(this.hasSelection=null);this.fastPoll()},onContextMenu:function(a){function c(){if(null!=h.selectionStart){var a=
e.somethingSelected(),c="\u200b"+(a?h.value:"");h.value="\u21da";h.value=c;d.prevInput=a?"":"\u200b";h.selectionStart=1;h.selectionEnd=c.length;g.selForContextMenu=e.doc.sel}}function b(){d.contextMenuPending=!1;d.wrapper.style.position="relative";h.style.cssText=l;R&&9>Z&&g.scrollbars.setScrollTop(g.scroller.scrollTop=f);if(null!=h.selectionStart){(!R||R&&9>Z)&&c();var a=0,k=function(){g.selForContextMenu==e.doc.sel&&0==h.selectionStart&&0<h.selectionEnd&&"\u200b"==d.prevInput?ia(e,sd.selectAll)(e):
10>a++?g.detectingSelectAll=setTimeout(k,500):g.input.reset()};g.detectingSelectAll=setTimeout(k,200)}}var d=this,e=d.cm,g=e.display,h=d.textarea,m=Mb(e,a),f=g.scroller.scrollTop;if(m&&!$a){e.options.resetSelectionOnContextMenu&&-1==e.doc.sel.contains(m)&&ia(e,ea)(e.doc,Ga(m),fb);var l=h.style.cssText;d.wrapper.style.position="absolute";h.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(a.clientY-5)+"px; left: "+(a.clientX-5)+"px; z-index: 1000; background: "+(R?"rgba(255, 255, 255, .05)":
"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(oa)var A=window.scrollY;g.input.focus();oa&&window.scrollTo(null,A);g.input.reset();e.somethingSelected()||(h.value=d.prevInput=" ");d.contextMenuPending=!0;g.selForContextMenu=e.doc.sel;clearTimeout(g.detectingSelectAll);R&&9<=Z&&c();if(Ud){nd(a);var q=function(){hb(window,"mouseup",q);setTimeout(b,20)};M(window,"mouseup",q)}else setTimeout(b,50)}},readOnlyChanged:function(a){a||
this.reset()},setUneditable:Xc,needsContentAttribute:!1},Zb.prototype);Ja.prototype=Ta({init:function(a){function c(a){if(d.somethingSelected())Oa=d.getSelections(),"cut"==a.type&&d.replaceSelection("",null,"cut");else if(d.options.lineWiseCopyCut){var c=Yb(d);Oa=c.text;"cut"==a.type&&d.operation(function(){d.setSelections(c.ranges,0,fb);d.replaceSelection("",null,"cut")})}else return;if(a.clipboardData&&!$b)a.preventDefault(),a.clipboardData.clearData(),a.clipboardData.setData("text/plain",Oa.join("\n"));
else{var b=Bc();a=b.firstChild;d.display.lineSpace.insertBefore(b,d.display.lineSpace.firstChild);a.value=Oa.join("\n");var k=document.activeElement;mc(a);setTimeout(function(){d.display.lineSpace.removeChild(b);k.focus()},50)}}var b=this,d=b.cm;a=b.div=a.lineDiv;Pa(a);M(a,"paste",function(a){Db(a,d)});M(a,"compositionstart",function(a){a=a.data;b.composing={sel:d.doc.sel,data:a,startData:a};if(a){var c=d.doc.sel.primary(),e=d.getLine(c.head.line).indexOf(a,Math.max(0,c.head.ch-a.length));-1<e&&e<=
c.head.ch&&(b.composing.sel=Ga(F(c.head.line,e),F(c.head.line,e+a.length)))}});M(a,"compositionupdate",function(a){b.composing.data=a.data});M(a,"compositionend",function(a){var c=b.composing;c&&(a.data==c.startData||/\u200b/.test(a.data)||(c.data=a.data),setTimeout(function(){c.handled||b.applyComposition(c);b.composing==c&&(b.composing=null)},50))});M(a,"touchstart",function(){b.forceCompositionEnd()});M(a,"input",function(){b.composing||!ma(d)&&b.pollContent()||da(b.cm,function(){za(d)})});M(a,
"copy",c);M(a,"cut",c)},prepareSelection:function(){var a=Jb(this.cm,!1);a.focus=this.cm.state.focused;return a},showSelection:function(a){a&&this.cm.display.view.length&&(a.focus&&this.showPrimarySelection(),this.showMultipleSelections(a))},showPrimarySelection:function(){var a=window.getSelection(),c=this.cm.doc.sel.primary(),b=X(this.cm,a.anchorNode,a.anchorOffset),d=X(this.cm,a.focusNode,a.focusOffset);if(!b||b.bad||!d||d.bad||0!=P(db(b,d),c.from())||0!=P(Cb(b,d),c.to()))if(b=Cc(this.cm,c.from()),
d=Cc(this.cm,c.to()),b||d){var e=this.cm.display.view,c=a.rangeCount&&a.getRangeAt(0);b?d||(d=e[e.length-1].measure,d=d.maps?d.maps[d.maps.length-1]:d.map,d={node:d[d.length-1],offset:d[d.length-2]-d[d.length-3]}):b={node:e[0].measure.map[2],offset:0};try{var g=Kb(b.node,b.offset,d.offset,d.node)}catch(h){}g&&(a.removeAllRanges(),a.addRange(g),c&&null==a.anchorNode?a.addRange(c):tb&&this.startGracePeriod());this.rememberSelection()}},startGracePeriod:function(){var a=this;clearTimeout(this.gracePeriod);
this.gracePeriod=setTimeout(function(){a.gracePeriod=!1;a.selectionChanged()&&a.cm.operation(function(){a.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(a){Ka(this.cm.display.cursorDiv,a.cursors);Ka(this.cm.display.selectionDiv,a.selection)},rememberSelection:function(){var a=window.getSelection();this.lastAnchorNode=a.anchorNode;this.lastAnchorOffset=a.anchorOffset;this.lastFocusNode=a.focusNode;this.lastFocusOffset=a.focusOffset},selectionInEditor:function(){var a=window.getSelection();
if(!a.rangeCount)return!1;a=a.getRangeAt(0).commonAncestorContainer;return Ld(this.div,a)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function a(){c.cm.state.focused&&(c.pollSelection(),c.polling.set(c.cm.options.pollInterval,a))}var c=this;this.selectionInEditor()?this.pollSelection():da(this.cm,function(){c.cm.curOp.selectionChanged=!0});
this.polling.set(this.cm.options.pollInterval,a)},selectionChanged:function(){var a=window.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var a=window.getSelection(),c=this.cm;this.rememberSelection();var b=X(c,a.anchorNode,a.anchorOffset),d=X(c,a.focusNode,a.focusOffset);b&&d&&da(c,function(){ea(c.doc,
Ga(b,d),fb);if(b.bad||d.bad)c.curOp.selectionChanged=!0})}},pollContent:function(){var a=this.cm,c=a.display,b=a.doc.sel.primary(),d=b.from(),b=b.to();if(d.line<c.viewFrom||b.line>c.viewTo-1)return!1;var e;d.line==c.viewFrom||0==(e=Ab(a,d.line))?(d=Y(c.view[0].line),e=c.view[0].node):(d=Y(c.view[e].line),e=c.view[e-1].node.nextSibling);var g=Ab(a,b.line);g==c.view.length-1?(b=c.viewTo-1,c=c.lineDiv.lastChild):(b=Y(c.view[g+1].line)-1,c=c.view[g+1].node.previousSibling);c=a.doc.splitLines(Eb(a,e,c,
d,b));for(e=Fb(a.doc,F(d,0),F(b,L(a.doc,b).text.length));1<c.length&&1<e.length;)if(U(c)==U(e))c.pop(),e.pop(),b--;else if(c[0]==e[0])c.shift(),e.shift(),d++;else break;for(var h=0,g=0,m=c[0],f=e[0],l=Math.min(m.length,f.length);h<l&&m.charCodeAt(h)==f.charCodeAt(h);)++h;m=U(c);f=U(e);for(l=Math.min(m.length-(1==c.length?h:0),f.length-(1==e.length?h:0));g<l&&m.charCodeAt(m.length-g-1)==f.charCodeAt(f.length-g-1);)++g;c[c.length-1]=m.slice(0,m.length-g);c[0]=c[0].slice(h);d=F(d,h);b=F(b,e.length?U(e).length-
g:0);if(1<c.length||c[0]||P(d,b))return hc(a.doc,c,d,b,"+input"),!0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(a){ma(this.cm)?ia(this.cm,za)(this.cm):a.data&&a.data!=a.startData&&ia(this.cm,Aa)(this.cm,a.data,0,a.sel)},setUneditable:function(a){a.contentEditable=
"false"},onKeyPress:function(a){a.preventDefault();ma(this.cm)||ia(this.cm,Aa)(this.cm,String.fromCharCode(null==a.charCode?a.keyCode:a.charCode),0)},readOnlyChanged:function(a){this.div.contentEditable=String("nocursor"!=a)},onContextMenu:Xc,resetPosition:Xc,needsContentAttribute:!0},Ja.prototype);f.inputStyles={textarea:Zb,contenteditable:Ja};Ya.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||a.ranges.length!=
this.ranges.length)return!1;for(var c=0;c<this.ranges.length;c++){var b=this.ranges[c],d=a.ranges[c];if(0!=P(b.anchor,d.anchor)||0!=P(b.head,d.head))return!1}return!0},deepCopy:function(){for(var a=[],c=0;c<this.ranges.length;c++)a[c]=new V(yc(this.ranges[c].anchor),yc(this.ranges[c].head));return new Ya(a,this.primIndex)},somethingSelected:function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1},contains:function(a,c){c||(c=a);for(var b=0;b<this.ranges.length;b++){var d=
this.ranges[b];if(0<=P(c,d.from())&&0>=P(a,d.to()))return b}return-1}};V.prototype={from:function(){return db(this.anchor,this.head)},to:function(){return Cb(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Od={left:0,right:0,top:0,bottom:0},Lb,gc=null,Ef=0,pd,od,ye=0,qd=0,La=null;R?La=-.53:tb?La=15:jg?La=-.7:ze&&(La=-1/3);var Ge=function(a){var c=a.wheelDeltaX,b=a.wheelDeltaY;null==c&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(c=a.detail);
null==b&&a.detail&&a.axis==a.VERTICAL_AXIS?b=a.detail:null==b&&(b=a.wheelDelta);return{x:c,y:b}};f.wheelEventPixels=function(a){a=Ge(a);a.x*=La;a.y*=La;return a};var Pf=new pc,Xd=null,Nb=f.changeEnd=function(a){return a.text?F(a.from.line+a.text.length-1,U(a.text).length+(1==a.text.length?a.from.ch:0)):a.to};f.prototype={constructor:f,focus:function(){window.focus();this.display.input.focus()},setOption:function(a,c){var b=this.options,d=b[a];if(b[a]!=c||"mode"==a)b[a]=c,Sb.hasOwnProperty(a)&&ia(this,
Sb[a])(this,c,d)},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,c){this.state.keyMaps[c?"push":"unshift"](zd(a))},removeKeyMap:function(a){for(var c=this.state.keyMaps,b=0;b<c.length;++b)if(c[b]==a||c[b].name==a)return c.splice(b,1),!0},addOverlay:ua(function(a,c){var b=a.token?a:f.getMode(this.options,a);if(b.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:b,modeSpec:a,opaque:c&&c.opaque});this.state.modeGen++;
za(this)}),removeOverlay:ua(function(a){for(var c=this.state.overlays,b=0;b<c.length;++b){var d=c[b].modeSpec;if(d==a||"string"==typeof a&&d.name==a){c.splice(b,1);this.state.modeGen++;za(this);break}}}),indentLine:ua(function(a,c,b){"string"!=typeof c&&"number"!=typeof c&&(c=null==c?this.options.smartIndent?"smart":"prev":c?"add":"subtract");jb(this.doc,a)&&Ac(this,a,c,b)}),indentSelection:ua(function(a){for(var c=this.doc.sel.ranges,b=-1,d=0;d<c.length;d++){var e=c[d];if(e.empty())e.head.line>b&&
(Ac(this,e.head.line,a,!0),b=e.head.line,d==this.doc.sel.primIndex&&Xb(this));else{for(var g=e.from(),e=e.to(),h=Math.max(b,g.line),b=Math.min(this.lastLine(),e.line-(e.ch?0:1))+1,e=h;e<b;++e)Ac(this,e,a);e=this.doc.sel.ranges;0==g.ch&&c.length==e.length&&0<e[d].from().ch&&cc(this.doc,d,new V(g,e[d].to()),fb)}}}),getTokenAt:function(a,c){return ef(this,a,c)},getLineTokens:function(a,c){return ef(this,F(a),c,!0)},getTokenTypeAt:function(a){a=N(this.doc,a);var c=gf(this,L(this.doc,a.line)),b=0,d=(c.length-
1)/2;a=a.ch;if(0==a)c=c[2];else for(;;){var e=b+d>>1;if((e?c[2*e-1]:0)>=a)d=e;else if(c[2*e+1]<a)b=e+1;else{c=c[2*e+2];break}}b=c?c.indexOf("cm-overlay "):-1;return 0>b?c:0==b?null:c.slice(0,b-1)},getModeAt:function(a){var c=this.doc.mode;return c.innerMode?f.innerMode(c,this.getTokenAt(a).state).mode:c},getHelper:function(a,c){return this.getHelpers(a,c)[0]},getHelpers:function(a,c){var b=[];if(!nc.hasOwnProperty(c))return b;var d=nc[c],e=this.getModeAt(a);if("string"==typeof e[c])d[e[c]]&&b.push(d[e[c]]);
else if(e[c])for(var g=0;g<e[c].length;g++){var h=d[e[c][g]];h&&b.push(h)}else e.helperType&&d[e.helperType]?b.push(d[e.helperType]):d[e.name]&&b.push(d[e.name]);for(g=0;g<d._global.length;g++)h=d._global[g],h.pred(e,this)&&-1==sa(b,h.val)&&b.push(h.val);return b},getStateAfter:function(a,c){var b=this.doc;a=Math.max(b.first,Math.min(null==a?b.first+b.size-1:a,b.first+b.size-1));return Ba(this,a+1,c)},cursorCoords:function(a,c){var b;b=this.doc.sel.primary();b=null==a?b.head:"object"==typeof a?N(this.doc,
a):a?b.from():b.to();return d(this,b,c||"page")},charCoords:function(a,c){return b(this,N(this.doc,a),c||"page")},coordsChar:function(a,c){a=Ra(this,a,c||"page");return m(this,a.left,a.top)},lineAtHeight:function(a,c){a=Ra(this,{top:a,left:0},c||"page").top;return zb(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,c){var b=!1,d;"number"==typeof a?(d=this.doc.first+this.doc.size-1,a<this.doc.first?a=this.doc.first:a>d&&(a=d,b=!0),d=L(this.doc,a)):d=a;return fc(this,d,{top:0,left:0},c||
"page").top+(b?this.doc.height-bb(d):0)},defaultTextHeight:function(){return A(this.display)},defaultCharWidth:function(){return E(this.display)},setGutterMarker:ua(function(a,c,b){return xd(this.doc,a,"gutter",function(a){var d=a.gutterMarkers||(a.gutterMarkers={});d[c]=b;!b&&qf(d)&&(a.gutterMarkers=null);return!0})}),clearGutter:ua(function(a){var c=this,b=c.doc,d=b.first;b.iter(function(b){b.gutterMarkers&&b.gutterMarkers[a]&&(b.gutterMarkers[a]=null,lb(c,d,"gutter"),qf(b.gutterMarkers)&&(b.gutterMarkers=
null));++d})}),lineInfo:function(a){if("number"==typeof a){if(!jb(this.doc,a))return null;var c=a;a=L(this.doc,a);if(!a)return null}else if(c=Y(a),null==c)return null;return{line:c,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(a,c,b,e,g){var h=this.display;a=d(this,N(this.doc,a));var m=a.bottom,f=a.left;c.style.position=
"absolute";c.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(c);h.sizer.appendChild(c);if("over"==e)m=a.top;else if("above"==e||"near"==e){var l=Math.max(h.wrapper.clientHeight,this.doc.height),A=Math.max(h.sizer.clientWidth,h.lineSpace.clientWidth);("above"==e||a.bottom+c.offsetHeight>l)&&a.top>c.offsetHeight?m=a.top-c.offsetHeight:a.bottom+c.offsetHeight<=l&&(m=a.bottom);f+c.offsetWidth>A&&(f=A-c.offsetWidth)}c.style.top=m+"px";c.style.left=c.style.right="";"right"==g?(f=
h.sizer.clientWidth-c.offsetWidth,c.style.right="0px"):("left"==g?f=0:"middle"==g&&(f=(h.sizer.clientWidth-c.offsetWidth)/2),c.style.left=f+"px");b&&(a=ld(this,f,m,f+c.offsetWidth,m+c.offsetHeight),null!=a.scrollTop&&uc(this,a.scrollTop),null!=a.scrollLeft&&Tb(this,a.scrollLeft))},triggerOnKeyDown:ua(Ce),triggerOnKeyPress:ua(De),triggerOnKeyUp:Be,execCommand:function(a){if(sd.hasOwnProperty(a))return sd[a].call(null,this)},triggerElectric:ua(function(a){zc(this,a)}),findPosH:function(a,c,b,d){var e=
1;0>c&&(e=-1,c=-c);var g=0;for(a=N(this.doc,a);g<c&&(a=be(this.doc,a,e,b,d),!a.hitSide);++g);return a},moveH:ua(function(a,c){var b=this;b.extendSelectionsBy(function(d){return b.display.shift||b.doc.extend||d.empty()?be(b.doc,d.head,a,c,b.options.rtlMoveVisually):0>a?d.from():d.to()},Zc)}),deleteH:ua(function(a,c){var b=this.doc;this.doc.sel.somethingSelected()?b.replaceSelection("",null,"+delete"):ic(this,function(d){var e=be(b,d.head,a,c,!1);return 0>a?{from:e,to:d.head}:{from:d.head,to:e}})}),
findPosV:function(a,c,b,e){var g=1;0>c&&(g=-1,c=-c);var h=0;for(a=N(this.doc,a);h<c&&(a=d(this,a,"div"),null==e?e=a.left:a.left=e,a=We(this,a,g,b),!a.hitSide);++h);return a},moveV:ua(function(a,c){var e=this,g=this.doc,h=[],m=!e.display.shift&&!g.extend&&g.sel.somethingSelected();g.extendSelectionsBy(function(f){if(m)return 0>a?f.from():f.to();var l=d(e,f.head,"div");null!=f.goalColumn&&(l.left=f.goalColumn);h.push(l.left);var A=We(e,l,a,c);"page"==c&&f==g.sel.primary()&&vd(e,null,b(e,A,"div").top-
l.top);return A},Zc);if(h.length)for(var f=0;f<g.sel.ranges.length;f++)g.sel.ranges[f].goalColumn=h[f]}),findWordAt:function(a){var c=L(this.doc,a.line).text,b=a.ch,d=a.ch;if(c){var e=this.getHelper(a,"wordChars");(0>a.xRel||d==c.length)&&b?--b:++d;for(var g=c.charAt(b),g=yd(g,e)?function(a){return yd(a,e)}:/\s/.test(g)?function(a){return/\s/.test(a)}:function(a){return!/\s/.test(a)&&!yd(a)};0<b&&g(c.charAt(b-1));)--b;for(;d<c.length&&g(c.charAt(d));)++d}return new V(F(a.line,b),F(a.line,d))},toggleOverwrite:function(a){if(null==
a||a!=this.state.overwrite)(this.state.overwrite=!this.state.overwrite)?vc(this.display.cursorDiv,"CodeMirror-overwrite"):tc(this.display.cursorDiv,"CodeMirror-overwrite"),na(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==cb()},scrollTo:ua(function(a,c){null==a&&null==c||wd(this);null!=a&&(this.curOp.scrollLeft=a);null!=c&&(this.curOp.scrollTop=c)}),getScrollInfo:function(){var a=this.display.scroller;return{left:a.scrollLeft,top:a.scrollTop,
height:a.scrollHeight-J(this)-this.display.barHeight,width:a.scrollWidth-J(this)-this.display.barWidth,clientHeight:Na(this),clientWidth:Ea(this)}},scrollIntoView:ua(function(a,c){null==a?(a={from:this.doc.sel.primary().head,to:null},null==c&&(c=this.options.cursorScrollMargin)):"number"==typeof a?a={from:F(a,0),to:null}:null==a.from&&(a={from:a,to:null});a.to||(a.to=a.from);a.margin=c||0;if(null!=a.from.line)wd(this),this.curOp.scrollToPos=a;else{var b=ld(this,Math.min(a.from.left,a.to.left),Math.min(a.from.top,
a.to.top)-a.margin,Math.max(a.from.right,a.to.right),Math.max(a.from.bottom,a.to.bottom)+a.margin);this.scrollTo(b.scrollLeft,b.scrollTop)}}),setSize:ua(function(a,c){function b(a){return"number"==typeof a||/^\d+$/.test(String(a))?a+"px":a}var d=this;null!=a&&(d.display.wrapper.style.width=b(a));null!=c&&(d.display.wrapper.style.height=b(c));d.options.lineWrapping&&Nc(this);var e=d.display.viewFrom;d.doc.iter(e,d.display.viewTo,function(a){if(a.widgets)for(var c=0;c<a.widgets.length;c++)if(a.widgets[c].noHScroll){lb(d,
e,"widget");break}++e});d.curOp.forceUpdate=!0;na(d,"refresh",this)}),operation:function(a){return da(this,a)},refresh:ua(function(){var a=this.display.cachedTextHeight;za(this);this.curOp.forceUpdate=!0;wb(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);w(this);(null==a||.5<Math.abs(a-A(this.display)))&&n(this);na(this,"refresh",this)}),swapDoc:ua(function(a){var c=this.doc;c.cm=null;le(this,a);wb(this);this.display.input.reset();this.scrollTo(a.scrollLeft,a.scrollTop);this.curOp.forceScroll=
!0;wa(this,"swapDoc",this,c);return c}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};lc(f);var zf=f.defaults={},Sb=f.optionHandlers={},me=f.Init={toString:function(){return"CodeMirror.Init"}};O("value","",function(a,c){a.setValue(c)},!0);O("mode",null,function(a,c){a.doc.modeOption=c;I(a)},!0);O("indentUnit",
2,I,!0);O("indentWithTabs",!1);O("smartIndent",!0);O("tabSize",4,function(a){l(a);wb(a);za(a)},!0);O("lineSeparator",null,function(a,c){if(a.doc.lineSep=c){var b=[],d=a.doc.first;a.doc.iter(function(a){for(var e=0;;){var g=a.text.indexOf(c,e);if(-1==g)break;e=g+c.length;b.push(F(d,g))}d++});for(var e=b.length-1;0<=e;e--)hc(a.doc,c,b[e],F(b[e].line,b[e].ch+c.length))}});O("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(a,c,b){a.state.specialChars=new RegExp(c.source+
(c.test("\t")?"":"|\t"),"g");b!=f.Init&&a.refresh()});O("specialCharPlaceholder",function(a){var c=K("span","\u2022","cm-invalidchar");c.title="\\u"+a.charCodeAt(0).toString(16);c.setAttribute("aria-label",c.title);return c},function(a){a.refresh()},!0);O("electricChars",!0);O("inputStyle",oc?"contenteditable":"textarea",function(){throw Error("inputStyle can not (yet) be changed in a running editor");},!0);O("rtlMoveVisually",!lg);O("wholeLineUpdateBefore",!0);O("theme","default",function(a){y(a);
B(a)},!0);O("keyMap","default",function(a,c,b){c=zd(c);(b=b!=f.Init&&zd(b))&&b.detach&&b.detach(a,c);c.attach&&c.attach(a,b||null)});O("extraKeys",null);O("lineWrapping",!1,function(a){a.options.lineWrapping?(vc(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(tc(a.display.wrapper,"CodeMirror-wrap"),x(a));n(a);za(a);wb(a);setTimeout(function(){u(a)},100)},!0);O("gutters",[],function(a){T(a.options);B(a)},!0);O("fixedGutter",!0,function(a,c){a.display.gutters.style.left=
c?va(a.display)+"px":"0";a.refresh()},!0);O("coverGutterNextToScrollbar",!1,function(a){u(a)},!0);O("scrollbarStyle","native",function(a){C(a);u(a);a.display.scrollbars.setScrollTop(a.doc.scrollTop);a.display.scrollbars.setScrollLeft(a.doc.scrollLeft)},!0);O("lineNumbers",!1,function(a){T(a.options);B(a)},!0);O("firstLineNumber",1,B,!0);O("lineNumberFormatter",function(a){return a},B,!0);O("showCursorWhenSelecting",!1,Bb,!0);O("resetSelectionOnContextMenu",!0);O("lineWiseCopyCut",!0);O("readOnly",
!1,function(a,c){"nocursor"==c?(rc(a),a.display.input.blur(),a.display.disabled=!0):a.display.disabled=!1;a.display.input.readOnlyChanged(c)});O("disableInput",!1,function(a,c){c||a.display.input.reset()},!0);O("dragDrop",!0,function(a,c,b){!c!=!(b&&b!=f.Init)&&(b=a.display.dragFunctions,c=c?M:hb,c(a.display.scroller,"dragstart",b.start),c(a.display.scroller,"dragenter",b.enter),c(a.display.scroller,"dragover",b.over),c(a.display.scroller,"dragleave",b.leave),c(a.display.scroller,"drop",b.drop))});
O("allowDropFileTypes",null);O("cursorBlinkRate",530);O("cursorScrollMargin",0);O("cursorHeight",1,Bb,!0);O("singleCursorHeightPerLine",!0,Bb,!0);O("workTime",100);O("workDelay",100);O("flattenSpans",!0,l,!0);O("addModeClass",!1,l,!0);O("pollInterval",100);O("undoDepth",200,function(a,c){a.doc.history.undoDepth=c});O("historyEventDelay",1250);O("viewportMargin",10,function(a){a.refresh()},!0);O("maxHighlightLength",1E4,l,!0);O("moveInputWithCursor",!0,function(a,c){c||a.display.input.resetPosition()});
O("tabindex",null,function(a,c){a.display.input.getField().tabIndex=c||""});O("autofocus",null);var yf=f.modes={},$c=f.mimeModes={};f.defineMode=function(a,c){f.defaults.mode||"null"==a||(f.defaults.mode=a);2<arguments.length&&(c.dependencies=Array.prototype.slice.call(arguments,2));yf[a]=c};f.defineMIME=function(a,c){$c[a]=c};f.resolveMode=function(a){if("string"==typeof a&&$c.hasOwnProperty(a))a=$c[a];else if(a&&"string"==typeof a.name&&$c.hasOwnProperty(a.name)){var c=$c[a.name];"string"==typeof c&&
(c={name:c});a=of(c,a);a.name=c.name}else if("string"==typeof a&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return f.resolveMode("application/xml");return"string"==typeof a?{name:a}:a||{name:"null"}};f.getMode=function(a,c){c=f.resolveMode(c);var b=yf[c.name];if(!b)return f.getMode(a,"text/plain");b=b(a,c);if(ad.hasOwnProperty(c.name)){var d=ad[c.name],e;for(e in d)d.hasOwnProperty(e)&&(b.hasOwnProperty(e)&&(b["_"+e]=b[e]),b[e]=d[e])}b.name=c.name;c.helperType&&(b.helperType=c.helperType);if(c.modeProps)for(e in c.modeProps)b[e]=
c.modeProps[e];return b};f.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}});f.defineMIME("text/plain","null");var ad=f.modeExtensions={};f.extendMode=function(a,c){var b=ad.hasOwnProperty(a)?ad[a]:ad[a]={};Ta(c,b)};f.defineExtension=function(a,c){f.prototype[a]=c};f.defineDocExtension=function(a,c){Ca.prototype[a]=c};f.defineOption=O;var Id=[];f.defineInitHook=function(a){Id.push(a)};var nc=f.helpers={};f.registerHelper=function(a,c,b){nc.hasOwnProperty(a)||(nc[a]=f[a]={_global:[]});
nc[a][c]=b};f.registerGlobalHelper=function(a,c,b,d){f.registerHelper(a,c,d);nc[a]._global.push({pred:b,val:d})};var rb=f.copyState=function(a,c){if(!0===c)return c;if(a.copyState)return a.copyState(c);var b={},d;for(d in c){var e=c[d];e instanceof Array&&(e=e.concat([]));b[d]=e}return b},Df=f.startState=function(a,c,b){return a.startState?a.startState(c,b):!0};f.innerMode=function(a,c){for(;a.innerMode;){var b=a.innerMode(c);if(!b||b.mode==a)break;c=b.state;a=b.mode}return b||{mode:a,state:c}};var sd=
f.commands={selectAll:function(a){a.setSelection(F(a.firstLine(),0),F(a.lastLine()),fb)},singleSelection:function(a){a.setSelection(a.getCursor("anchor"),a.getCursor("head"),fb)},killLine:function(a){ic(a,function(c){if(c.empty()){var b=L(a.doc,c.head.line).text.length;return c.head.ch==b&&c.head.line<a.lastLine()?{from:c.head,to:F(c.head.line+1,0)}:{from:c.head,to:F(c.head.line,b)}}return{from:c.from(),to:c.to()}})},deleteLine:function(a){ic(a,function(c){return{from:F(c.from().line,0),to:N(a.doc,
F(c.to().line+1,0))}})},delLineLeft:function(a){ic(a,function(a){return{from:F(a.from().line,0),to:a.from()}})},delWrappedLineLeft:function(a){ic(a,function(c){var b=a.charCoords(c.head,"div").top+5;return{from:a.coordsChar({left:0,top:b},"div"),to:c.from()}})},delWrappedLineRight:function(a){ic(a,function(c){var b=a.charCoords(c.head,"div").top+5,b=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div");return{from:c.from(),to:b}})},undo:function(a){a.undo()},redo:function(a){a.redo()},
undoSelection:function(a){a.undoSelection()},redoSelection:function(a){a.redoSelection()},goDocStart:function(a){a.extendSelection(F(a.firstLine(),0))},goDocEnd:function(a){a.extendSelection(F(a.lastLine()))},goLineStart:function(a){a.extendSelectionsBy(function(c){return sf(a,c.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){a.extendSelectionsBy(function(c){return tf(a,c.head)},{origin:"+move",bias:1})},goLineEnd:function(a){a.extendSelectionsBy(function(c){c=c.head.line;for(var b,
d=L(a.doc,c);b=yb(d,!1);)d=b.find(1,!0).line,c=null;b=(b=Xa(d))?b[0].level%2?jd(d):kd(d):d.text.length;return F(null==c?Y(d):c,b)},{origin:"+move",bias:-1})},goLineRight:function(a){a.extendSelectionsBy(function(c){c=a.charCoords(c.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:c},"div")},Zc)},goLineLeft:function(a){a.extendSelectionsBy(function(c){c=a.charCoords(c.head,"div").top+5;return a.coordsChar({left:0,top:c},"div")},Zc)},goLineLeftSmart:function(a){a.extendSelectionsBy(function(c){var b=
a.charCoords(c.head,"div").top+5,b=a.coordsChar({left:0,top:b},"div");return b.ch<a.getLine(b.line).search(/\S/)?tf(a,c.head):b},Zc)},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,
"word")},goGroupRight:function(a){a.moveH(1,"group")},goGroupLeft:function(a){a.moveH(-1,"group")},goWordRight:function(a){a.moveH(1,"word")},delCharBefore:function(a){a.deleteH(-1,"char")},delCharAfter:function(a){a.deleteH(1,"char")},delWordBefore:function(a){a.deleteH(-1,"word")},delWordAfter:function(a){a.deleteH(1,"word")},delGroupBefore:function(a){a.deleteH(-1,"group")},delGroupAfter:function(a){a.deleteH(1,"group")},indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},
indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection("\t")},insertSoftTab:function(a){for(var c=[],b=a.listSelections(),d=a.options.tabSize,e=0;e<b.length;e++){var g=b[e].from(),g=Za(a.getLine(g.line),g.ch,d);c.push(Array(d-g%d+1).join(" "))}a.replaceSelections(c)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){da(a,function(){for(var c=a.listSelections(),b=[],d=0;d<c.length;d++){var e=
c[d].head,g=L(a.doc,e.line).text;if(g)if(e.ch==g.length&&(e=new F(e.line,e.ch-1)),0<e.ch)e=new F(e.line,e.ch+1),a.replaceRange(g.charAt(e.ch-1)+g.charAt(e.ch-2),F(e.line,e.ch-2),e,"+transpose");else if(e.line>a.doc.first){var h=L(a.doc,e.line-1).text;h&&a.replaceRange(g.charAt(0)+a.doc.lineSeparator()+h.charAt(h.length-1),F(e.line-1,h.length-1),F(e.line,1),"+transpose")}b.push(new V(e,e))}a.setSelections(b)})},newlineAndIndent:function(a){da(a,function(){for(var c=a.listSelections().length,b=0;b<
c;b++){var d=a.listSelections()[b];a.replaceRange(a.doc.lineSeparator(),d.anchor,d.head,"+input");a.indentLine(d.from().line+1,null,!0)}Xb(a)})},toggleOverwrite:function(a){a.toggleOverwrite()}},sb=f.keyMap={};sb.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",
Insert:"toggleOverwrite",Esc:"singleSelection"};sb.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace",
"Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};sb.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore",
"Ctrl-K":"killLine","Ctrl-T":"transposeChars"};sb.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev",
"Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};sb["default"]=Va?sb.macDefault:sb.pcDefault;f.normalizeKeyMap=function(a){var c={},b;for(b in a)if(a.hasOwnProperty(b)){var d=a[b];if(!/^(name|fallthrough|(de|at)tach)$/.test(b)){if("..."!=d)for(var e=ed(b.split(" "),
Vf),g=0;g<e.length;g++){var h,m;g==e.length-1?(m=e.join(" "),h=d):(m=e.slice(0,g+1).join(" "),h="...");var f=c[m];if(!f)c[m]=h;else if(f!=h)throw Error("Inconsistent bindings for "+m);}delete a[b]}}for(var l in c)a[l]=c[l];return a};var Qc=f.lookupKey=function(a,c,b,d){c=zd(c);var e=c.call?c.call(a,d):c[a];if(!1===e)return"nothing";if("..."===e)return"multi";if(null!=e&&b(e))return"handled";if(c.fallthrough){if("[object Array]"!=Object.prototype.toString.call(c.fallthrough))return Qc(a,c.fallthrough,
b,d);for(e=0;e<c.fallthrough.length;e++){var g=Qc(a,c.fallthrough[e],b,d);if(g)return g}}},Of=f.isModifierKey=function(a){a="string"==typeof a?a:Rb[a.keyCode];return"Ctrl"==a||"Alt"==a||"Shift"==a||"Mod"==a},Qf=f.keyName=function(a,c){if($a&&34==a.keyCode&&a["char"])return!1;var b=Rb[a.keyCode],d=b;if(null==d||a.altGraphKey)return!1;a.altKey&&"Alt"!=b&&(d="Alt-"+d);(xf?a.metaKey:a.ctrlKey)&&"Ctrl"!=b&&(d="Ctrl-"+d);(xf?a.ctrlKey:a.metaKey)&&"Cmd"!=b&&(d="Cmd-"+d);!c&&a.shiftKey&&"Shift"!=b&&(d="Shift-"+
d);return d};f.fromTextArea=function(a,c){function b(){a.value=l.getValue()}c=c?Ta(c):{};c.value=a.value;!c.tabindex&&a.tabIndex&&(c.tabindex=a.tabIndex);!c.placeholder&&a.placeholder&&(c.placeholder=a.placeholder);if(null==c.autofocus){var d=cb();c.autofocus=d==a||null!=a.getAttribute("autofocus")&&d==document.body}if(a.form&&(M(a.form,"submit",b),!c.leaveSubmitMethodAlone)){var e=a.form,g=e.submit;try{var h=e.submit=function(){b();e.submit=g;e.submit();e.submit=h}}catch(m){}}c.finishInit=function(c){c.save=
b;c.getTextArea=function(){return a};c.toTextArea=function(){c.toTextArea=isNaN;b();a.parentNode.removeChild(c.getWrapperElement());a.style.display="";a.form&&(hb(a.form,"submit",b),"function"==typeof a.form.submit&&(a.form.submit=g))}};a.style.display="none";var l=f(function(c){a.parentNode.insertBefore(c,a.nextSibling)},c);return l};var Dd=f.StringStream=function(a,c){this.pos=this.start=0;this.string=a;this.tabSize=c||8;this.lineStart=this.lastColumnPos=this.lastColumnValue=0};Dd.prototype={eol:function(){return this.pos>=
this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var c=this.string.charAt(this.pos);if("string"==typeof a?c==a:c&&(a.test?a.test(c):a(c)))return++this.pos,c},eatWhile:function(a){for(var c=this.pos;this.eat(a););return this.pos>c},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;
return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){a=this.string.indexOf(a,this.pos);if(-1<a)return this.pos=a,!0},backUp:function(a){this.pos-=a},column:function(){this.lastColumnPos<this.start&&(this.lastColumnValue=Za(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?Za(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Za(this.string,
null,this.tabSize)-(this.lineStart?Za(this.string,this.lineStart,this.tabSize):0)},match:function(a,c,b){if("string"==typeof a){var d=function(a){return b?a.toLowerCase():a},e=this.string.substr(this.pos,a.length);if(d(e)==d(a))return!1!==c&&(this.pos+=a.length),!0}else{if((a=this.string.slice(this.pos).match(a))&&0<a.index)return null;a&&!1!==c&&(this.pos+=a[0].length);return a}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(a,c){this.lineStart+=a;try{return c()}finally{this.lineStart-=
a}}};var ce=0,Pb=f.TextMarker=function(a,c){this.lines=[];this.type=c;this.doc=a;this.id=++ce};lc(Pb);Pb.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,c=a&&!a.curOp;c&&q(a);if(Qa(this,"clear")){var b=this.find();b&&wa(this,"clear",b.from,b.to)}for(var d=b=null,e=0;e<this.lines.length;++e){var g=this.lines[e],h=Sc(g.markedSpans,this);a&&!this.collapsed?lb(a,Y(g),"text"):a&&(null!=h.to&&(d=Y(g)),null!=h.from&&(b=Y(g)));for(var m=g,f=g.markedSpans,l=h,t=void 0,E=0;E<f.length;++E)f[E]!=
l&&(t||(t=[])).push(f[E]);m.markedSpans=t;null==h.from&&this.collapsed&&!ub(this.doc,g)&&a&&ab(g,A(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(e=0;e<this.lines.length;++e)g=gb(this.lines[e]),h=r(g),h>a.display.maxLineLength&&(a.display.maxLine=g,a.display.maxLineLength=h,a.display.maxLineChanged=!0);null!=b&&a&&this.collapsed&&za(a,b,d+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Ic(a.doc));a&&wa(a,"markerCleared",a,this);
c&&Ua(a);this.parent&&this.parent.clear()}};Pb.prototype.find=function(a,c){null==a&&"bookmark"==this.type&&(a=1);for(var b,d,e=0;e<this.lines.length;++e){var g=this.lines[e],h=Sc(g.markedSpans,this);if(null!=h.from&&(b=F(c?g:Y(g),h.from),-1==a))return b;if(null!=h.to&&(d=F(c?g:Y(g),h.to),1==a))return d}return b&&{from:b,to:d}};Pb.prototype.changed=function(){var a=this.find(-1,!0),c=this,b=this.doc.cm;a&&b&&da(b,function(){var d=a.line,e=Y(a.line);if(e=ac(b,e))Mc(e),b.curOp.selectionChanged=b.curOp.forceUpdate=
!0;b.curOp.updateMaxLine=!0;ub(c.doc,d)||null==c.height||(e=c.height,c.height=null,(e=Oc(c)-e)&&ab(d,d.height+e))})};Pb.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var c=this.doc.cm.curOp;c.maybeHiddenMarkers&&-1!=sa(c.maybeHiddenMarkers,this)||(c.maybeUnhiddenMarkers||(c.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)};Pb.prototype.detachLine=function(a){this.lines.splice(sa(this.lines,a),1);!this.lines.length&&this.doc.cm&&(a=this.doc.cm.curOp,(a.maybeHiddenMarkers||
(a.maybeHiddenMarkers=[])).push(this))};var ce=0,Bd=f.SharedTextMarker=function(a,c){this.markers=a;this.primary=c;for(var b=0;b<a.length;++b)a[b].parent=this};lc(Bd);Bd.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();wa(this,"clear")}};Bd.prototype.find=function(a,c){return this.primary.find(a,c)};var Cd=f.LineWidget=function(a,c,b){if(b)for(var d in b)b.hasOwnProperty(d)&&(this[d]=b[d]);this.doc=a;this.node=
c};lc(Cd);Cd.prototype.clear=function(){var a=this.doc.cm,c=this.line.widgets,b=this.line,d=Y(b);if(null!=d&&c){for(var e=0;e<c.length;++e)c[e]==this&&c.splice(e--,1);c.length||(b.widgets=null);var g=Oc(this);ab(b,Math.max(0,b.height-g));a&&da(a,function(){var c=-g;bb(b)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&vd(a,null,c);lb(a,d,"widget")})}};Cd.prototype.changed=function(){var a=this.height,c=this.doc.cm,b=this.line;this.height=null;var d=Oc(this)-a;d&&(ab(b,b.height+d),c&&da(c,function(){c.curOp.forceUpdate=
!0;bb(b)<(c.curOp&&c.curOp.scrollTop||c.doc.scrollTop)&&vd(c,null,d)}))};var Tc=f.Line=function(a,c,b){this.text=a;af(this,c);this.height=b?b(this):1};lc(Tc);Tc.prototype.lineNo=function(){return Y(this)};var ag={},$f={};Uc.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,c){for(var b=a,d=a+c;b<d;++b){var e=this.lines[b];this.height-=e.height;var g=e;g.parent=null;$e(g);wa(e,"delete")}this.lines.splice(a,c)},collapse:function(a){a.push.apply(a,this.lines)},insertInner:function(a,
c,b){this.height+=b;this.lines=this.lines.slice(0,a).concat(c).concat(this.lines.slice(a));for(a=0;a<c.length;++a)c[a].parent=this},iterN:function(a,c,b){for(c=a+c;a<c;++a)if(b(this.lines[a]))return!0}};Vc.prototype={chunkSize:function(){return this.size},removeInner:function(a,c){this.size-=c;for(var b=0;b<this.children.length;++b){var d=this.children[b],e=d.chunkSize();if(a<e){var g=Math.min(c,e-a),h=d.height;d.removeInner(a,g);this.height-=h-d.height;e==g&&(this.children.splice(b--,1),d.parent=
null);if(0==(c-=g))break;a=0}else a-=e}25>this.size-c&&(1<this.children.length||!(this.children[0]instanceof Uc))&&(b=[],this.collapse(b),this.children=[new Uc(b)],this.children[0].parent=this)},collapse:function(a){for(var b=0;b<this.children.length;++b)this.children[b].collapse(a)},insertInner:function(a,b,d){this.size+=b.length;this.height+=d;for(var e=0;e<this.children.length;++e){var g=this.children[e],h=g.chunkSize();if(a<=h){g.insertInner(a,b,d);if(g.lines&&50<g.lines.length){for(;50<g.lines.length;)a=
g.lines.splice(g.lines.length-25,25),a=new Uc(a),g.height-=a.height,this.children.splice(e+1,0,a),a.parent=this;this.maybeSpill()}break}a-=h}},maybeSpill:function(){if(!(10>=this.children.length)){var a=this;do{var b=a.children.splice(a.children.length-5,5),b=new Vc(b);if(a.parent){a.size-=b.size;a.height-=b.height;var d=sa(a.parent.children,a);a.parent.children.splice(d+1,0,b)}else d=new Vc(a.children),d.parent=a,a.children=[d,b],a=d;b.parent=a.parent}while(10<a.children.length);a.parent.maybeSpill()}},
iterN:function(a,b,d){for(var e=0;e<this.children.length;++e){var g=this.children[e],h=g.chunkSize();if(a<h){h=Math.min(b,h-a);if(g.iterN(a,h,d))return!0;if(0==(b-=h))break;a=0}else a-=h}}};var ng=0,Ca=f.Doc=function(a,b,d,e){if(!(this instanceof Ca))return new Ca(a,b,d,e);null==d&&(d=0);Vc.call(this,[new Uc([new Tc("",null)])]);this.first=d;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.frontier=d;d=F(d,0);this.sel=Ga(d);this.history=new Ed(null);this.id=++ng;this.modeOption=
b;this.lineSep=e;"string"==typeof a&&(a=this.splitLines(a));ae(this,{from:d,to:d,text:a});ea(this,Ga(d),fb)};Ca.prototype=of(Vc.prototype,{constructor:Ca,iter:function(a,b,d){d?this.iterN(a-this.first,b-a,d):this.iterN(this.first,this.first+this.size,a)},insert:function(a,b){for(var d=0,e=0;e<b.length;++e)d+=b[e].height;this.insertInner(a-this.first,b,d)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=he(this,this.first,this.first+this.size);return!1===a?b:b.join(a||
this.lineSeparator())},setValue:xa(function(a){var b=F(this.first,0),d=this.first+this.size-1;Wb(this,{from:b,to:F(d,L(this,d).text.length),text:this.splitLines(a),origin:"setValue",full:!0},!0);ea(this,Ga(b))}),replaceRange:function(a,b,d,e){b=N(this,b);d=d?N(this,d):b;hc(this,a,b,d,e)},getRange:function(a,b,d){a=Fb(this,N(this,a),N(this,b));return!1===d?a:a.join(d||this.lineSeparator())},getLine:function(a){return(a=this.getLineHandle(a))&&a.text},getLineHandle:function(a){if(jb(this,a))return L(this,
a)},getLineNumber:function(a){return Y(a)},getLineHandleVisualStart:function(a){"number"==typeof a&&(a=L(this,a));return gb(a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return N(this,a)},getCursor:function(a){var b=this.sel.primary();return null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||"to"==a||!1===a?b.to():b.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},
setCursor:xa(function(a,b,d){a=N(this,"number"==typeof a?F(a,b||0):a);ea(this,Ga(a,null),d)}),setSelection:xa(function(a,b,d){var e=N(this,a);a=N(this,b||a);ea(this,Ga(e,a),d)}),extendSelection:xa(function(a,b,d){eb(this,N(this,a),b&&N(this,b),d)}),extendSelections:xa(function(a,b){for(var d=[],e=0;e<a.length;e++)d[e]=N(this,a[e]);Ec(this,d)}),extendSelectionsBy:xa(function(a,b){Ec(this,ed(this.sel.ranges,a),b)}),setSelections:xa(function(a,b,d){if(a.length){for(var e=0,g=[];e<a.length;e++)g[e]=new V(N(this,
a[e].anchor),N(this,a[e].head));null==b&&(b=Math.min(a.length-1,this.sel.primIndex));ea(this,Fa(g,b),d)}}),addSelection:xa(function(a,b,d){var e=this.sel.ranges.slice(0);e.push(new V(N(this,a),N(this,b||a)));ea(this,Fa(e,e.length-1),d)}),getSelection:function(a){for(var b=this.sel.ranges,d,e=0;e<b.length;e++){var g=Fb(this,b[e].from(),b[e].to());d=d?d.concat(g):g}return!1===a?d:d.join(a||this.lineSeparator())},getSelections:function(a){for(var b=[],d=this.sel.ranges,e=0;e<d.length;e++){var g=Fb(this,
d[e].from(),d[e].to());!1!==a&&(g=g.join(a||this.lineSeparator()));b[e]=g}return b},replaceSelection:function(a,b,d){for(var e=[],g=0;g<this.sel.ranges.length;g++)e[g]=a;this.replaceSelections(e,b,d||"+input")},replaceSelections:xa(function(a,b,d){for(var e=[],g=this.sel,h=0;h<g.ranges.length;h++){var m=g.ranges[h];e[h]={from:m.from(),to:m.to(),text:this.splitLines(a[h]),origin:d}}if(h=b&&"end"!=b){h=[];d=a=F(this.first,0);for(g=0;g<e.length;g++){var f=e[g],m=Le(f.from,a,d),l=Le(Nb(f),a,d);a=f.to;
d=l;"around"==b?(f=this.sel.ranges[g],f=0>P(f.head,f.anchor),h[g]=new V(f?l:m,f?m:l)):h[g]=new V(m,m)}h=new Ya(h,this.sel.primIndex)}b=h;for(h=e.length-1;0<=h;h--)Wb(this,e[h]);b?Fc(this,b):this.cm&&Xb(this.cm)}),undo:xa(function(){ud(this,"undo")}),redo:xa(function(){ud(this,"redo")}),undoSelection:xa(function(){ud(this,"undo",!0)}),redoSelection:xa(function(){ud(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=
this.history,b=0,d=0,e=0;e<a.done.length;e++)a.done[e].ranges||++b;for(e=0;e<a.undone.length;e++)a.undone[e].ranges||++d;return{undo:b,redo:d}},clearHistory:function(){this.history=new Ed(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null);return this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},
getHistory:function(){return{done:kc(this.history.done),undone:kc(this.history.undone)}},setHistory:function(a){var b=this.history=new Ed(this.history.maxGeneration);b.done=kc(a.done.slice(0),null,!0);b.undone=kc(a.undone.slice(0),null,!0)},addLineClass:xa(function(a,b,d){return xd(this,a,"gutter"==b?"gutter":"class",function(a){var e="text"==b?"textClass":"background"==b?"bgClass":"gutter"==b?"gutterClass":"wrapClass";if(a[e]){if(Yc(d).test(a[e]))return!1;a[e]+=" "+d}else a[e]=d;return!0})}),removeLineClass:xa(function(a,
b,d){return xd(this,a,"gutter"==b?"gutter":"class",function(a){var e="text"==b?"textClass":"background"==b?"bgClass":"gutter"==b?"gutterClass":"wrapClass",g=a[e];if(g)if(null==d)a[e]=null;else{var h=g.match(Yc(d));if(!h)return!1;var m=h.index+h[0].length;a[e]=g.slice(0,h.index)+(h.index&&m!=g.length?" ":"")+g.slice(m)||null}else return!1;return!0})}),addLineWidget:xa(function(a,b,d){return Zf(this,a,b,d)}),removeLineWidget:function(a){a.clear()},markText:function(a,b,d){return jc(this,N(this,a),N(this,
b),d,d&&d.type||"range")},setBookmark:function(a,b){var d={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft,clearWhenEmpty:!1,shared:b&&b.shared,handleMouseEvents:b&&b.handleMouseEvents};a=N(this,a);return jc(this,a,a,d,"bookmark")},findMarksAt:function(a){a=N(this,a);var b=[],d=L(this,a.line).markedSpans;if(d)for(var e=0;e<d.length;++e){var g=d[e];(null==g.from||g.from<=a.ch)&&(null==g.to||g.to>=a.ch)&&b.push(g.marker.parent||g.marker)}return b},findMarks:function(a,b,d){a=
N(this,a);b=N(this,b);var e=[],g=a.line;this.iter(a.line,b.line+1,function(h){if(h=h.markedSpans)for(var m=0;m<h.length;m++){var f=h[m];g==a.line&&a.ch>f.to||null==f.from&&g!=a.line||g==b.line&&f.from>b.ch||d&&!d(f.marker)||e.push(f.marker.parent||f.marker)}++g});return e},getAllMarks:function(){var a=[];this.iter(function(b){if(b=b.markedSpans)for(var d=0;d<b.length;++d)null!=b[d].from&&a.push(b[d].marker)});return a},posFromIndex:function(a){var b,d=this.first;this.iter(function(e){e=e.text.length+
1;if(e>a)return b=a,!0;a-=e;++d});return N(this,F(d,b))},indexFromPos:function(a){a=N(this,a);var b=a.ch;if(a.line<this.first||0>a.ch)return 0;this.iter(this.first,a.line,function(a){b+=a.text.length+1});return b},copy:function(a){var b=new Ca(he(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);b.scrollTop=this.scrollTop;b.scrollLeft=this.scrollLeft;b.sel=this.sel;b.extend=!1;a&&(b.history.undoDepth=this.history.undoDepth,b.setHistory(this.getHistory()));return b},linkedDoc:function(a){a||
(a={});var b=this.first,d=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from);null!=a.to&&a.to<d&&(d=a.to);b=new Ca(he(this,b,d),a.mode||this.modeOption,b,this.lineSep);a.sharedHist&&(b.history=this.history);(this.linked||(this.linked=[])).push({doc:b,sharedHist:a.sharedHist});b.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}];a=Ye(this);for(d=0;d<a.length;d++){var e=a[d],g=e.find(),h=b.clipPos(g.from),g=b.clipPos(g.to);P(h,g)&&(h=jc(b,h,g,e.primary,e.primary.type),e.markers.push(h),h.parent=
e)}return b},unlinkDoc:function(a){a instanceof f&&(a=a.doc);if(this.linked)for(var b=0;b<this.linked.length;++b)if(this.linked[b].doc==a){this.linked.splice(b,1);a.unlinkDoc(this);Xf(Ye(this));break}if(a.history==this.history){var d=[a.id];Ob(a,function(a){d.push(a.id)},!0);a.history=new Ed(null);a.history.done=kc(this.history.done,d);a.history.undone=kc(this.history.undone,d)}},iterLinkedDocs:function(a){Ob(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?
a.split(this.lineSep):og(a)},lineSeparator:function(){return this.lineSep||"\n"}});Ca.prototype.eachLine=Ca.prototype.iter;var pg="iter insert remove copy getEditor constructor".split(" "),bd;for(bd in Ca.prototype)Ca.prototype.hasOwnProperty(bd)&&0>sa(pg,bd)&&(f.prototype[bd]=function(a){return function(){return a.apply(this.doc,arguments)}}(Ca.prototype[bd]));lc(Ca);var ya=f.e_preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},qg=f.e_stopPropagation=function(a){a.stopPropagation?
a.stopPropagation():a.cancelBubble=!0},nd=f.e_stop=function(a){ya(a);qg(a)},M=f.on=function(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):(a=a._handlers||(a._handlers={}),(a[b]||(a[b]=[])).push(d))},nf=[],hb=f.off=function(a,b,d){if(a.removeEventListener)a.removeEventListener(b,d,!1);else if(a.detachEvent)a.detachEvent("on"+b,d);else for(a=Fd(a,b,!1),b=0;b<a.length;++b)if(a[b]==d){a.splice(b,1);break}},na=f.signal=function(a,b){var d=Fd(a,b,!0);if(d.length)for(var e=
Array.prototype.slice.call(arguments,2),g=0;g<d.length;++g)d[g].apply(null,e)},Wc=null,ne=30,He=f.Pass={toString:function(){return"CodeMirror.Pass"}},fb={scroll:!1},Vd={origin:"*mouse"},Zc={origin:"+move"};pc.prototype.set=function(a,b){clearTimeout(this.id);this.id=setTimeout(b,a)};var Za=f.countColumn=function(a,b,d,e,g){null==b&&(b=a.search(/[^\s\u00a0]/),-1==b&&(b=a.length));e=e||0;for(g=g||0;;){var h=a.indexOf("\t",e);if(0>h||h>=b)return g+(b-e);g+=h-e;g+=d-g%d;e=h+1}},Fe=f.findColumn=function(a,
b,d){for(var e=0,g=0;;){var h=a.indexOf("\t",e);-1==h&&(h=a.length);var m=h-e;if(h==a.length||g+m>=b)return e+Math.min(m,b-g);g+=h-e;g+=d-g%d;e=h+1;if(g>=b)return e}},Gd=[""],mc=function(a){a.select()};$b?mc=function(a){a.selectionStart=0;a.selectionEnd=a.value.length}:R&&(mc=function(a){try{a.select()}catch(b){}});var rg=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,pf=f.isWordChar=function(a){return/\w/.test(a)||"\u0080"<a&&(a.toUpperCase()!=
a.toLowerCase()||rg.test(a))},hg=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,
Kb;Kb=document.createRange?function(a,b,d,e){var g=document.createRange();g.setEnd(e||a,d);g.setStart(a,b);return g}:function(a,b,d){var e=document.body.createTextRange();try{e.moveToElementText(a.parentNode)}catch(g){return e}e.collapse(!0);e.moveEnd("character",d);e.moveStart("character",b);return e};var Ld=f.contains=function(a,b){3==b.nodeType&&(b=b.parentNode);if(a.contains)return a.contains(b);do if(11==b.nodeType&&(b=b.host),b==a)return!0;while(b=b.parentNode)};R&&11>Z&&(cb=function(){try{return document.activeElement}catch(a){return document.body}});
var tc=f.rmClass=function(a,b){var d=a.className,e=Yc(b).exec(d);if(e){var g=d.slice(e.index+e[0].length);a.className=d.slice(0,e.index)+(g?e[1]+g:"")}},vc=f.addClass=function(a,b){var d=a.className;Yc(b).test(d)||(a.className+=(d?" ":"")+b)},ke=!1,Kf=function(){if(R&&9>Z)return!1;var a=K("div");return"draggable"in a||"dragDrop"in a}(),ie,fe,og=f.splitLines=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,d=[],e=a.length;b<=e;){var g=a.indexOf("\n",b);-1==g&&(g=a.length);var h=a.slice(b,"\r"==
a.charAt(g-1)?g-1:g),m=h.indexOf("\r");-1!=m?(d.push(h.slice(0,m)),b+=m+1):(d.push(h),b=g+1)}return d}:function(a){return a.split(/\r\n?|\n/)},mg=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(b){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(d){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1},Je=function(){var a=K("div");if("oncopy"in a)return!0;a.setAttribute("oncopy","return;");return"function"==typeof a.oncopy}(),
Pd=null,Rb=f.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",
63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var a=0;10>a;a++)Rb[a+48]=Rb[a+96]=String(a);for(a=65;90>=a;a++)Rb[a]=String.fromCharCode(a);for(a=1;12>=a;a++)Rb[a+111]=Rb[a+63235]="F"+a})();var Pc,fg=function(){function a(a){return 247>=a?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(a):
1424<=a&&1524>=a?"R":1536<=a&&1773>=a?"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm".charAt(a-1536):1774<=a&&2220>=a?"r":8192<=a&&8203>=a?"w":8204==a?"b":"L"}function b(a,c,d){this.level=a;this.from=c;this.to=d}var d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,e=/[stwN]/,g=/[LRr]/,h=/[Lb1n]/,m=/[1n]/;return function(f){if(!d.test(f))return!1;
for(var l=f.length,A=[],q=0,t;q<l;++q)A.push(a(f.charCodeAt(q)));for(var q=0,E="L";q<l;++q)t=A[q],"m"==t?A[q]=E:E=t;q=0;for(E="L";q<l;++q)t=A[q],"1"==t&&"r"==E?A[q]="n":g.test(t)&&(E=t,"r"==t&&(A[q]="R"));q=1;for(E=A[0];q<l-1;++q)t=A[q],"+"==t&&"1"==E&&"1"==A[q+1]?A[q]="1":","!=t||E!=A[q+1]||"1"!=E&&"n"!=E||(A[q]=E),E=t;for(q=0;q<l;++q)if(t=A[q],","==t)A[q]="N";else if("%"==t){for(E=q+1;E<l&&"%"==A[E];++E);var n=q&&"!"==A[q-1]||E<l&&"1"==A[E]?"1":"N";for(t=q;t<E;++t)A[t]=n;q=E-1}q=0;for(E="L";q<l;++q)t=
A[q],"L"==E&&"1"==t?A[q]="L":g.test(t)&&(E=t);for(q=0;q<l;++q)if(e.test(A[q])){for(E=q+1;E<l&&e.test(A[E]);++E);t="L"==(E<l?A[E]:"L");n="L"==(q?A[q-1]:"L")||t?"L":"R";for(t=q;t<E;++t)A[t]=n;q=E-1}for(var E=[],u,q=0;q<l;)if(h.test(A[q])){t=q;for(++q;q<l&&h.test(A[q]);++q);E.push(new b(0,t,q))}else{var r=q,n=E.length;for(++q;q<l&&"L"!=A[q];++q);for(t=r;t<q;)if(m.test(A[t])){r<t&&E.splice(n,0,new b(1,r,t));r=t;for(++t;t<q&&m.test(A[t]);++t);E.splice(n,0,new b(2,r,t));r=t}else++t;r<q&&E.splice(n,0,new b(1,
r,q))}1==E[0].level&&(u=f.match(/^\s+/))&&(E[0].from=u[0].length,E.unshift(new b(0,0,u[0].length)));1==U(E).level&&(u=f.match(/\s+$/))&&(U(E).to-=u[0].length,E.push(new b(0,l-u[0].length,l)));2==E[0].level&&E.unshift(new b(1,E[0].to,E[0].to));E[0].level!=U(E).level&&E.push(new b(E[0].level,l,l));return E}}();f.version="5.8.0";return f});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],f):f(CodeMirror)})(function(f){f.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",
file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:"cpp c++ cc cxx hpp h++ hh hxx".split(" "),alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj"]},{name:"Closure Stylesheets (GSS)",
mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx",
"pxd","pxi"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",
ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",
mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",
file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy"]},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",
mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Jade",mime:"text/x-jade",mode:"jade",ext:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],
mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",
mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps"},
{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mime:"text/n-triples",mode:"ntriples",ext:["nt"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",
ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:["php","php3","php4","php5","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:"txt text conf def list log".split(" ")},{name:"PLSQL",
mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["py","pyw"]},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",
mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},
{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},
{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"MariaDB",mime:"text/x-mariadb",mode:"sql"},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",
mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"troff",mode:"troff",
ext:"123456789".split("")},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",
mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"YAML",mime:"text/x-yaml",mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",
mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var G=0;G<f.modeInfo.length;G++){var I=f.modeInfo[G];I.mimes&&(I.mime=I.mimes[0])}f.findModeByMIME=function(l){l=l.toLowerCase();for(var s=0;s<f.modeInfo.length;s++){var n=f.modeInfo[s];if(n.mime==l)return n;if(n.mimes)for(var y=0;y<n.mimes.length;y++)if(n.mimes[y]==l)return n}};f.findModeByExtension=function(l){for(var s=
0;s<f.modeInfo.length;s++){var n=f.modeInfo[s];if(n.ext)for(var y=0;y<n.ext.length;y++)if(n.ext[y]==l)return n}};f.findModeByFileName=function(l){for(var s=0;s<f.modeInfo.length;s++){var n=f.modeInfo[s];if(n.file&&n.file.test(l))return n}s=l.lastIndexOf(".");if(l=-1<s&&l.substring(s+1,l.length))return f.findModeByExtension(l)};f.findModeByName=function(l){l=l.toLowerCase();for(var s=0;s<f.modeInfo.length;s++){var n=f.modeInfo[s];if(n.name.toLowerCase()==l)return n;if(n.alias)for(var y=0;y<n.alias.length;y++)if(n.alias[y].toLowerCase()==
l)return n}}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],f):f(CodeMirror)})(function(f){var G=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",
type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},
{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"xi",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"dcc",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",
toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,
bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",
motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",
type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",
motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",
type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},
{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",
action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",
type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",
type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},
context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},
{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},
{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",
type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",
isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",
isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",
operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",
type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",
isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",
searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],I=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",
shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],l=f.Pos;f.Vim=function(){function s(b,d){this==f.keyMap.vim&&f.rmClass(b.getWrapperElement(),"cm-fat-cursor");
d&&d.attach==n||(b.setOption("disableInput",!1),b.off("cursorActivity",gd),f.off(b.getInputField(),"paste",H(b)),b.state.vim=null)}function n(b,d){this==f.keyMap.vim&&f.addClass(b.getWrapperElement(),"cm-fat-cursor");d&&d.attach==n||(b.setOption("disableInput",!0),b.setOption("showCursorWhenSelecting",!1),f.signal(b,"vim-mode-change",{mode:"normal"}),b.on("cursorActivity",gd),u(b),f.on(b.getInputField(),"paste",H(b)))}function y(b,d){if(d){var e=B(b);if(!e)return!1;var g=f.Vim.findKey(d,e);"function"==
typeof g&&f.signal(d,"vim-keypress",e);return g}}function B(b){if("'"==b.charAt(0))return b.charAt(1);var d=b.split("-");/-$/.test(b)&&d.splice(-2,2,"-");b=d[d.length-1];if(1==d.length&&1==d[0].length||2==d.length&&"Shift"==d[0]&&1==b.length)return!1;for(var e=!1,g=0;g<d.length;g++){var m=d[g];m in Hc?d[g]=Hc[m]:e=!0;m in Ib&&(d[g]=Ib[m])}if(!e)return!1;x(b)&&(d[d.length-1]=b.toLowerCase());return"<"+d.join("-")+">"}function H(b){var d=b.state.vim;d.onPasteFn||(d.onPasteFn=function(){d.insertMode||
(b.setCursor($(b.getCursor(),0,1)),mb.enterInsertMode(b,{},d))});return d.onPasteFn}function w(b,d){for(var e=[],g=b;g<b+d;g++)e.push(String.fromCharCode(g));return e}function r(b,d){return d>=b.firstLine()&&d<=b.lastLine()}function x(b){return/^[A-Z]$/.test(b)}function T(b,d){for(var e=0;e<d.length;e++)if(d[e]==b)return!0;return!1}function v(b,d,e,g,m){if(void 0===d&&!m)throw Error("defaultValue is required unless callback is provided");e||(e="string");Ba[b]={type:e,defaultValue:d,callback:m};if(g)for(e=
0;e<g.length;e++)Ba[g[e]]=Ba[b];d&&D(b,d)}function D(b,d,e,g){var m=Ba[b];g=g||{};g=g.scope;if(!m)throw Error("Unknown option: "+b);if("boolean"==m.type){if(d&&!0!==d)throw Error("Invalid argument: "+b+"="+d);!1!==d&&(d=!0)}m.callback?("local"!==g&&m.callback(d,void 0),"global"!==g&&e&&m.callback(d,e)):("local"!==g&&(m.value="boolean"==m.type?!!d:d),"global"!==g&&e&&(e.state.vim.options[b]={value:d}))}function aa(b,d,e){var g=Ba[b];e=e||{};e=e.scope;if(!g)throw Error("Unknown option: "+b);if(g.callback){b=
d&&g.callback(void 0,d);if("global"!==e&&void 0!==b)return b;if("local"!==e)return g.callback()}else return b="global"!==e&&d&&d.state.vim.options[b],(b||"local"!==e&&g||{}).value}function C(){this.latestRegister=void 0;this.isRecording=this.isPlaying=!1;this.replaySearchQueries=[];this.onRecordingDone=void 0;this.lastInsertModeChanges=Jc()}function u(b){b.state.vim||(b.state.vim={inputState:new Ha,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},
fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}});return b.state.vim}function S(){J={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:sc(),macroModeState:new C,lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new ga({}),searchHistoryController:new va({}),exCommandHistoryController:new va({})};for(var b in Ba){var d=Ba[b];d.value=
d.defaultValue}}function Ha(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function ja(b,d){b.state.vim.inputState=new Ha;f.signal(b,"vim-command-done",d)}function fa(b,d,e){this.clear();this.keyBuffer=[b||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!d;this.blockwise=!!e}function ga(b){this.registers=b;this.unnamedRegister=b['"']=new fa;b["."]=new fa;b[":"]=new fa;b["/"]=new fa}
function va(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}function Ia(b,d){for(var e=[],g=0;g<d;g++)e.push(b);return e}function Q(b,d,e){var g=Math.min(Math.max(b.firstLine(),d.line),b.lastLine());b=ha(b,g)-1;b=e?b+1:b;d=Math.min(Math.max(0,d.ch),b);return l(g,d)}function la(b){var d={},e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);return d}function $(b,d,e){"object"===typeof d&&(e=d.ch,d=d.line);return l(b.line+d,b.ch+e)}function qa(b,d){return{line:d.line-b.line,ch:d.line-b.line}}
function ka(b,d,e){return function(){for(var g=0;g<e;g++)d(b)}}function W(b){return l(b.line,b.ch)}function ta(b,d){return b.ch==d.ch&&b.line==d.line}function ba(b,d){return b.line<d.line||b.line==d.line&&b.ch<d.ch?!0:!1}function ra(b,d){2<arguments.length&&(d=ra.apply(void 0,Array.prototype.slice.call(arguments,1)));return ba(b,d)?b:d}function t(b,d){2<arguments.length&&(d=t.apply(void 0,Array.prototype.slice.call(arguments,1)));return ba(b,d)?d:b}function ca(b,d,e){b=ba(b,d);d=ba(d,e);return b&&
d}function ha(b,d){return b.getLine(d).length}function Ub(b){return b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")}function Kd(b,d,e){var g=ha(b,d);e=Array(e-g+1).join(" ");b.setCursor(l(d,g));b.replaceRange(e,b.getCursor())}function wc(b,d){var e=[],g=b.listSelections(),m=W(b.clipPos(d)),h=!ta(d,m),f;a:{var t=b.getCursor("head");for(f=0;f<g.length;f++){var q=ta(g[f].anchor,t),n=ta(g[f].head,t);if(q||n)break a}f=-1}var t=ta(g[f].head,g[f].anchor),q=g.length-1,u=q-f>f?q:0;f=g[u].anchor;var r=Math.min(f.line,
m.line),q=Math.max(f.line,m.line),n=f.ch,m=m.ch,g=g[u].head.ch-n,u=m-n;0<g&&0>=u?(n++,h||m--):0>g&&0<=u?(n--,t||m++):0>g&&-1==u&&(n--,m++);for(h=r;h<=q;h++)g={anchor:new l(h,n),head:new l(h,m)},e.push(g);b.setSelections(e);d.ch=m;f.ch=n;return f}function xc(b,d,e){for(var g=[],m=0;m<e;m++){var h=$(d,m,0);g.push({anchor:h,head:h})}b.setSelections(g,0)}function yc(b,d){var e=d.lastSelection,g=function(){var d=b.getCursor(),g=b.getCursor(),f=e.visualBlock;if(f){for(var g=l(d.line+f.height,d.ch+f.width),
f=[],t=d.line;t<g.line;t++){var q=l(t,d.ch),n=l(t,g.ch);f.push({anchor:q,head:n})}b.setSelections(f)}else t=e.anchorMark.find(),q=e.headMark.find(),f=q.line-t.line,t=q.ch-t.ch,g={line:g.line+f,ch:f?g.ch:t+g.ch},e.visualLine&&(d=l(d.line,0),g=l(g.line,ha(b,g.line))),b.setSelection(d,g);return[d,g]};return d.visualMode?function(){var d=b.listSelections(),e=d[0],d=d[d.length-1],e=ba(e.anchor,e.head)?e.anchor:e.head,d=ba(d.anchor,d.head)?d.head:d.anchor;return[e,d]}():g()}function Cb(b,d){var e=d.sel.anchor,
g=d.sel.head;d.lastPastedText&&(g=b.posFromIndex(b.indexFromPos(e)+d.lastPastedText.length),d.lastPastedText=null);d.lastSelection={anchorMark:b.setBookmark(e),headMark:b.setBookmark(g),anchor:W(e),head:W(g),visualMode:d.visualMode,visualLine:d.visualLine,visualBlock:d.visualBlock}}function db(b,d,e){var g=b.state.vim;d=d||g.sel;e=e||g.visualLine?"line":g.visualBlock?"block":"char";d=Vb(b,d,e);b.setSelections(d.ranges,d.primary);Fc(b)}function Vb(b,d,e,g){var m=W(d.head),h=W(d.anchor);if("char"==
e)return m=g||ba(d.head,d.anchor)?0:1,h=ba(d.head,d.anchor)?1:0,m=$(d.head,0,m),h=$(d.anchor,0,h),{ranges:[{anchor:h,head:m}],primary:0};if("line"==e)return ba(d.head,d.anchor)?(m.ch=0,h.ch=ha(b,h.line)):(h.ch=0,d=b.lastLine(),m.line>d&&(m.line=d),m.ch=ha(b,m.line)),{ranges:[{anchor:h,head:m}],primary:0};if("block"==e){d=Math.min(h.line,m.line);b=Math.min(h.ch,m.ch);e=Math.max(h.line,m.line);h=Math.max(h.ch,m.ch)+1;e=e-d+1;m=m.line==d?0:e-1;g=[];for(var f=0;f<e;f++)g.push({anchor:l(d+f,b),head:l(d+
f,h)});return{ranges:g,primary:m}}}function ma(b,d){var e=b.state.vim;!1!==d&&b.setCursor(Q(b,e.sel.head));Cb(b,e);e.visualMode=!1;e.visualLine=!1;e.visualBlock=!1;f.signal(b,"vim-mode-change",{mode:"normal"});e.fakeCursor&&e.fakeCursor.clear()}function Aa(b){if(!b)return 0;var d=b.search(/\S/);return-1==d?b.length:d}function Db(b,d,e,g,m){e=b.getCursor("head");1==b.getSelection().length&&(e=ra(e,b.getCursor("anchor")));b=b.getLine(e.line);var h=e.ch;for(m=m?Jb[0]:dc[0];!m(b.charAt(h));)if(h++,h>=
b.length)return null;g?m=dc[0]:(m=Jb[0],m(b.charAt(h))||(m=Jb[1]));for(g=h;m(b.charAt(g))&&g<b.length;)g++;for(;m(b.charAt(h))&&0<=h;)h--;h++;if(d){for(d=g;/\s/.test(b.charAt(g))&&g<b.length;)g++;if(d==g){for(d=h;/\s/.test(b.charAt(h-1))&&0<h;)h--;h||(h=d)}}return{start:l(e.line,h),end:l(e.line,g)}}function zc(b,d){J.lastChararacterSearch.increment=b;J.lastChararacterSearch.forward=d.forward;J.lastChararacterSearch.selectedCharacter=d.selectedCharacter}function Yb(b,d,e,g){for(var m=b.getCursor(),
h=m.ch,f,t=0;t<d;t++){f=b.getLine(m.line);var q=g,n=void 0;f=n=e?f.indexOf(q,h+1):f.lastIndexOf(q,h-1);if(-1==f)return null;h=f}return l(b.getCursor().line,f)}function Pa(b,d,e,g){T(e,Md)&&(d.marks[e]&&d.marks[e].clear(),d.marks[e]=b.setBookmark(g))}function Zb(b,d,e,g,m){function h(d,e,g){return g?!b.getLine(d)!=!b.getLine(d+e):!!b.getLine(d)&&!b.getLine(d+e)}d=d.line;var f=b.firstLine(),t=b.lastLine(),q=d;if(g){for(;f<=q&&q<=t&&0<e;)h(q,g)&&e--,q+=g;return new l(q,0)}q=b.state.vim;q.visualLine&&
h(d,1,!0)&&(q=q.sel.anchor,h(q.line,-1,!0)&&(m&&q.line==d||(d+=1)));g=!b.getLine(d);for(q=d;q<=t&&e;q++)h(q,1,!0)&&(m&&!b.getLine(q)==g||e--);e=new l(q,0);q>t&&!g?g=!0:m=!1;for(q=d;q>f&&(m&&!b.getLine(q)!=g&&q!=d||!h(q,-1,!0));q--);return{start:new l(q,0),end:e}}function Bc(){}function Ja(b){b=b.state.vim;return b.searchState_||(b.searchState_=new Bc)}function Cc(b){var d=ib(b)||[];if(!d.length)return[];var e=[];if(0===d[0]){for(var g=0;g<d.length;g++)"number"==typeof d[g]&&e.push(b.substring(d[g]+
1,d[g+1]));return e}}function ib(b){for(var d=!1,e=[],g=0;g<b.length;g++){var m=b.charAt(g);d||"/"!=m||e.push(g);d=!d&&"\\"==m}return e}function X(b,d){b.openNotification?b.openNotification('<span style="color: red">'+d+"</span>",{bottom:!0,duration:5E3}):alert(d)}function bc(b,d){var e=(d.prefix||"")+" "+(d.desc||""),g;g=d.prefix;var m=d.desc,h="";g&&(h+='<span style="font-family: monospace">'+g+"</span>");h+='<input type="text"/> <span style="color: #888">';m&&(h=h+'<span style="color: #888">'+
m,h+="</span>");g=h;m=d.onClose;b.openDialog?b.openDialog(g,m,{bottom:!0,value:d.value,onKeyDown:d.onKeyDown,onKeyUp:d.onKeyUp,selectValueOnOpen:!1}):m(prompt(e,""))}function Eb(b,d,e,g){if(d){var m=Ja(b),h;e=!!e;g=!!g;J.registerController.getRegister("/").setText(d);if(d instanceof RegExp)h=d;else{var f=ib(d),l;f.length?(l=d.substring(0,f[0]),h=-1!=d.substring(f[0]).indexOf("i")):l=d;if(l){if(!aa("pcre")){d=l;f=!1;l=[];for(var q=-1;q<d.length;q++){var t=d.charAt(q)||"",n=d.charAt(q+1)||"",u=n&&-1!=
"|(){".indexOf(n);f?("\\"===t&&u||l.push(t),f=!1):"\\"===t?(f=!0,n&&-1!="}".indexOf(n)&&(u=!0),u&&"\\"!==n||l.push(t)):(l.push(t),u&&"\\"!==n&&l.push("\\"))}l=l.join("")}g&&(e=/^[^A-Z]*$/.test(l));h=new RegExp(l,e||h?"i":void 0)}else h=null}if(h){V(b,h);a:if(b=m.getQuery(),h instanceof RegExp&&b instanceof RegExp){e=["global","multiline","ignoreCase","source"];for(g=0;g<e.length;g++)if(d=e[g],h[d]!==b[d]){b=!1;break a}b=!0}else b=!1;if(b)return h;m.setQuery(h);return h}}}function Ya(b){if("^"==b.source.charAt(0))var d=
!0;return{token:function(e){if(d&&!e.sol())e.skipToEnd();else{var g=e.match(b,!1);if(g){if(0==g[0].length)return e.next(),"searching";if(!e.sol()&&(e.backUp(1),!b.exec(e.next()+g[0])))return e.next(),null;e.match(b);return"searching"}for(;!e.eol()&&(e.next(),!e.match(b,!1)););}},query:b}}function V(b,d){var e=Ja(b),g=e.getOverlay();g&&d==g.query||(g&&b.removeOverlay(g),g=Ya(d),b.addOverlay(g),b.showMatchesOnScrollbar&&(e.getScrollbarAnnotate()&&e.getScrollbarAnnotate().clear(),e.setScrollbarAnnotate(b.showMatchesOnScrollbar(d))),
e.setOverlay(g))}function Fa(b,d,e,g){void 0===g&&(g=1);return b.operation(function(){for(var m=b.getCursor(),h=b.getSearchCursor(e,m),f=0;f<g;f++){var t=h.find(d);0==f&&t&&ta(h.from(),m)&&(t=h.find(d));if(!t&&(h=b.getSearchCursor(e,d?l(b.lastLine()):l(b.firstLine(),0)),!h.find(d)))return}return h.from()})}function Ga(b){var d=Ja(b);b.removeOverlay(Ja(b).getOverlay());d.setOverlay(null);d.getScrollbarAnnotate()&&(d.getScrollbarAnnotate().clear(),d.setScrollbarAnnotate(null))}function N(b,d,e){"number"!=
typeof b&&(b=b.line);return d instanceof Array?T(b,d):e?b>=d&&b<=e:b==d}function jb(b){var d=b.getScrollInfo(),e=b.coordsChar({left:0,top:6+d.top},"local");b=b.coordsChar({left:0,top:d.clientHeight-10+d.top},"local");return{top:e.line,bottom:b.line}}function Gb(b,d,e,g,m,h,l,t,q){function n(){b.operation(function(){for(;!w;)u(),r();v()})}function u(){var d=b.getRange(h.from(),h.to()).replace(l,t);h.replace(d)}function r(){for(;h.findNext()&&N(h.from(),g,m);)if(e||!x||h.from().line!=x.line){b.scrollIntoView(h.from(),
30);b.setSelection(h.from(),h.to());x=h.from();w=!1;return}w=!0}function v(d){d&&d();b.focus();x&&(b.setCursor(x),d=b.state.vim,d.exMode=!1,d.lastHPos=d.lastHSPos=x.ch);q&&q()}function s(d,e,g){f.e_stop(d);switch(f.keyName(d)){case "Y":u();r();break;case "N":r();break;case "A":d=q;q=void 0;b.operation(n);q=d;break;case "L":u();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":v(g)}w&&v(g);return!0}b.state.vim.exMode=!0;var w=!1,x=h.from();r();w?X(b,"No matches for "+l.source):d?bc(b,{prefix:"replace with <strong>"+
t+"</strong> (y/n/a/q/l)",onKeyDown:s}):(n(),q&&q())}function eb(b){var d=b.state.vim,e=J.macroModeState,g=J.registerController.getRegister("."),m=e.isPlaying,h=e.lastInsertModeChanges,l=[];if(!m){for(var t=h.inVisualBlock?d.lastSelection.visualBlock.height:1,q=h.changes,l=[],n=0;n<q.length;)l.push(q[n]),q[n]instanceof ea?n++:n+=t;h.changes=l;b.off("change",cc);f.off(b.getInputField(),"keydown",Hb)}!m&&1<d.insertModeRepeat&&(Gc(b,d,d.insertModeRepeat-1,!0),d.lastEditInputState.repeatOverride=d.insertModeRepeat);
delete d.insertModeRepeat;d.insertMode=!1;b.setCursor(b.getCursor().line,b.getCursor().ch-1);b.setOption("keyMap","vim");b.setOption("disableInput",!0);b.toggleOverwrite(!1);g.setText(h.changes.join(""));f.signal(b,"vim-mode-change",{mode:"normal"});e.isRecording&&(e.isPlaying||(b=J.registerController.getRegister(e.latestRegister))&&b.pushInsertModeChanges&&b.pushInsertModeChanges(e.lastInsertModeChanges))}function Ec(b){G.unshift(b)}function cc(b,d){var e=J.macroModeState,g=e.lastInsertModeChanges;
if(!e.isPlaying)for(;d;){g.expectCursorActivityForChange=!0;if("+input"==d.origin||"paste"==d.origin||void 0===d.origin)e=d.text.join("\n"),g.changes.push(e);d=d.next}}function gd(b){var d=b.state.vim;if(d.insertMode){var e=J.macroModeState;if(e.isPlaying)return;e=e.lastInsertModeChanges;e.expectCursorActivityForChange?e.expectCursorActivityForChange=!1:e.changes=[]}else if(!b.curOp.isVimOp){var e=b.getCursor("anchor"),g=b.getCursor("head");d.visualMode&&!b.somethingSelected()?ma(b,!1):d.visualMode||
d.insertMode||!b.somethingSelected()||(d.visualMode=!0,d.visualLine=!1,f.signal(b,"vim-mode-change",{mode:"visual"}));if(d.visualMode){var m=ba(g,e)?0:-1,h=ba(g,e)?-1:0,g=$(g,0,m),e=$(e,0,h);d.sel={anchor:e,head:g};Pa(b,d,"<",ra(g,e));Pa(b,d,">",t(g,e))}else d.insertMode||(d.lastHPos=b.getCursor().ch)}d.visualMode&&Fc(b)}function Fc(b){var d=b.state.vim,e=Q(b,W(d.sel.head)),g=$(e,0,1);d.fakeCursor&&d.fakeCursor.clear();d.fakeCursor=b.markText(e,g,{className:"cm-animate-fat-cursor"})}function ea(b){this.keyName=
b}function Hb(b){function d(){e.changes.push(new ea(g));return!0}var e=J.macroModeState.lastInsertModeChanges,g=f.keyName(b);g&&(-1==g.indexOf("Delete")&&-1==g.indexOf("Backspace")||f.lookupKey(g,"vim-insert",d))}function Gc(b,d,e,g){function m(){l?Na.processAction(b,d,d.lastEditActionCommand):Na.evalInput(b,d)}function h(e){0<f.lastInsertModeChanges.changes.length&&(e=d.lastEditActionCommand?e:1,Ic(b,f.lastInsertModeChanges.changes,e))}var f=J.macroModeState;f.isPlaying=!0;var l=!!d.lastEditActionCommand,
q=d.inputState;d.inputState=d.lastEditInputState;if(l&&d.lastEditActionCommand.interlaceInsertRepeat)for(var t=0;t<e;t++)m(),h(1);else g||m(),h(e);d.inputState=q;d.insertMode&&!g&&eb(b);f.isPlaying=!1}function Ic(b,d,e){function g(d){if("string"==typeof d)f.commands[d](b);else d(b);return!0}var m=b.getCursor("head"),h=J.macroModeState.lastInsertModeChanges.inVisualBlock;h&&(e=b.state.vim.lastSelection,e=qa(e.anchor,e.head),xc(b,m,e.line+1),e=b.listSelections().length,b.setCursor(m));for(var l=0;l<
e;l++){h&&b.setCursor($(m,l,0));for(var t=0;t<d.length;t++){var q=d[t];if(q instanceof ea)f.lookupKey(q.keyName,"vim-insert",g);else{var n=b.getCursor();b.replaceRange(q,n,n)}}}h&&b.setCursor($(m,0,1))}f.defineOption("vimMode",!1,function(b,d,e){d&&"vim"!=b.getOption("keyMap")?b.setOption("keyMap","vim"):!d&&e!=f.Init&&/^vim/.test(b.getOption("keyMap"))&&b.setOption("keyMap","default")});var Hc={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},Ib={Enter:"CR",Backspace:"BS",Delete:"Del"},Bb=/[\d]/,Jb=[f.isWordChar,
function(b){return b&&!f.isWordChar(b)&&!/\s/.test(b)}],dc=[function(b){return/\S/.test(b)}],ec=w(65,26),kb=w(97,26),ob=w(48,10),Md=[].concat(ec,kb,ob,["<",">"]),id=[].concat(ec,kb,ob,["-",'"',".",":","/"]),Ba={};v("filetype",void 0,"string",["ft"],function(b,d){if(void 0!==d){if(void 0===b){var e=d.getOption("mode");return"null"==e?"":e}d.setOption("mode",""==b?"null":b)}});var sc=function(){var b=-1,d=0,e=0,g=Array(100);return{cachedCursor:void 0,add:function(m,h,f){function l(d){var e=++b%100,
h=g[e];h&&h.clear();g[e]=m.setBookmark(d)}var q=g[b%100];q?(q=q.find())&&!ta(q,h)&&l(h):l(h);l(f);d=b;e=b-100+1;0>e&&(e=0)},move:function(m,h){b+=h;b>d?b=d:b<e&&(b=e);var f=g[(100+b)%100];if(f&&!f.find()){var l=0<h?1:-1,q,t=m.getCursor();do if(b+=l,(f=g[(100+b)%100])&&(q=f.find())&&!ta(t,q))break;while(b<d&&b>e)}return f}}},Jc=function(b){return b?{changes:b.changes,expectCursorActivityForChange:b.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};C.prototype={exitMacroRecordMode:function(){var b=
J.macroModeState;if(b.onRecordingDone)b.onRecordingDone();b.onRecordingDone=void 0;b.isRecording=!1},enterMacroRecordMode:function(b,d){var e=J.registerController.getRegister(d);e&&(e.clear(),this.latestRegister=d,b.openDialog&&(this.onRecordingDone=b.openDialog("(recording)["+d+"]",null,{bottom:!0})),this.isRecording=!0)}};var J,Ea,ec={buildKeyMap:function(){},getRegisterController:function(){return J.registerController},resetVimGlobalState_:S,getVimGlobalState_:function(){return J},maybeInitVimState_:u,
suppressErrorLogging:!1,InsertModeKey:ea,map:function(b,d,e){Ra.map(b,d,e)},setOption:D,getOption:aa,defineOption:v,defineEx:function(b,d,e){if(!d)d=b;else if(0!==b.indexOf(d))throw Error('(Vim.defineEx) "'+d+'" is not a prefix of "'+b+'", command not registered');fc[b]=e;Ra.commandMap_[d]={name:b,shortName:d,type:"api"}},handleKey:function(b,d,e){b=this.findKey(b,d,e);if("function"===typeof b)return b()},findKey:function(b,d,e){function g(){if("<Esc>"==d)return ja(b),l.visualMode?ma(b):l.insertMode&&
eb(b),!0}function m(){if(g())return!0;for(var e=l.inputState.keyBuffer+=d,h=1==d.length,m=Na.matchCommand(e,G,l.inputState,"insert");1<e.length&&"full"!=m.type;){var e=l.inputState.keyBuffer=e.slice(1),f=Na.matchCommand(e,G,l.inputState,"insert");"none"!=f.type&&(m=f)}if("none"==m.type)return ja(b),!1;if("partial"==m.type)return Ea&&window.clearTimeout(Ea),Ea=window.setTimeout(function(){l.insertMode&&l.inputState.keyBuffer&&ja(b)},aa("insertModeEscKeysTimeout")),!h;Ea&&window.clearTimeout(Ea);h&&
(h=b.getCursor(),b.replaceRange("",$(h,0,-(e.length-1)),h,"+input"));ja(b);return m.command}function h(){var h;a:{var m=J.macroModeState;if(m.isRecording){if("q"==d){m.exitMacroRecordMode();ja(b);h=!0;break a}"mapping"!=e&&(h=d,m.isPlaying||(m=J.registerController.getRegister(m.latestRegister))&&m.pushText(h))}h=void 0}if(h||g())return!0;h=l.inputState.keyBuffer+=d;if(/^[1-9]\d*$/.test(h))return!0;m=/^(\d*)(.*)$/.exec(h);if(!m)return ja(b),!1;var f=Na.matchCommand(m[2]||m[1],G,l.inputState,l.visualMode?
"visual":"normal");if("none"==f.type)return ja(b),!1;if("partial"==f.type)return!0;l.inputState.keyBuffer="";m=/^(\d*)(.*)$/.exec(h);m[1]&&"0"!=m[1]&&l.inputState.pushRepeatDigit(m[1]);return f.command}var l=u(b),t;t=l.insertMode?m():h();return!1===t?void 0:!0===t?function(){}:function(){return b.operation(function(){b.curOp.isVimOp=!0;try{if("keyToKey"==t.type)for(var e=t.toKeys,g;e;)g=/<\w+-.+?>|<\w+>|./.exec(e),d=g[0],e=e.substring(g.index+d.length),f.Vim.handleKey(b,d,"mapping");else Na.processCommand(b,
l,t)}catch(h){throw b.state.vim=void 0,u(b),f.Vim.suppressErrorLogging||console.log(h),h;}return!0})}},handleEx:function(b,d){Ra.processCommand(b,d)},defineMotion:function(b,d){Wa[b]=d},defineAction:function(b,d){mb[b]=d},defineOperator:function(b,d){ac[b]=d},mapCommand:function(b,d,e,g,m){b={keys:b,type:d};b[d]=e;b[d+"Args"]=g;for(var h in m)b[h]=m[h];Ec(b)},_mapCommand:Ec,defineRegister:function(b,d){var e=J.registerController.registers[b];if(!b||1!=b.length)throw Error("Register name must be 1 character");
if(e[b])throw Error("Register already defined "+b);e[b]=d;id.push(b)},exitVisualMode:ma,exitInsertMode:eb};Ha.prototype.pushRepeatDigit=function(b){this.operator?this.motionRepeat=this.motionRepeat.concat(b):this.prefixRepeat=this.prefixRepeat.concat(b)};Ha.prototype.getRepeat=function(){var b=0;if(0<this.prefixRepeat.length||0<this.motionRepeat.length)b=1,0<this.prefixRepeat.length&&(b*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(b*=parseInt(this.motionRepeat.join(""),10));
return b};fa.prototype={setText:function(b,d,e){this.keyBuffer=[b||""];this.linewise=!!d;this.blockwise=!!e},pushText:function(b,d){d&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0);this.keyBuffer.push(b)},pushInsertModeChanges:function(b){this.insertModeChanges.push(Jc(b))},pushSearchQuery:function(b){this.searchQueries.push(b)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!1},toString:function(){return this.keyBuffer.join("")}};ga.prototype=
{pushText:function(b,d,e,g,m){g&&"\n"==e.charAt(0)&&(e=e.slice(1)+"\n");g&&"\n"!==e.charAt(e.length-1)&&(e+="\n");var h=this.isValidRegister(b)?this.getRegister(b):null;if(h)x(b)?h.pushText(e,g):h.setText(e,g,m),this.unnamedRegister.setText(h.toString(),g);else{switch(d){case "yank":this.registers["0"]=new fa(e,g,m);break;case "delete":case "change":-1==e.indexOf("\n")?this.registers["-"]=new fa(e,g):(this.shiftNumericRegisters_(),this.registers["1"]=new fa(e,g))}this.unnamedRegister.setText(e,g,
m)}},getRegister:function(b){if(!this.isValidRegister(b))return this.unnamedRegister;b=b.toLowerCase();this.registers[b]||(this.registers[b]=new fa);return this.registers[b]},isValidRegister:function(b){return b&&T(b,id)},shiftNumericRegisters_:function(){for(var b=9;2<=b;b--)this.registers[b]=this.getRegister(""+(b-1))}};va.prototype={nextMatch:function(b,d){var e=this.historyBuffer,g=d?-1:1;null===this.initialPrefix&&(this.initialPrefix=b);for(var m=this.iterator+g;d?0<=m:m<e.length;m+=g)for(var h=
e[m],f=0;f<=h.length;f++)if(this.initialPrefix==h.substring(0,f))return this.iterator=m,h;if(m>=e.length)return this.iterator=e.length,this.initialPrefix;if(0>m)return b},pushInput:function(b){var d=this.historyBuffer.indexOf(b);-1<d&&this.historyBuffer.splice(d,1);b.length&&this.historyBuffer.push(b)},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var Na={matchCommand:function(b,d,e,g){var m,h,f=[];m=[];for(var l=0;l<d.length;l++){var t=d[l],n;if(n=!("insert"==
g&&"insert"!=t.context||t.context&&t.context!=g||e.operator&&"action"==t.type)){h=b;var u=t.keys;if("<character>"==u.slice(-11)){n=u.length-11;var r=h.slice(0,n),u=u.slice(0,n);h=r==u&&h.length>n?"full":0==u.indexOf(r)?"partial":!1}else h=h==u?"full":0==u.indexOf(h)?"partial":!1;n=h}n&&("partial"==h&&f.push(t),"full"==h&&m.push(t))}d=f.length&&f;m=m.length&&m;if(!m&&!d)return{type:"none"};if(!m&&d)return{type:"partial"};var v;for(d=0;d<m.length;d++)g=m[d],v||(v=g);if("<character>"==v.keys.slice(-11)){b=
(m=/^.*(<[\w\-]+>)$/.exec(b))?m[1]:b.slice(-1);if(1<b.length)switch(b){case "<CR>":b="\n";break;case "<Space>":b=" "}e.selectedCharacter=b}return{type:"full",command:v}},processCommand:function(b,d,e){d.inputState.repeatOverride=e.repeatOverride;switch(e.type){case "motion":this.processMotion(b,d,e);break;case "operator":this.processOperator(b,d,e);break;case "operatorMotion":this.processOperatorMotion(b,d,e);break;case "action":this.processAction(b,d,e);break;case "search":this.processSearch(b,d,
e);break;case "ex":case "keyToEx":this.processEx(b,d,e)}},processMotion:function(b,d,e){d.inputState.motion=e.motion;d.inputState.motionArgs=la(e.motionArgs);this.evalInput(b,d)},processOperator:function(b,d,e){var g=d.inputState;if(g.operator){if(g.operator==e.operator){g.motion="expandToLine";g.motionArgs={linewise:!0};this.evalInput(b,d);return}ja(b)}g.operator=e.operator;g.operatorArgs=la(e.operatorArgs);d.visualMode&&this.evalInput(b,d)},processOperatorMotion:function(b,d,e){var g=d.visualMode,
m=la(e.operatorMotionArgs);m&&g&&m.visualLine&&(d.visualLine=!0);this.processOperator(b,d,e);g||this.processMotion(b,d,e)},processAction:function(b,d,e){var g=d.inputState,m=g.getRepeat(),h=!!m,f=la(e.actionArgs)||{};g.selectedCharacter&&(f.selectedCharacter=g.selectedCharacter);e.operator&&this.processOperator(b,d,e);e.motion&&this.processMotion(b,d,e);(e.motion||e.operator)&&this.evalInput(b,d);f.repeat=m||1;f.repeatIsExplicit=h;f.registerName=g.registerName;ja(b);d.lastMotion=null;e.isEdit&&this.recordLastEdit(d,
g,e);mb[e.action](b,f,d)},processSearch:function(b,d,e){function g(g,h,m){J.searchHistoryController.pushInput(g);J.searchHistoryController.reset();try{Eb(b,g,h,m)}catch(f){X(b,"Invalid regex: "+g);ja(b);return}Na.processMotion(b,d,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:e.searchArgs.toJumplist}})}function m(d){b.scrollTo(r.left,r.top);g(d,!0,!0);var e=J.macroModeState;e.isRecording&&(e.isPlaying||(e=J.registerController.getRegister(e.latestRegister))&&e.pushSearchQuery&&
e.pushSearchQuery(d))}function h(d,e,g){d=f.keyName(d);"Up"==d||"Down"==d?(e=J.searchHistoryController.nextMatch(e,"Up"==d?!0:!1)||"",g(e)):"Left"!=d&&"Right"!=d&&"Ctrl"!=d&&"Alt"!=d&&"Shift"!=d&&J.searchHistoryController.reset();var h;try{h=Eb(b,e,!0,!0)}catch(m){}h?b.scrollIntoView(Fa(b,!t,h),30):(Ga(b),b.scrollTo(r.left,r.top))}function l(d,e,g){var h=f.keyName(d);"Esc"==h||"Ctrl-C"==h||"Ctrl-["==h||"Backspace"==h&&""==e?(J.searchHistoryController.pushInput(e),J.searchHistoryController.reset(),
Eb(b,u),Ga(b),b.scrollTo(r.left,r.top),f.e_stop(d),ja(b),g(),b.focus()):"Ctrl-U"==h&&(f.e_stop(d),g(""))}if(b.getSearchCursor){var t=e.searchArgs.forward,q=e.searchArgs.wholeWordOnly;Ja(b).setReversed(!t);var n=t?"/":"?",u=Ja(b).getQuery(),r=b.getScrollInfo();switch(e.searchArgs.querySrc){case "prompt":q=J.macroModeState;q.isPlaying?(n=q.replaySearchQueries.shift(),g(n,!0,!1)):bc(b,{onClose:m,prefix:n,desc:wb,onKeyUp:h,onKeyDown:l});break;case "wordUnderCursor":var v=Db(b,!1,!0,!1,!0),s=!0;v||(v=
Db(b,!1,!0,!1,!1),s=!1);if(!v)break;n=b.getLine(v.start.line).substring(v.start.ch,v.end.ch);n=s&&q?"\\b"+n+"\\b":n.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1");J.jumpList.cachedCursor=b.getCursor();b.setCursor(v.start);g(n,!0,!1)}}},processEx:function(b,d,e){function g(d){J.exCommandHistoryController.pushInput(d);J.exCommandHistoryController.reset();Ra.processCommand(b,d)}function m(d,e,g){var m=f.keyName(d);if("Esc"==m||"Ctrl-C"==m||"Ctrl-["==m||"Backspace"==m&&""==e)J.exCommandHistoryController.pushInput(e),
J.exCommandHistoryController.reset(),f.e_stop(d),ja(b),g(),b.focus();"Up"==m||"Down"==m?(e=J.exCommandHistoryController.nextMatch(e,"Up"==m?!0:!1)||"",g(e)):"Ctrl-U"==m?(f.e_stop(d),g("")):"Left"!=m&&"Right"!=m&&"Ctrl"!=m&&"Alt"!=m&&"Shift"!=m&&J.exCommandHistoryController.reset()}"keyToEx"==e.type?Ra.processCommand(b,e.exArgs.input):d.visualMode?bc(b,{onClose:g,prefix:":",value:"'<,'>",onKeyDown:m}):bc(b,{onClose:g,prefix:":",onKeyDown:m})},evalInput:function(b,d){var e=d.inputState,g=e.motion,m=
e.motionArgs||{},h=e.operator,f=e.operatorArgs||{},n=e.registerName,q=d.sel,u=W(d.visualMode?Q(b,q.head):b.getCursor("head")),r=W(d.visualMode?Q(b,q.anchor):b.getCursor("anchor")),v=W(u),r=W(r),s,w,x;h&&this.recordLastEdit(d,e);x=void 0!==e.repeatOverride?e.repeatOverride:e.getRepeat();if(0<x&&m.explicitRepeat)m.repeatIsExplicit=!0;else if(m.noRepeat||!m.explicitRepeat&&0===x)x=1,m.repeatIsExplicit=!1;e.selectedCharacter&&(m.selectedCharacter=f.selectedCharacter=e.selectedCharacter);m.repeat=x;ja(b);
if(g){s=Wa[g](b,u,m,d);d.lastMotion=Wa[g];if(!s)return;m.toJumplist&&(g=J.jumpList,(e=g.cachedCursor)?(ta(e,s)||J.jumpList.add(b,e,s),delete g.cachedCursor):ta(u,s)||J.jumpList.add(b,u,s));s instanceof Array&&(w=s[0],s=s[1]);s||(s=W(u));d.visualMode?(d.visualBlock&&Infinity===s.ch||(s=Q(b,s,d.visualBlock)),w&&(w=Q(b,w,!0)),w=w||r,q.anchor=w,q.head=s,db(b),Pa(b,d,"<",ba(w,s)?w:s),Pa(b,d,">",ba(w,s)?s:w)):h||(s=Q(b,s),b.setCursor(s.line,s.ch))}if(h){f.lastSel?(w=r,q=f.lastSel,s=Math.abs(q.head.line-
q.anchor.line),u=Math.abs(q.head.ch-q.anchor.ch),s=q.visualLine?l(r.line+s,r.ch):q.visualBlock?l(r.line+s,r.ch+u):q.head.line==q.anchor.line?l(r.line,r.ch+u):l(r.line+s,r.ch),d.visualMode=!0,d.visualLine=q.visualLine,d.visualBlock=q.visualBlock,q=d.sel={anchor:w,head:s},db(b)):d.visualMode&&(f.lastSel={anchor:W(q.anchor),head:W(q.head),visualBlock:d.visualBlock,visualLine:d.visualLine});if(d.visualMode){if(w=ra(q.head,q.anchor),q=t(q.head,q.anchor),v=d.visualLine||f.linewise,m=d.visualBlock?"block":
v?"line":"char",w=Vb(b,{anchor:w,head:q},m),v)if(q=w.ranges,"block"==m)for(m=0;m<q.length;m++)q[m].head.ch=ha(b,q[m].head.line);else"line"==m&&(q[0].head=l(q[0].head.line+1,0))}else{w=W(w||r);q=W(s||v);ba(q,w)&&(v=w,w=q,q=v);if(v=m.linewise||f.linewise)u=q,w.ch=0,u.ch=0,u.line++;else if(m.forward&&(u=q,g=b.getRange(w,u),/\n\s*$/.test(g))){g=g.split("\n");g.pop();for(e=g.pop();0<g.length&&e&&/^\s*$/.test(e);e=g.pop())u.line--,u.ch=0;e?(u.line--,u.ch=ha(b,u.line)):u.ch=0}w=Vb(b,{anchor:w,head:q},"char",
!m.inclusive||v)}b.setSelections(w.ranges,w.primary);d.lastMotion=null;f.repeat=x;f.registerName=n;f.linewise=v;h=ac[h](b,f,w.ranges,r,s);d.visualMode&&ma(b,null!=h);h&&b.setCursor(h)}},recordLastEdit:function(b,d,e){var g=J.macroModeState;g.isPlaying||(b.lastEditInputState=d,b.lastEditActionCommand=e,g.lastInsertModeChanges.changes=[],g.lastInsertModeChanges.expectCursorActivityForChange=!1)}},Wa={moveToTopLine:function(b,d,e){d=jb(b).top+e.repeat-1;return l(d,Aa(b.getLine(d)))},moveToMiddleLine:function(b){var d=
jb(b),d=Math.floor(.5*(d.top+d.bottom));return l(d,Aa(b.getLine(d)))},moveToBottomLine:function(b,d,e){d=jb(b).bottom-e.repeat+1;return l(d,Aa(b.getLine(d)))},expandToLine:function(b,d,e){return l(d.line+e.repeat-1,Infinity)},findNext:function(b,d,e){d=Ja(b);var g=d.getQuery();if(g){var m=!e.forward,m=d.isReversed()?!m:m;V(b,g);return Fa(b,m,g,e.repeat)}},goToMark:function(b,d,e,g){return(d=g.marks[e.selectedCharacter])?(d=d.find(),e.linewise?{line:d.line,ch:Aa(b.getLine(d.line))}:d):null},moveToOtherHighlightedEnd:function(b,
d,e,g){return g.visualBlock&&e.sameLine?(d=g.sel,[Q(b,l(d.anchor.line,d.head.ch)),Q(b,l(d.head.line,d.anchor.ch))]):[g.sel.head,g.sel.anchor]},jumpToMark:function(b,d,e,g){for(var m=0;m<e.repeat;m++){var h=d,f;for(f in g.marks)if(/^[a-z]$/.test(f)){var t=g.marks[f].find();if(e.forward?!ba(t,h):!ba(h,t))if(!e.linewise||t.line!=h.line){var q=ta(h,d),n=e.forward?ca(h,t,d):ca(d,t,h);if(q||n)d=t}}}e.linewise&&(d=l(d.line,Aa(b.getLine(d.line))));return d},moveByCharacters:function(b,d,e){b=e.repeat;return l(d.line,
e.forward?d.ch+b:d.ch-b)},moveByLines:function(b,d,e,g){var m=d.ch;switch(g.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:m=g.lastHPos;break;default:g.lastHPos=m}var h=e.repeat+(e.repeatOffset||0),h=e.forward?d.line+h:d.line-h,f=b.firstLine(),t=b.lastLine();if(!(h<f&&d.line==f||h>t&&d.line==t))return e.toFirstChar&&(m=Aa(b.getLine(h)),g.lastHPos=m),g.lastHSPos=b.charCoords(l(h,m),"div").left,l(h,m)},moveByDisplayLines:function(b,
d,e,g){switch(g.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:g.lastHSPos=b.charCoords(d,"div").left}var m=e.repeat;d=b.findPosV(d,e.forward?m:-m,"line",g.lastHSPos);d.hitSide&&(e.forward?e={top:b.charCoords(d,"div").top+8,left:g.lastHSPos}:(e=b.charCoords(l(b.firstLine(),0),"div"),e.left=g.lastHSPos),d=b.coordsChar(e,"div"));g.lastHPos=d.ch;return d},moveByPage:function(b,d,e){var g=e.repeat;return b.findPosV(d,
e.forward?g:-g,"page")},moveByParagraph:function(b,d,e){return Zb(b,d,e.repeat,e.forward?1:-1)},moveByScroll:function(b,d,e,g){var m=b.getScrollInfo(),h=null;(h=e.repeat)||(h=m.clientHeight/(2*b.defaultTextHeight()));var f=b.charCoords(d,"local");e.repeat=h;h=Wa.moveByDisplayLines(b,d,e,g);if(!h)return null;d=b.charCoords(h,"local");b.scrollTo(null,m.top+d.top-f.top);return h},moveByWords:function(b,d,e){var g=d,m=e.repeat;d=!!e.forward;var h=!!e.wordEnd,f=!!e.bigWord;e=W(g);var t=[];(d&&!h||!d&&
h)&&m++;for(var q=!(d&&h),n=0;n<m;n++){var u;b:{u=b;var s=d,v=f,w=q,x=g.line,D=g.ch,C=u.getLine(x),B=s?1:-1,v=v?dc:Jb;if(w&&""==C){x+=B;C=u.getLine(x);if(!r(u,x)){u=null;break b}D=s?0:C.length}for(;;){if(w&&""==C){u={from:0,to:0,line:x};break b}for(var ca=s=0<B?C.length:-1,y=s;D!=s;){for(var aa=!1,S=0;S<v.length&&!aa;++S)if(v[S](C.charAt(D))){for(ca=D;D!=s&&v[S](C.charAt(D));)D+=B;y=D;aa=ca!=y;if(ca!=g.ch||x!=g.line||y!=ca+B){u={from:Math.min(ca,y+1),to:Math.max(ca,y),line:x};break b}}aa||(D+=B)}x+=
B;if(!r(u,x)){u=null;break b}C=u.getLine(x);D=0<B?0:C.length}throw Error("The impossible happened.");}if(!u){f=ha(b,b.lastLine());t.push(d?{line:b.lastLine(),from:f,to:f}:{line:0,from:0,to:0});break}t.push(u);g=l(u.line,d?u.to-1:u.from)}b=t.length!=m;m=t[0];f=t.pop();d&&!h?(b||m.from==e.ch&&m.line==e.line||(f=t.pop()),d=l(f.line,f.from)):d&&h?d=l(f.line,f.to-1):!d&&h?(b||m.to==e.ch&&m.line==e.line||(f=t.pop()),d=l(f.line,f.to)):d=l(f.line,f.from);return d},moveTillCharacter:function(b,d,e){b=Yb(b,
e.repeat,e.forward,e.selectedCharacter);d=e.forward?-1:1;zc(d,e);if(!b)return null;b.ch+=d;return b},moveToCharacter:function(b,d,e){var g=e.repeat;zc(0,e);return Yb(b,g,e.forward,e.selectedCharacter)||d},moveToSymbol:function(b,d,e){var g=e.repeat,f=e.forward,h=e.selectedCharacter;e=W(b.getCursor());var t=f?1:-1,n=f?b.lineCount():-1,q=e.ch,u=e.line,r=b.getLine(u),f={lineText:r,nextCh:r.charAt(q),lastCh:null,index:q,symb:h,reverseSymb:(f?{")":"(","}":"{"}:{"(":")","{":"}"})[h],forward:f,depth:0,curMoveThrough:!1};
if(q=Kc[h]){h=Dc[q].init;q=Dc[q].isComplete;for(h&&h(f);u!==n&&g;)f.index+=t,f.nextCh=f.lineText.charAt(f.index),f.nextCh||(u+=t,f.lineText=b.getLine(u)||"",0<t?f.index=0:(h=f.lineText.length,f.index=0<h?h-1:0),f.nextCh=f.lineText.charAt(f.index)),q(f)&&(e.line=u,e.ch=f.index,g--);b=f.nextCh||f.curMoveThrough?l(u,f.index):e}else b=e;return b||d},moveToColumn:function(b,d,e,g){e=e.repeat;g.lastHPos=e-1;g.lastHSPos=b.charCoords(d,"div").left;d=b.getCursor().line;return Q(b,l(d,e-1))},moveToEol:function(b,
d,e,g){g.lastHPos=Infinity;d=l(d.line+e.repeat-1,Infinity);e=b.clipPos(d);e.ch--;g.lastHSPos=b.charCoords(e,"div").left;return d},moveToFirstNonWhiteSpaceCharacter:function(b,d){return l(d.line,Aa(b.getLine(d.line)))},moveToMatchedSymbol:function(b,d){var e=d.line,g=d.ch,f=b.getLine(e),h;do if((h=f.charAt(g++))&&-1!="()[]{}".indexOf(h)){var t=b.getTokenTypeAt(l(e,g));if("string"!==t&&"comment"!==t)break}while(h);return h?b.findMatchingBracket(l(e,g)).to:d},moveToStartOfLine:function(b,d){return l(d.line,
0)},moveToLineOrEdgeOfDocument:function(b,d,e){d=e.forward?b.lastLine():b.firstLine();e.repeatIsExplicit&&(d=e.repeat-b.getOption("firstLineNumber"));return l(d,Aa(b.getLine(d)))},textObjectManipulation:function(b,d,e,g){var f={"'":!0,'"':!0},h=e.selectedCharacter;"b"==h?h="(":"B"==h&&(h="{");var n=!e.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"["}[h]){var u,q;q={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[h];u={"(":"(",")":"(","[":"[","]":"[","{":"{",
"}":"{"}[h];e=b.getLine(d.line).charAt(d.ch)===u?1:0;u=b.scanForBracket(l(d.line,d.ch+e),-1,null,{bracketRegex:q});q=b.scanForBracket(l(d.line,d.ch+e),1,null,{bracketRegex:q});if(u&&q){u=u.pos;q=q.pos;if(u.line==q.line&&u.ch>q.ch||u.line>q.line)d=u,u=q,q=d;n?q.ch+=1:u.ch+=1;d={start:u,end:q}}else d={start:d,end:d}}else if(f[h]){e=h;d=W(d);g=b.getLine(d.line).split("");h=g.indexOf(e);d.ch<h?d.ch=h:h<d.ch&&g[d.ch]==e&&(q=d.ch,--d.ch);if(g[d.ch]!=e||q)for(h=d.ch;-1<h&&!u;h--)g[h]==e&&(u=h+1);else u=
d.ch+1;if(u&&!q)for(h=u,f=g.length;h<f&&!q;h++)g[h]==e&&(q=h);u&&q?(n&&(--u,++q),d={start:l(d.line,u),end:l(d.line,q)}):d={start:d,end:d}}else if("W"===h)d=Db(b,n,!0,!0);else if("w"===h)d=Db(b,n,!0,!1);else if("p"===h)if(d=Zb(b,d,e.repeat,0,n),e.linewise=!0,g.visualMode)g.visualLine||(g.visualLine=!0);else{if(n=g.inputState.operatorArgs)n.linewise=!0;d.end.line--}else return null;return b.state.vim.visualMode?(n=d.start,d=d.end,q=b.state.vim.sel,u=q.head,q=q.anchor,ba(d,n)&&(e=d,d=n,n=e),ba(u,q)?
(u=ra(n,u),q=t(q,d)):(q=ra(n,q),u=t(u,d),u=$(u,0,-1),-1==u.ch&&u.line!=b.firstLine()&&(u=l(u.line-1,ha(b,u.line-1)))),[q,u]):[d.start,d.end]},repeatLastCharacterSearch:function(b,d,e){var g=J.lastChararacterSearch,f=e.repeat,h=e.forward===g.forward,l=(g.increment?1:0)*(h?-1:1);b.moveH(-l,"char");e.inclusive=h?!0:!1;e=Yb(b,f,h,g.selectedCharacter);if(!e)return b.moveH(l,"char"),d;e.ch+=l;return e}},ac={change:function(b,d,e){var g,m,h=b.state.vim;J.macroModeState.lastInsertModeChanges.inVisualBlock=
h.visualBlock;if(h.visualMode)m=b.getSelection(),g=Ia("",e.length),b.replaceSelections(g),g=ra(e[0].head,e[0].anchor);else{g=e[0].anchor;var l=e[0].head;m=b.getRange(g,l);h=h.lastEditInputState||{};if("moveByWords"==h.motion&&!/^\s*$/.test(m)){var t=/\s+$/.exec(m);t&&h.motionArgs&&h.motionArgs.forward&&(l=$(l,0,-t[0].length),m=m.slice(0,-t[0].length))}h=l.line-1==b.lastLine();b.replaceRange("",g,l);d.linewise&&!h&&(f.commands.newlineAndIndent(b),g.ch=null)}J.registerController.pushText(d.registerName,
"change",m,d.linewise,1<e.length);mb.enterInsertMode(b,{head:g},b.state.vim)},"delete":function(b,d,e){var g,f=b.state.vim;if(f.visualBlock){g=b.getSelection();var h=Ia("",e.length);b.replaceSelections(h);e=e[0].anchor}else h=e[0].anchor,e=e[0].head,d.linewise&&e.line!=b.firstLine()&&h.line==b.lastLine()&&h.line==e.line-1&&(h.line==b.firstLine()?h.ch=0:h=l(h.line-1,ha(b,h.line-1))),g=b.getRange(h,e),b.replaceRange("",h,e),e=h,d.linewise&&(e=Wa.moveToFirstNonWhiteSpaceCharacter(b,h));J.registerController.pushText(d.registerName,
"delete",g,d.linewise,f.visualBlock);return Q(b,e)},indent:function(b,d,e){var g=b.state.vim,f=e[0].anchor.line,h=g.visualBlock?e[e.length-1].anchor.line:e[0].head.line,g=g.visualMode?d.repeat:1;for(d.linewise&&h--;f<=h;f++)for(var l=0;l<g;l++)b.indentLine(f,d.indentRight);return Wa.moveToFirstNonWhiteSpaceCharacter(b,e[0].anchor)},changeCase:function(b,d,e,g,f){for(var h=b.getSelections(),l=[],t=d.toLower,q=0;q<h.length;q++){var n=h[q],u="";if(!0===t)u=n.toLowerCase();else if(!1===t)u=n.toUpperCase();
else for(var r=0;r<n.length;r++)var s=n.charAt(r),u=u+(x(s)?s.toLowerCase():s.toUpperCase());l.push(u)}b.replaceSelections(l);return d.shouldMoveCursor?f:!b.state.vim.visualMode&&d.linewise&&e[0].anchor.line+1==e[0].head.line?Wa.moveToFirstNonWhiteSpaceCharacter(b,g):d.linewise?g:ra(e[0].anchor,e[0].head)},yank:function(b,d,e,g){var f=b.state.vim;b=b.getSelection();e=f.visualMode?ra(f.sel.anchor,f.sel.head,e[0].head,e[0].anchor):g;J.registerController.pushText(d.registerName,"yank",b,d.linewise,f.visualBlock);
return e}},mb={jumpListWalk:function(b,d,e){e.visualMode||(e=d.repeat,d=(d=(d=J.jumpList.move(b,d.forward?e:-e))?d.find():void 0)?d:b.getCursor(),b.setCursor(d))},scroll:function(b,d,e){if(!e.visualMode){var g=d.repeat||1;e=b.defaultTextHeight();var f=b.getScrollInfo().top,g=e*g,f=d.forward?f+g:f-g,g=W(b.getCursor()),h=b.charCoords(g,"local");d.forward?f>h.top?(g.line+=(f-h.top)/e,g.line=Math.ceil(g.line),b.setCursor(g),h=b.charCoords(g,"local"),b.scrollTo(null,h.top)):b.scrollTo(null,f):(d=f+b.getScrollInfo().clientHeight,
d<h.bottom?(g.line-=(h.bottom-d)/e,g.line=Math.floor(g.line),b.setCursor(g),h=b.charCoords(g,"local"),b.scrollTo(null,h.bottom-b.getScrollInfo().clientHeight)):b.scrollTo(null,f))}},scrollToCursor:function(b,d){var e=b.getCursor().line,g=b.charCoords(l(e,0),"local"),e=b.getScrollInfo().clientHeight,f=g.top,g=g.bottom-f;switch(d.position){case "center":f=f-e/2+g;break;case "bottom":f=f-e+1.4*g;break;case "top":f+=.4*g}b.scrollTo(null,f)},replayMacro:function(b,d,e){var g=d.selectedCharacter;d=d.repeat;
var m=J.macroModeState;"@"==g&&(g=m.latestRegister);for(;d--;){var h=b,l=e,t=m,q=g,n=J.registerController.getRegister(q);if(":"==q)n.keyBuffer[0]&&Ra.processCommand(h,n.keyBuffer[0]);else{var q=n.keyBuffer,u=0;t.isPlaying=!0;t.replaySearchQueries=n.searchQueries.slice(0);for(var r=0;r<q.length;r++)for(var s=q[r],v,w;s;)v=/<\w+-.+?>|<\w+>|./.exec(s),w=v[0],s=s.substring(v.index+w.length),f.Vim.handleKey(h,w,"macro"),l.insertMode&&(v=n.insertModeChanges[u++].changes,J.macroModeState.lastInsertModeChanges.changes=
v,Ic(h,v,1),eb(h))}t.isPlaying=!1}},enterMacroRecordMode:function(b,d){J.macroModeState.enterMacroRecordMode(b,d.selectedCharacter)},enterInsertMode:function(b,d,e){if(!b.getOption("readOnly")){e.insertMode=!0;e.insertModeRepeat=d&&d.repeat||1;var g=d?d.insertAt:null,m=e.sel,h=d.head||b.getCursor("head"),t=b.listSelections().length;if("eol"==g)h=l(h.line,ha(b,h.line));else if("charAfter"==g)h=$(h,0,1);else if("firstNonBlank"==g)h=Wa.moveToFirstNonWhiteSpaceCharacter(b,h);else if("startOfSelectedArea"==
g)e.visualBlock?(h=l(Math.min(m.head.line,m.anchor.line),Math.min(m.head.ch,m.anchor.ch)),t=Math.abs(m.head.line-m.anchor.line)+1):h=m.head.line<m.anchor.line?m.head:l(m.anchor.line,0);else if("endOfSelectedArea"==g)e.visualBlock?(h=l(Math.min(m.head.line,m.anchor.line),Math.max(m.head.ch+1,m.anchor.ch)),t=Math.abs(m.head.line-m.anchor.line)+1):h=m.head.line>=m.anchor.line?$(m.head,0,1):l(m.anchor.line,0);else if("inplace"==g&&e.visualMode)return;b.setOption("keyMap","vim-insert");b.setOption("disableInput",
!1);d&&d.replace?(b.toggleOverwrite(!0),b.setOption("keyMap","vim-replace"),f.signal(b,"vim-mode-change",{mode:"replace"})):(b.setOption("keyMap","vim-insert"),f.signal(b,"vim-mode-change",{mode:"insert"}));J.macroModeState.isPlaying||(b.on("change",cc),f.on(b.getInputField(),"keydown",Hb));e.visualMode&&ma(b);xc(b,h,t)}},toggleVisualMode:function(b,d,e){var g=d.repeat,m=b.getCursor();e.visualMode?e.visualLine^d.linewise||e.visualBlock^d.blockwise?(e.visualLine=!!d.linewise,e.visualBlock=!!d.blockwise,
f.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":e.visualBlock?"blockwise":""}),db(b)):ma(b):(e.visualMode=!0,e.visualLine=!!d.linewise,e.visualBlock=!!d.blockwise,d=Q(b,l(m.line,m.ch+g-1),!0),e.sel={anchor:m,head:d},f.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":e.visualBlock?"blockwise":""}),db(b),Pa(b,e,"<",ra(m,d)),Pa(b,e,">",t(m,d)))},reselectLastSelection:function(b,d,e){d=e.lastSelection;e.visualMode&&Cb(b,e);if(d){var g=d.anchorMark.find(),
m=d.headMark.find();g&&m&&(e.sel={anchor:g,head:m},e.visualMode=!0,e.visualLine=d.visualLine,e.visualBlock=d.visualBlock,db(b),Pa(b,e,"<",ra(g,m)),Pa(b,e,">",t(g,m)),f.signal(b,"vim-mode-change",{mode:"visual",subMode:e.visualLine?"linewise":e.visualBlock?"blockwise":""}))}},joinLines:function(b,d,e){var g;if(e.visualMode){d=b.getCursor("anchor");g=b.getCursor("head");if(ba(g,d)){var f=g;g=d;d=f}g.ch=ha(b,g.line)-1}else g=Math.max(d.repeat,2),d=b.getCursor(),g=Q(b,l(d.line+g-1,Infinity));for(var h=
0,t=d.line;t<g.line;t++){var h=ha(b,d.line),f=l(d.line+1,ha(b,d.line+1)),n=b.getRange(d,f),n=n.replace(/\n\s*/g," ");b.replaceRange(n,d,f)}d=l(d.line,h);e.visualMode&&ma(b,!1);b.setCursor(d)},newLineAndEnterInsertMode:function(b,d,e){e.insertMode=!0;var g=W(b.getCursor());g.line!==b.firstLine()||d.after?(g.line=d.after?g.line:g.line-1,g.ch=ha(b,g.line),b.setCursor(g),(f.commands.newlineAndIndentContinueComment||f.commands.newlineAndIndent)(b)):(b.replaceRange("\n",l(b.firstLine(),0)),b.setCursor(b.firstLine(),
0));this.enterInsertMode(b,{repeat:d.repeat},e)},paste:function(b,d,e){var g=W(b.getCursor()),f=J.registerController.getRegister(d.registerName),h=f.toString();if(h){if(d.matchIndent)var t=b.getOption("tabSize"),n=function(b){var d=b.split("\t").length-1;b=b.split(" ").length-1;return d*t+1*b},q=b.getLine(b.getCursor().line),u=n(q.match(/^\s*/)[0]),q=h.replace(/\n$/,""),r=h!==q,s=n(h.match(/^\s*/)[0]),h=q.replace(/^\s*/gm,function(d){d=u+(n(d)-s);return 0>d?"":b.getOption("indentWithTabs")?Array(Math.floor(d/
t)+1).join("\t"):Array(d+1).join(" ")}),h=h+(r?"\n":"");1<d.repeat&&(h=Array(d.repeat+1).join(h));q=f.linewise;f=f.blockwise;if(q)e.visualMode?h=e.visualLine?h.slice(0,-1):"\n"+h.slice(0,h.length-1)+"\n":d.after?(h="\n"+h.slice(0,h.length-1),g.ch=ha(b,g.line)):g.ch=0;else{if(f)for(h=h.split("\n"),r=0;r<h.length;r++)h[r]=""==h[r]?" ":h[r];g.ch+=d.after?1:0}var v;if(e.visualMode){e.lastPastedText=h;d=yc(b,e);g=d[0];d=d[1];var r=b.getSelection(),w=b.listSelections(),w=Array(w.length).join("1").split("1");
e.lastSelection&&(v=e.lastSelection.headMark.find());J.registerController.unnamedRegister.setText(r);f?(b.replaceSelections(w),d=l(g.line+h.length-1,g.ch),b.setCursor(g),wc(b,d),b.replaceSelections(h),h=g):e.visualBlock?(b.replaceSelections(w),b.setCursor(g),b.replaceRange(h,g,g),h=g):(b.replaceRange(h,g,d),h=b.posFromIndex(b.indexFromPos(g)+h.length-1));v&&(e.lastSelection.headMark=b.setBookmark(v));q&&(h.ch=0)}else if(f){b.setCursor(g);for(r=0;r<h.length;r++)v=g.line+r,v>b.lastLine()&&b.replaceRange("\n",
l(v,0)),ha(b,v)<g.ch&&Kd(b,v,g.ch);b.setCursor(g);wc(b,l(g.line+h.length-1,g.ch));b.replaceSelections(h);h=g}else b.replaceRange(h,g),q&&d.after?h=l(g.line+1,Aa(b.getLine(g.line+1))):q&&!d.after?h=l(g.line,Aa(b.getLine(g.line))):!q&&d.after?(v=b.indexFromPos(g),h=b.posFromIndex(v+h.length-1)):(v=b.indexFromPos(g),h=b.posFromIndex(v+h.length));e.visualMode&&ma(b,!1);b.setCursor(h)}},undo:function(b,d){b.operation(function(){ka(b,f.commands.undo,d.repeat)();b.setCursor(b.getCursor("anchor"))})},redo:function(b,
d){ka(b,f.commands.redo,d.repeat)()},setRegister:function(b,d,e){e.inputState.registerName=d.selectedCharacter},setMark:function(b,d,e){Pa(b,e,d.selectedCharacter,b.getCursor())},replace:function(b,d,e){var g=d.selectedCharacter,m=b.getCursor(),h,t=b.listSelections();e.visualMode?(m=b.getCursor("start"),h=b.getCursor("end")):(h=b.getLine(m.line),d=m.ch+d.repeat,d>h.length&&(d=h.length),h=l(m.line,d));"\n"==g?(e.visualMode||b.replaceRange("",m,h),(f.commands.newlineAndIndentContinueComment||f.commands.newlineAndIndent)(b)):
(d=b.getRange(m,h),d=d.replace(/[^\n]/g,g),e.visualBlock?(m=Array(b.getOption("tabSize")+1).join(" "),d=b.getSelection(),d=d.replace(/\t/g,m).replace(/[^\n]/g,g).split("\n"),b.replaceSelections(d)):b.replaceRange(d,m,h),e.visualMode?(m=ba(t[0].anchor,t[0].head)?t[0].anchor:t[0].head,b.setCursor(m),ma(b,!1)):b.setCursor($(h,0,-1)))},incrementNumberToken:function(b,d){for(var e=b.getCursor(),g=b.getLine(e.line),f=/-?\d+/g,h,t,n,q;null!==(h=f.exec(g))&&!(q=h[0],t=h.index,n=t+q.length,e.ch<n););!d.backtrack&&
n<=e.ch||!q||(g=d.increase?1:-1,g=parseInt(q)+g*d.repeat,q=l(e.line,t),n=l(e.line,n),g=g.toString(),b.replaceRange(g,q,n),b.setCursor(l(e.line,t+g.length-1)))},repeatLastEdit:function(b,d,e){if(e.lastEditInputState){var g=d.repeat;g&&d.repeatIsExplicit?e.lastEditInputState.repeatOverride=g:g=e.lastEditInputState.repeatOverride||g;Gc(b,e,g,!1)}},exitInsertMode:eb},Kc={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method",
"#":"preprocess"},Dc={bracket:{isComplete:function(b){if(b.nextCh===b.symb){if(b.depth++,1<=b.depth)return!0}else b.nextCh===b.reverseSymb&&b.depth--;return!1}},section:{init:function(b){b.curMoveThrough=!0;b.symb=(b.forward?"]":"[")===b.symb?"{":"}"},isComplete:function(b){return 0===b.index&&b.nextCh===b.symb}},comment:{isComplete:function(b){var d="*"===b.lastCh&&"/"===b.nextCh;b.lastCh=b.nextCh;return d}},method:{init:function(b){b.symb="m"===b.symb?"{":"}";b.reverseSymb="{"===b.symb?"}":"{"},
isComplete:function(b){return b.nextCh===b.symb?!0:!1}},preprocess:{init:function(b){b.index=0},isComplete:function(b){if("#"===b.nextCh){var d=b.lineText.match(/#(\w+)/)[1];if("endif"===d){if(b.forward&&0===b.depth)return!0;b.depth++}else if("if"===d){if(!b.forward&&0===b.depth)return!0;b.depth--}if("else"===d&&0===b.depth)return!0}return!1}}};v("pcre",!0,"boolean");Bc.prototype={getQuery:function(){return J.query},setQuery:function(b){J.query=b},getOverlay:function(){return this.searchOverlay},
setOverlay:function(b){this.searchOverlay=b},isReversed:function(){return J.isReversed},setReversed:function(b){J.isReversed=b},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(b){this.annotate=b}};var Mc={"\\n":"\n","\\r":"\r","\\t":"\t"},Nc={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"},wb="(Javascript regexp)",kb=function(){this.buildCommandMap_()};kb.prototype={processCommand:function(b,d,e){var g=this;b.operation(function(){b.curOp.isVimOp=!0;g._processCommand(b,
d,e)})},_processCommand:function(b,d,e){var g=b.state.vim,m=J.registerController.getRegister(":"),h=m.toString();g.visualMode&&ma(b);g=new f.StringStream(d);m.setText(d);e=e||{};e.input=d;try{this.parseInput_(b,g,e)}catch(l){throw X(b,l),l;}var t,q;if(e.commandName){if(t=this.matchCommand_(e.commandName)){q=t.name;t.excludeFromCommandHistory&&m.setText(h);this.parseCommandArgs_(g,e,t);if("exToKey"==t.type){for(d=0;d<t.toKeys.length;d++)f.Vim.handleKey(b,t.toKeys[d],"mapping");return}if("exToEx"==
t.type){this.processCommand(b,t.toInput);return}}}else void 0!==e.line&&(q="move");if(q)try{fc[q](b,e),t&&t.possiblyAsync||!e.callback||e.callback()}catch(n){throw X(b,n),n;}else X(b,'Not an editor command ":'+d+'"')},parseInput_:function(b,d,e){d.eatWhile(":");d.eat("%")?(e.line=b.firstLine(),e.lineEnd=b.lastLine()):(e.line=this.parseLineSpec_(b,d),void 0!==e.line&&d.eat(",")&&(e.lineEnd=this.parseLineSpec_(b,d)));b=d.match(/^(\w+)/);e.commandName=b?b[1]:d.match(/.*/)[0];return e},parseLineSpec_:function(b,
d){var e=d.match(/^(\d+)/);if(e)return parseInt(e[1],10)-1;switch(d.next()){case ".":return b.getCursor().line;case "$":return b.lastLine();case "'":if((e=b.state.vim.marks[d.next()])&&e.find())return e.find().line;throw Error("Mark not set");default:d.backUp(1)}},parseCommandArgs_:function(b,d,e){b.eol()||(d.argString=b.match(/.*/)[0],b=e.argDelimiter||/\s+/,b=Ub(d.argString).split(b),b.length&&b[0]&&(d.args=b))},matchCommand_:function(b){for(var d=b.length;0<d;d--){var e=b.substring(0,d);if(this.commandMap_[e]&&
(e=this.commandMap_[e],0===e.name.indexOf(b)))return e}return null},buildCommandMap_:function(){this.commandMap_={};for(var b=0;b<I.length;b++){var d=I[b];this.commandMap_[d.shortName||d.name]=d}},map:function(b,d,e){if(":"!=b&&":"==b.charAt(0)){if(e)throw Error("Mode not supported for ex mappings");e=b.substring(1);":"!=d&&":"==d.charAt(0)?this.commandMap_[e]={name:e,type:"exToEx",toInput:d.substring(1),user:!0}:this.commandMap_[e]={name:e,type:"exToKey",toKeys:d,user:!0}}else d=":"!=d&&":"==d.charAt(0)?
{keys:b,type:"keyToEx",exArgs:{input:d.substring(1)},user:!0}:{keys:b,type:"keyToKey",toKeys:d,user:!0},e&&(d.context=e),G.unshift(d)},unmap:function(b,d){if(":"!=b&&":"==b.charAt(0)){if(d)throw Error("Mode not supported for ex mappings");var e=b.substring(1);if(this.commandMap_[e]&&this.commandMap_[e].user){delete this.commandMap_[e];return}}else for(e=0;e<G.length;e++)if(b==G[e].keys&&G[e].context===d&&G[e].user){G.splice(e,1);return}throw Error("No such mapping.");}};var fc={colorscheme:function(b,
d){!d.args||1>d.args.length?X(b,b.getOption("theme")):b.setOption("theme",d.args[0])},map:function(b,d,e){var g=d.args;!g||2>g.length?b&&X(b,"Invalid mapping: "+d.input):Ra.map(g[0],g[1],e)},imap:function(b,d){this.map(b,d,"insert")},nmap:function(b,d){this.map(b,d,"normal")},vmap:function(b,d){this.map(b,d,"visual")},unmap:function(b,d,e){var g=d.args;!g||1>g.length?b&&X(b,"No such mapping: "+d.input):Ra.unmap(g[0],e)},move:function(b,d){Na.processCommand(b,b.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",
motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:d.line+1})},set:function(b,d){var e=d.args,g=d.setCfg||{};if(!e||1>e.length)b&&X(b,"Invalid mapping: "+d.input);else{var f=e[0].split("="),e=f[0],f=f[1],h=!1;if("?"==e.charAt(e.length-1)){if(f)throw Error("Trailing characters: "+d.argString);e=e.substring(0,e.length-1);h=!0}void 0===f&&"no"==e.substring(0,2)&&(e=e.substring(2),f=!1);var l=Ba[e]&&"boolean"==Ba[e].type;l&&void 0==f&&(f=!0);!l&&void 0===f||h?(g=aa(e,b,g),!0===g||!1===
g?X(b," "+(g?"":"no")+e):X(b,"  "+e+"="+g)):D(e,f,b,g)}},setlocal:function(b,d){d.setCfg={scope:"local"};this.set(b,d)},setglobal:function(b,d){d.setCfg={scope:"global"};this.set(b,d)},registers:function(b,d){var e=d.args,g=J.registerController.registers,f="----------Registers----------<br><br>";if(e)for(var e=e.join(""),h=0;h<e.length;h++){if(t=e.charAt(h),J.registerController.isValidRegister(t))var l=g[t]||new fa,f=f+('"'+t+"    "+l.toString()+"<br>")}else for(var t in g)e=g[t].toString(),e.length&&
(f+='"'+t+"    "+e+"<br>");X(b,f)},sort:function(b,d){function e(b,d){if(g){var e;e=b;b=d;d=e}m&&(b=b.toLowerCase(),d=d.toLowerCase());e=t&&r.exec(b);var h=t&&r.exec(d);if(!e)return b<d?-1:1;e=parseInt((e[1]+e[2]).toLowerCase(),v);h=parseInt((h[1]+h[2]).toLowerCase(),v);return e-h}var g,m,h,t,n=function(){if(d.argString){var b=new f.StringStream(d.argString);b.eat("!")&&(g=!0);if(!b.eol()){if(!b.eatSpace())return"Invalid arguments";var e=b.match(/[a-z]+/);if(e){e=e[0];m=-1!=e.indexOf("i");h=-1!=e.indexOf("u");
var l=-1!=e.indexOf("d")&&1,q=-1!=e.indexOf("x")&&1,e=-1!=e.indexOf("o")&&1;if(1<l+q+e)return"Invalid arguments";t=l&&"decimal"||q&&"hex"||e&&"octal"}if(b.match(/\/.*\//))return"patterns not supported"}}}();if(n)X(b,n+": "+d.argString);else{var n=d.line||b.firstLine(),q=d.lineEnd||d.line||b.lastLine();if(n!=q){var n=l(n,0),q=l(q,ha(b,q)),u=b.getRange(n,q).split("\n"),r="decimal"==t?/(-?)([\d]+)/:"hex"==t?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==t?/([0-7]+)/:null,v="decimal"==t?10:"hex"==t?16:"octal"==t?
8:null,s=[],w=[];if(t)for(var x=0;x<u.length;x++)r.exec(u[x])?s.push(u[x]):w.push(u[x]);else w=u;s.sort(e);w.sort(e);u=g?s.concat(w):w.concat(s);if(h)for(var s=u,D,u=[],x=0;x<s.length;x++)s[x]!=D&&u.push(s[x]),D=s[x];b.replaceRange(u.join("\n"),n,q)}}},global:function(b,d){var e=d.argString;if(e){var g=void 0!==d.line?d.line:b.firstLine(),f=d.lineEnd||d.line||b.lastLine(),h=Cc(e),l;h.length&&(e=h[0],l=h.slice(1,h.length).join("/"));if(e)try{Eb(b,e,!0,!0)}catch(t){X(b,"Invalid regex: "+e);return}for(var h=
Ja(b).getQuery(),q=[],e="";g<=f;g++)h.test(b.getLine(g))&&(q.push(g+1),e+=b.getLine(g)+"<br>");if(l){var n=0,u=function(){n<q.length&&Ra.processCommand(b,q[n]+l,{callback:u});n++};u()}else X(b,e)}else X(b,"Regular Expression missing from global")},substitute:function(b,d){if(!b.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var e=d.argString,g=e?Cc(e):[],m,h="",t,n,q=!1,u=!1;if(g.length){m=g[0];h=g[1];if(void 0!==
h){if(aa("pcre"))for(h=new f.StringStream(h),t=[];!h.eol();){for(;h.peek()&&"\\"!=h.peek();)t.push(h.next());var e=!1,r;for(r in Nc)if(h.match(r,!0)){e=!0;t.push(Nc[r]);break}e||t.push(h.next())}else for(r=!1,t=[],e=-1;e<h.length;e++){var s=h.charAt(e)||"",v=h.charAt(e+1)||"";Mc[s+v]?(t.push(Mc[s+v]),e++):r?(t.push(s),r=!1):"\\"===s?(r=!0,Bb.test(v)||"$"===v?t.push("$"):"/"!==v&&"\\"!==v&&t.push("\\")):("$"===s&&t.push("$"),t.push(s),"/"===v&&t.push("\\"))}h=t.join("");J.lastSubstituteReplacePart=
h}t=g[2]?g[2].split(" "):[]}else if(e&&e.length){X(b,"Substitutions should be of the form :s/pattern/replace/");return}t&&(g=t[0],n=parseInt(t[1]),g&&(-1!=g.indexOf("c")&&(q=!0,g.replace("c","")),-1!=g.indexOf("g")&&(u=!0,g.replace("g","")),m=m+"/"+g));if(m)try{Eb(b,m,!0,!0)}catch(w){X(b,"Invalid regex: "+m);return}h=h||J.lastSubstituteReplacePart;void 0===h?X(b,"No previous substitute regular expression"):(m=Ja(b).getQuery(),g=void 0!==d.line?d.line:b.getCursor().line,r=d.lineEnd||g,g==b.firstLine()&&
r==b.lastLine()&&(r=Infinity),n&&(g=r,r=g+n-1),n=Q(b,l(g,0)),n=b.getSearchCursor(m,n),Gb(b,q,u,g,r,n,m,h,d.callback))},redo:f.commands.redo,undo:f.commands.undo,write:function(b){f.commands.save?f.commands.save(b):b.save()},nohlsearch:function(b){Ga(b)},delmarks:function(b,d){if(d.argString&&Ub(d.argString))for(var e=b.state.vim,g=new f.StringStream(Ub(d.argString));!g.eol();){g.eatSpace();var m=g.pos;if(!g.match(/[a-zA-Z]/,!1)){X(b,"Invalid argument: "+d.argString.substring(m));break}var h=g.next();
if(g.match("-",!0)){if(!g.match(/[a-zA-Z]/,!1)){X(b,"Invalid argument: "+d.argString.substring(m));break}var l=g.next();if(/^[a-z]$/.test(h)&&/^[a-z]$/.test(l)||x(h)&&x(l)){h=h.charCodeAt(0);l=l.charCodeAt(0);if(h>=l){X(b,"Invalid argument: "+d.argString.substring(m));break}for(m=0;m<=l-h;m++){var t=String.fromCharCode(h+m);delete e.marks[t]}}else{X(b,"Invalid argument: "+h+"-");break}}else delete e.marks[h]}else X(b,"Argument required")}},Ra=new kb;f.keyMap.vim={attach:n,detach:s,call:y};v("insertModeEscKeysTimeout",
200,"number");f.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(b){(f.commands.newlineAndIndentContinueComment||f.commands.newlineAndIndent)(b)},fallthrough:["default"],attach:n,detach:s,call:y};f.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:n,detach:s,call:y};S();return ec}()});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,l){return f.line==l.line&&f.ch==l.ch}function I(f){ka.push(f);50<ka.length&&ka.shift()}function l(f){return ka[ka.length-(f?Math.min(f,1):1)]||""}function s(){1<ka.length&&ka.pop();return l()}function n(f,l,n,u,r){null==r&&(r=f.getRange(l,n));u&&W&&W.cm==f&&G(l,W.pos)&&f.isClean(W.gen)?ka.length?
ka[ka.length-1]+=r:I(r):I(r);f.replaceRange("",l,n,"+delete");W=u?{cm:f,pos:l,gen:f.changeGeneration()}:null}function y(f,l,n){return f.findPosH(l,n,"char",!0)}function B(f,l,n){return f.findPosH(l,n,"word",!0)}function H(f,l,n){return f.findPosV(l,n,"line",f.doc.sel.goalColumn)}function w(f,l,n){return f.findPosV(l,n,"page",f.doc.sel.goalColumn)}function r(f,l,n){var u=l.line,r=f.getLine(u);l=/\S/.test(0>n?r.slice(0,l.ch):r.slice(l.ch));for(var s=f.firstLine(),v=f.lastLine();;){u+=n;if(u<s||u>v)return f.clipPos(qa(u-
n,0>n?0:null));r=f.getLine(u);if(/\S/.test(r))l=!0;else if(l)return qa(u,0)}}function x(f,l,n){var u=l.line,r=l.ch;l=f.getLine(l.line);for(var s=!1;;){var v=l.charAt(r+(0>n?-1:0));if(v){if(s&&/[!?.]/.test(v))return qa(u,r+(0<n?1:0));s||(s=/\w/.test(v));r+=n}else{if(u==(0>n?f.firstLine():f.lastLine()))return qa(u,r);l=f.getLine(u+n);if(!/\S/.test(l))return qa(u,r);u+=n;r=0>n?l.length:0}}}function T(f,l,n){var u;if(f.findMatchingBracket&&(u=f.findMatchingBracket(l,!0))&&u.match&&(u.forward?1:-1)==n)return 0<
n?qa(u.to.line,u.to.ch+1):u.to;for(var r=!0;;r=!1){var s=f.getTokenAt(l);u=qa(l.line,0>n?s.start:s.end);if(r&&0<n&&s.end==l.ch||!/\w/.test(s.string)){r=f.findPosH(u,n,"char");if(G(u,r))return l;l=r}else return u}}function v(f,l){var n=f.state.emacsPrefix;if(!n)return l?null:1;fa(f);return"-"==n?-1:Number(n)}function D(f){var l="string"==typeof f?function(l){l.execCommand(f)}:f;return function(f){var t=v(f);l(f);for(var n=1;n<t;++n)l(f)}}function aa(f,l,n,u){var r=v(f);0>r&&(u=-u,r=-r);for(var s=0;s<
r;++s){var w=n(f,l,u);if(G(w,l))break;l=w}return l}function C(f,l){var n=function(n){n.extendSelection(aa(n,n.getCursor(),f,l))};n.motion=!0;return n}function u(f,l,u){for(var r=f.listSelections(),s,v=r.length;v--;)s=r[v].head,n(f,s,aa(f,s,l,u),!0)}function S(f){if(f.somethingSelected()){for(var l=f.listSelections(),u,r=l.length;r--;)u=l[r],n(f,u.anchor,u.head);return!0}}function Ha(f,l){f.state.emacsPrefix?"-"!=l&&(f.state.emacsPrefix+=l):(f.state.emacsPrefix=l,f.on("keyHandled",ja),f.on("inputRead",
ga))}function ja(f,l){f.state.emacsPrefixMap||ta.hasOwnProperty(l)||fa(f)}function fa(f){f.state.emacsPrefix=null;f.off("keyHandled",ja);f.off("inputRead",ga)}function ga(f,l){var n=v(f);if(1<n&&"+input"==l.origin){for(var u=l.text.join("\n"),r="",s=1;s<n;++s)r+=u;f.replaceSelection(r)}}function va(f,l){if("string"!=typeof l||!/^\d$/.test(l)&&"Ctrl-U"!=l)f.removeKeyMap(ra),f.state.emacsPrefixMap=!1,f.off("keyHandled",va),f.off("inputRead",va)}function Ia(f){f.setCursor(f.getCursor());f.setExtending(!f.getExtending());
f.on("change",function(){f.setExtending(!1)})}function Q(f,l,n){f.openDialog?f.openDialog(l+': <input type="text" style="width: 10em"/>',n,{bottom:!0}):n(prompt(l,""))}function la(f,l){var n=f.getCursor(),u=f.findPosH(n,1,"word");f.replaceRange(l(f.getRange(n,u)),n,u);f.setCursor(u)}function $(f){ra[f]=function(l){Ha(l,f)};ba["Ctrl-"+f]=function(l){Ha(l,f)};ta["Ctrl-"+f]=!0}var qa=f.Pos,ka=[],W=null,ta={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0},ba=f.keyMap.emacs=f.normalizeKeyMap({"Ctrl-W":function(f){n(f,
f.getCursor("start"),f.getCursor("end"))},"Ctrl-K":D(function(f){var l=f.getCursor(),u=f.clipPos(qa(l.line)),r=f.getRange(l,u);/\S/.test(r)||(r+="\n",u=qa(l.line+1,0));n(f,l,u,!0,r)}),"Alt-W":function(f){I(f.getSelection());f.setExtending(!1);f.setCursor(f.getCursor())},"Ctrl-Y":function(f){var n=f.getCursor();f.replaceRange(l(v(f)),n,n,"paste");f.setSelection(n,f.getCursor())},"Alt-Y":function(f){f.replaceSelection(s(),"around","paste")},"Ctrl-Space":Ia,"Ctrl-Shift-2":Ia,"Ctrl-F":C(y,1),"Ctrl-B":C(y,
-1),Right:C(y,1),Left:C(y,-1),"Ctrl-D":function(f){u(f,y,1)},Delete:function(f){S(f)||u(f,y,1)},"Ctrl-H":function(f){u(f,y,-1)},Backspace:function(f){S(f)||u(f,y,-1)},"Alt-F":C(B,1),"Alt-B":C(B,-1),"Alt-D":function(f){u(f,B,1)},"Alt-Backspace":function(f){u(f,B,-1)},"Ctrl-N":C(H,1),"Ctrl-P":C(H,-1),Down:C(H,1),Up:C(H,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":C(w,-1),"Ctrl-V":C(w,1),PageUp:C(w,-1),PageDown:C(w,1),"Ctrl-Up":C(r,-1),"Ctrl-Down":C(r,1),
"Alt-A":C(x,-1),"Alt-E":C(x,1),"Alt-K":function(f){u(f,x,1)},"Ctrl-Alt-K":function(f){u(f,T,1)},"Ctrl-Alt-Backspace":function(f){u(f,T,-1)},"Ctrl-Alt-F":C(T,1),"Ctrl-Alt-B":C(T,-1),"Shift-Ctrl-Alt-2":function(f){var l=f.getCursor();f.setSelection(aa(f,l,T,1),l)},"Ctrl-Alt-T":function(f){var l=T(f,f.getCursor(),-1),n=T(f,l,1),u=T(f,n,1),r=T(f,u,-1);f.replaceRange(f.getRange(r,u)+f.getRange(n,r)+f.getRange(l,n),l,u)},"Ctrl-Alt-U":D(function(f){for(var l=f.getCursor(),n=l.line,l=l.ch,u=[];n>=f.firstLine();){for(var r=
f.getLine(n),s=null==l?r.length:l;0<s;)if(l=r.charAt(--s),")"==l)u.push("(");else if("]"==l)u.push("[");else if("}"==l)u.push("{");else if(/[\(\{\[]/.test(l)&&(!u.length||u.pop()!=l))return f.extendSelection(qa(n,s));--n;l=null}}),"Alt-Space":function(f){for(var l=f.getCursor(),n=l.ch,u=l.ch,r=f.getLine(l.line);n&&/\s/.test(r.charAt(n-1));)--n;for(;u<r.length&&/\s/.test(r.charAt(u));)++u;f.replaceRange(" ",qa(l.line,n),qa(l.line,u))},"Ctrl-O":D(function(f){f.replaceSelection("\n","start")}),"Ctrl-T":D(function(f){f.execCommand("transposeChars")}),
"Alt-C":D(function(f){la(f,function(f){var l=f.search(/\w/);return-1==l?f:f.slice(0,l)+f.charAt(l).toUpperCase()+f.slice(l+1).toLowerCase()})}),"Alt-U":D(function(f){la(f,function(f){return f.toUpperCase()})}),"Alt-L":D(function(f){la(f,function(f){return f.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":D("undo"),"Shift-Ctrl--":D("undo"),"Ctrl-Z":D("undo"),"Cmd-Z":D("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findNext","Ctrl-R":"findPrev","Ctrl-G":function(f){f.execCommand("clearSearch");
f.setExtending(!1);f.setCursor(f.getCursor())},"Shift-Alt-5":"replace","Alt-/":"autocomplete","Ctrl-J":"newlineAndIndent",Enter:!1,Tab:"indentAuto","Alt-G G":function(f){var l=v(f,!0);if(null!=l&&0<l)return f.setCursor(l-1);Q(f,"Goto line",function(l){var n;l&&!isNaN(n=Number(l))&&n==(n|0)&&0<n&&f.setCursor(n-1)})},"Ctrl-X Tab":function(f){f.indentSelection(v(f,!0)||f.getOption("indentUnit"))},"Ctrl-X Ctrl-X":function(f){f.setSelection(f.getCursor("head"),f.getCursor("anchor"))},"Ctrl-X Ctrl-S":"save",
"Ctrl-X Ctrl-W":"save","Ctrl-X S":"saveAll","Ctrl-X F":"open","Ctrl-X U":D("undo"),"Ctrl-X K":"close","Ctrl-X Delete":function(f){n(f,f.getCursor(),x(f,f.getCursor(),1),!0)},"Ctrl-X H":"selectAll","Ctrl-Q Tab":D("insertTab"),"Ctrl-U":function(f){f.state.emacsPrefixMap=!0;f.addKeyMap(ra);f.on("keyHandled",va);f.on("inputRead",va)}}),ra={"Ctrl-G":fa};for(f=0;10>f;++f)$(String(f));$("-")});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,s,n){f=f.getWrapperElement().appendChild(document.createElement("div"));f.className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top";"string"==typeof s?f.innerHTML=s:f.appendChild(s);return f}function I(f,s){f.state.currentNotificationClose&&f.state.currentNotificationClose();
f.state.currentNotificationClose=s}f.defineExtension("openDialog",function(l,s,n){function y(f){if("string"==typeof f)r.value=f;else if(!H&&(H=!0,B.parentNode.removeChild(B),w.focus(),n.onClose))n.onClose(B)}n||(n={});I(this,null);var B=G(this,l,n.bottom),H=!1,w=this,r=B.getElementsByTagName("input")[0];if(r){n.value&&(r.value=n.value,!1!==n.selectValueOnOpen&&r.select());if(n.onInput)f.on(r,"input",function(f){n.onInput(f,r.value,y)});if(n.onKeyUp)f.on(r,"keyup",function(f){n.onKeyUp(f,r.value,y)});
f.on(r,"keydown",function(l){if(!(n&&n.onKeyDown&&n.onKeyDown(l,r.value,y))){if(27==l.keyCode||!1!==n.closeOnEnter&&13==l.keyCode)r.blur(),f.e_stop(l),y();13==l.keyCode&&s(r.value,l)}});if(!1!==n.closeOnBlur)f.on(r,"blur",y);r.focus()}else if(l=B.getElementsByTagName("button")[0]){f.on(l,"click",function(){y();w.focus()});if(!1!==n.closeOnBlur)f.on(l,"blur",y);l.focus()}return y});f.defineExtension("openConfirm",function(l,s,n){function y(){H||(H=!0,B.parentNode.removeChild(B),w.focus())}I(this,null);
var B=G(this,l,n&&n.bottom);l=B.getElementsByTagName("button");var H=!1,w=this,r=1;l[0].focus();for(n=0;n<l.length;++n){var x=l[n];(function(l){f.on(x,"click",function(n){f.e_preventDefault(n);y();l&&l(w)})})(s[n]);f.on(x,"blur",function(){--r;setTimeout(function(){0>=r&&y()},200)});f.on(x,"focus",function(){++r})}});f.defineExtension("openNotification",function(l,s){function n(){B||(B=!0,clearTimeout(H),y.parentNode.removeChild(y))}I(this,n);var y=G(this,l,s&&s.bottom),B=!1,H,w=s&&"undefined"!==
typeof s.duration?s.duration:5E3;f.on(y,"click",function(l){f.e_preventDefault(l);n()});w&&(H=setTimeout(n,w));return n})});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,l){return"pairs"==l&&"string"==typeof f?f:"object"==typeof f&&null!=f[l]?f[l]:H[l]}function I(f){return function(l){return s(l,f)}}function l(f){var l=f.state.closeBrackets;return l?f.getModeAt(f.getCursor()).closeBrackets||l:null}function s(r,s){var x=l(r);if(!x||r.getOption("disableInput"))return f.Pass;
var C=G(x,"pairs"),u=C.indexOf(s);if(-1==u)return f.Pass;for(var x=G(x,"triples"),y=C.charAt(u+1)==s,T=r.listSelections(),H=0==u%2,I,ga,va=0;va<T.length;va++){var Ia=T[va],Q=Ia.head;ga=r.getRange(Q,w(Q.line,Q.ch+1));if(H&&!Ia.empty())ga="surround";else if(!y&&H||ga!=s)if(y&&1<Q.ch&&0<=x.indexOf(s)&&r.getRange(w(Q.line,Q.ch-2),Q)==s+s&&(2>=Q.ch||r.getRange(w(Q.line,Q.ch-3),w(Q.line,Q.ch-2))!=s))ga="addFour";else if(y)if(!f.isWordChar(ga)&&B(r,Q,s))ga="both";else return f.Pass;else if(H&&(r.getLine(Q.line).length==
Q.ch||n(ga,C)||/\s/.test(ga)))ga="both";else return f.Pass;else ga=0<=x.indexOf(s)&&r.getRange(Q,w(Q.line,Q.ch+3))==s+s+s?"skipThree":"skip";if(!I)I=ga;else if(I!=ga)return f.Pass}var la=u%2?C.charAt(u-1):s,$=u%2?s:C.charAt(u+1);r.operation(function(){if("skip"==I)r.execCommand("goCharRight");else if("skipThree"==I)for(var l=0;3>l;l++)r.execCommand("goCharRight");else if("surround"==I){for(var n=r.getSelections(),l=0;l<n.length;l++)n[l]=la+n[l]+$;r.replaceSelections(n,"around");n=r.listSelections().slice();
for(l=0;l<n.length;l++){var u=n,s=l,x;x=n[l];var D=0<f.cmpPos(x.anchor,x.head);x={anchor:new w(x.anchor.line,x.anchor.ch+(D?-1:1)),head:new w(x.head.line,x.head.ch+(D?1:-1))};u[s]=x}r.setSelections(n)}else"both"==I?(r.replaceSelection(la+$,null),r.triggerElectric(la+$),r.execCommand("goCharLeft")):"addFour"==I&&(r.replaceSelection(la+la+la+la,"before"),r.execCommand("goCharRight"))})}function n(f,l){var n=l.lastIndexOf(f);return-1<n&&1==n%2}function y(f,l){var n=f.getRange(w(l.line,l.ch-1),w(l.line,
l.ch+1));return 2==n.length?n:null}function B(l,n,r){var s=l.getLine(n.line),u=l.getTokenAt(n);if(/\bstring2?\b/.test(u.type))return!1;r=new f.StringStream(s.slice(0,n.ch)+r+s.slice(n.ch),4);for(r.pos=r.start=u.start;;){s=l.getMode().token(r,u.state);if(r.pos>=n.ch+1)return/\bstring2?\b/.test(s);r.start=r.pos}}var H={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},w=f.Pos;f.defineOption("autoCloseBrackets",!1,function(l,n,r){r&&r!=f.Init&&(l.removeKeyMap(x),l.state.closeBrackets=null);n&&(l.state.closeBrackets=
n,l.addKeyMap(x))});for(var r=H.pairs+"`",x={Backspace:function(n){var r=l(n);if(!r||n.getOption("disableInput"))return f.Pass;for(var s=G(r,"pairs"),r=n.listSelections(),x=0;x<r.length;x++){if(!r[x].empty())return f.Pass;var u=y(n,r[x].head);if(!u||0!=s.indexOf(u)%2)return f.Pass}for(x=r.length-1;0<=x;x--)s=r[x].head,n.replaceRange("",w(s.line,s.ch-1),w(s.line,s.ch+1))},Enter:function(n){var r=l(n),r=r&&G(r,"explode");if(!r||n.getOption("disableInput"))return f.Pass;for(var s=n.listSelections(),
w=0;w<s.length;w++){if(!s[w].empty())return f.Pass;var u=y(n,s[w].head);if(!u||0!=r.indexOf(u)%2)return f.Pass}n.operation(function(){n.replaceSelection("\n\n",null);n.execCommand("goCharLeft");s=n.listSelections();for(var f=0;f<s.length;f++){var l=s[f].head.line;n.indentLine(l,null,!0);n.indentLine(l+1,null,!0)}})}},T=0;T<r.length;T++)x["'"+r.charAt(T)+"'"]=I(r.charAt(T))});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,l,n,s){var v=f.getLineHandle(l.line),D=l.ch-1,v=0<=D&&B[v.text.charAt(D)]||B[v.text.charAt(++D)];if(!v)return null;var H=">"==v.charAt(1)?1:-1;if(n&&0<H!=(D==l.ch))return null;n=f.getTokenTypeAt(y(l.line,D+1));f=I(f,y(l.line,D+(0<H?1:0)),H,n||null,s);return null==f?null:{from:y(l.line,D),
to:f&&f.pos,match:f&&f.ch==v.charAt(0),forward:0<H}}function I(f,l,n,s,v){var D=v&&v.maxScanLineLength||1E4,H=v&&v.maxScanLines||1E3,C=[];v=v&&v.bracketRegex?v.bracketRegex:/[(){}[\]]/;for(var H=0<n?Math.min(l.line+H,f.lastLine()+1):Math.max(f.firstLine()-1,l.line-H),u=l.line;u!=H;u+=n){var S=f.getLine(u);if(S){var I=0<n?0:S.length-1,G=0<n?S.length:-1;if(!(S.length>D))for(u==l.line&&(I=l.ch-(0>n?1:0));I!=G;I+=n){var fa=S.charAt(I);if(v.test(fa)&&(void 0===s||f.getTokenTypeAt(y(u,I+1))==s))if(">"==
B[fa].charAt(1)==0<n)C.push(fa);else if(C.length)C.pop();else return{pos:y(u,I),ch:fa}}}}return u-n==(0<n?f.lastLine():f.firstLine())?!1:null}function l(f,l,s){for(var B=f.state.matchBrackets.maxHighlightLineLength||1E3,v=[],D=f.listSelections(),H=0;H<D.length;H++){var C=D[H].empty()&&G(f,D[H].head,!1,s);if(C&&f.getLine(C.from.line).length<=B){var u=C.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";v.push(f.markText(C.from,y(C.from.line,C.from.ch+1),{className:u}));C.to&&f.getLine(C.to.line).length<=
B&&v.push(f.markText(C.to,y(C.to.line,C.to.ch+1),{className:u}))}}if(v.length)if(n&&f.state.focused&&f.focus(),s=function(){f.operation(function(){for(var f=0;f<v.length;f++)v[f].clear()})},l)setTimeout(s,800);else return s}function s(f){f.operation(function(){H&&(H(),H=null);H=l(f,!1,f.state.matchBrackets)})}var n=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),y=f.Pos,B={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},H=null;f.defineOption("matchBrackets",
!1,function(l,n,x){x&&x!=f.Init&&l.off("cursorActivity",s);n&&(l.state.matchBrackets="object"==typeof n?n:{},l.on("cursorActivity",s))});f.defineExtension("matchBrackets",function(){l(this,!0)});f.defineExtension("findMatchingBracket",function(f,l,n){return G(this,f,l,n)});f.defineExtension("scanForBracket",function(f,l,n,s){return I(this,f,l,n,s)})});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){f.defineOption("showTrailingSpace",!1,function(G,I,l){l==f.Init&&(l=!1);l&&!I?G.removeOverlay("trailingspace"):!l&&I&&G.addOverlay({token:function(f){for(var l=f.string.length,y=l;y&&/\s/.test(f.string.charAt(y-1));--y);if(y>f.pos)return f.pos=y,null;f.pos=l;return"trailingspace"},name:"trailingspace"})})});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,l){function s(f){clearTimeout(n.doRedraw);n.doRedraw=setTimeout(function(){n.redraw()},f)}this.cm=f;this.options=l;this.buttonHeight=l.scrollButtonHeight||f.getOption("scrollButtonHeight");this.annotations=[];this.doRedraw=this.doUpdate=null;this.div=f.getWrapperElement().appendChild(document.createElement("div"));
this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none";this.computeScale();var n=this;f.on("refresh",this.resizeHandler=function(){clearTimeout(n.doUpdate);n.doUpdate=setTimeout(function(){n.computeScale()&&s(20)},100)});f.on("markerAdded",this.resizeHandler);f.on("markerCleared",this.resizeHandler);if(!1!==l.listenForChanges)f.on("change",this.changeHandler=function(){s(250)})}f.defineExtension("annotateScrollbar",function(f){"string"==typeof f&&(f={className:f});
return new G(this,f)});f.defineOption("scrollButtonHeight",0);G.prototype.computeScale=function(){var f=this.cm,f=(f.getWrapperElement().clientHeight-f.display.barHeight-2*this.buttonHeight)/f.heightAtLine(f.lastLine()+1,"local");if(f!=this.hScale)return this.hScale=f,!0};G.prototype.update=function(f){this.annotations=f;this.redraw()};G.prototype.redraw=function(f){function l(f,l){w!=f.line&&(w=f.line,r=s.getLineHandle(w));return B&&r.height>H?s.charCoords(f,"local")[l?"top":"bottom"]:s.heightAtLine(r,
"local")+(l?0:r.height)}!1!==f&&this.computeScale();var s=this.cm;f=this.hScale;var n=document.createDocumentFragment(),y=this.annotations,B=s.getOption("lineWrapping"),H=B&&1.5*s.defaultTextHeight(),w=null,r=null;if(s.display.barWidth)for(var x=0,T;x<y.length;x++){for(var v=y[x],D=T||l(v.from,!0)*f,v=l(v.to,!1)*f;x<y.length-1;){T=l(y[x+1].from,!0)*f;if(T>v+.9)break;v=y[++x];v=l(v.to,!1)*f}if(v!=D){var v=Math.max(v-D,3),G=n.appendChild(document.createElement("div"));G.style.cssText="position: absolute; right: 0px; width: "+
Math.max(s.display.barWidth-1,2)+"px; top: "+(D+this.buttonHeight)+"px; height: "+v+"px";G.className=this.options.className}}this.div.textContent="";this.div.appendChild(n)};G.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler);this.cm.off("markerAdded",this.resizeHandler);this.cm.off("markerCleared",this.resizeHandler);this.changeHandler&&this.cm.off("change",this.changeHandler);this.div.parentNode.removeChild(this.div)}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(l,s,n){function y(l){var n=f.wheelEventPixels(l)["horizontal"==B.orientation?"x":"y"],r=B.pos;B.moveTo(B.pos+n);B.pos!=r&&f.e_preventDefault(l)}this.orientation=s;this.scroll=n;this.screen=this.total=this.size=1;this.pos=0;this.node=document.createElement("div");this.node.className=l+"-"+s;
this.inner=this.node.appendChild(document.createElement("div"));var B=this;f.on(this.inner,"mousedown",function(l){function n(){f.off(document,"mousemove",r);f.off(document,"mouseup",n)}function r(f){if(1!=f.which)return n();B.moveTo(v+B.total/B.size*(f[s]-y))}if(1==l.which){f.e_preventDefault(l);var s="horizontal"==B.orientation?"pageX":"pageY",y=l[s],v=B.pos;f.on(document,"mousemove",r);f.on(document,"mouseup",n)}});f.on(this.node,"click",function(l){f.e_preventDefault(l);var n=B.inner.getBoundingClientRect();
B.moveTo(B.pos+("horizontal"==B.orientation?l.clientX<n.left?-1:l.clientX>n.right?1:0:l.clientY<n.top?-1:l.clientY>n.bottom?1:0)*B.screen)});f.on(this.node,"mousewheel",y);f.on(this.node,"DOMMouseScroll",y)}function I(f,s,n){this.addClass=f;this.horiz=new G(f,"horizontal",n);s(this.horiz.node);this.vert=new G(f,"vertical",n);s(this.vert.node);this.width=null}G.prototype.moveTo=function(f,s){0>f&&(f=0);f>this.total-this.screen&&(f=this.total-this.screen);f!=this.pos&&(this.pos=f,this.inner.style["horizontal"==
this.orientation?"left":"top"]=this.size/this.total*f+"px",!1!==s&&this.scroll(f,this.orientation))};G.prototype.update=function(f,s,n){this.screen=s;this.total=f;this.size=n;f=this.size/this.total*this.screen;10>f&&(this.size-=10-f,f=10);this.inner.style["horizontal"==this.orientation?"width":"height"]=f+"px";this.inner.style["horizontal"==this.orientation?"left":"top"]=this.size/this.total*this.pos+"px"};I.prototype.update=function(f){if(null==this.width){var s=window.getComputedStyle?window.getComputedStyle(this.horiz.node):
this.horiz.node.currentStyle;s&&(this.width=parseInt(s.height))}var s=this.width||0,n=f.scrollWidth>f.clientWidth+1,y=f.scrollHeight>f.clientHeight+1;this.vert.node.style.display=y?"block":"none";this.horiz.node.style.display=n?"block":"none";y&&(this.vert.update(f.scrollHeight,f.clientHeight,f.viewHeight-(n?s:0)),this.vert.node.style.display="block",this.vert.node.style.bottom=n?s+"px":"0");n&&(this.horiz.update(f.scrollWidth,f.clientWidth,f.viewWidth-(y?s:0)-f.barLeft),this.horiz.node.style.right=
y?s+"px":"0",this.horiz.node.style.left=f.barLeft+"px");return{right:y?s:0,bottom:n?s:0}};I.prototype.setScrollTop=function(f){this.vert.moveTo(f,!1)};I.prototype.setScrollLeft=function(f){this.horiz.moveTo(f,!1)};I.prototype.clear=function(){var f=this.horiz.node.parentNode;f.removeChild(this.horiz.node);f.removeChild(this.vert.node)};f.scrollbarModel.simple=function(f,s){return new I("CodeMirror-simplescroll",f,s)};f.scrollbarModel.overlay=function(f,s){return new I("CodeMirror-overlayscroll",f,
s)}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],f):f(CodeMirror)})(function(f){function G(f,s,n,y){this.cm=f;this.options=y;var B={listenForChanges:!1},H;for(H in y)B[H]=y[H];B.className||(B.className="CodeMirror-search-match");this.annotation=f.annotateScrollbar(B);this.query=
s;this.caseFold=n;this.gap={from:f.firstLine(),to:f.lastLine()+1};this.matches=[];this.update=null;this.findMatches();this.annotation.update(this.matches);var w=this;f.on("change",this.changeHandler=function(f,l){w.onChange(l)})}function I(f,s,n){return f<=s?f:Math.max(s,f+n)}f.defineExtension("showMatchesOnScrollbar",function(f,s,n){"string"==typeof n&&(n={className:n});n||(n={});return new G(this,f,s,n)});G.prototype.findMatches=function(){if(this.gap){for(var l=0;l<this.matches.length;l++){var s=
this.matches[l];if(s.from.line>=this.gap.to)break;s.to.line>=this.gap.from&&this.matches.splice(l--,1)}for(var n=this.cm.getSearchCursor(this.query,f.Pos(this.gap.from,0),this.caseFold),y=this.options&&this.options.maxMatches||1E3;n.findNext();){s={from:n.from(),to:n.to()};if(s.from.line>=this.gap.to)break;this.matches.splice(l++,0,s);if(this.matches.length>y)break}this.gap=null}};G.prototype.onChange=function(l){var s=l.from.line,n=f.changeEnd(l).line,y=n-l.to.line;this.gap?(this.gap.from=Math.min(I(this.gap.from,
s,y),l.from.line),this.gap.to=Math.max(I(this.gap.to,s,y),l.from.line)):this.gap={from:l.from.line,to:n+1};if(y)for(l=0;l<this.matches.length;l++){var n=this.matches[l],B=I(n.from.line,s,y);B!=n.from.line&&(n.from=f.Pos(B,n.from.ch));B=I(n.to.line,s,y);B!=n.to.line&&(n.to=f.Pos(B,n.to.ch))}clearTimeout(this.update);var H=this;this.update=setTimeout(function(){H.updateAfterChange()},250)};G.prototype.updateAfterChange=function(){this.findMatches();this.annotation.update(this.matches)};G.prototype.clear=
function(){this.cm.off("change",this.changeHandler);this.annotation.clear()}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,n,y,B){this.atOccurrence=!1;this.doc=f;null==B&&"string"==typeof n&&(B=!1);y=y?f.clipPos(y):l(0,0);this.pos={from:y,to:y};if("string"!=typeof n)n.global||(n=new RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(r,v){if(r){n.lastIndex=0;for(var x=f.getLine(v.line).slice(0,v.ch),
w=0,B,u;;){n.lastIndex=w;w=n.exec(x);if(!w)break;B=w;u=B.index;w=B.index+(B[0].length||1);if(w==x.length)break}(w=B&&B[0].length||0)||(0==u&&0==x.length?B=void 0:u!=f.getLine(v.line).length&&w++)}else n.lastIndex=v.ch,x=f.getLine(v.line),w=(B=n.exec(x))&&B[0].length||0,u=B&&B.index,u+w==x.length||w||(w=1);if(B&&w)return{from:l(v.line,u),to:l(v.line,u+w),match:B}};else{var H=n;B&&(n=n.toLowerCase());var w=B?function(f){return f.toLowerCase()}:function(f){return f},r=n.split("\n");if(1==r.length)this.matches=
n.length?function(r,v){if(r){var x=f.getLine(v.line).slice(0,v.ch),B=w(x),y=B.lastIndexOf(n);if(-1<y)return y=I(x,B,y),{from:l(v.line,y),to:l(v.line,y+H.length)}}else if(x=f.getLine(v.line).slice(v.ch),B=w(x),y=B.indexOf(n),-1<y)return y=I(x,B,y)+v.ch,{from:l(v.line,y),to:l(v.line,y+H.length)}}:function(){};else{var x=H.split("\n");this.matches=function(n,v){var B=r.length-1;if(n){if(!(v.line-(r.length-1)<f.firstLine())&&w(f.getLine(v.line).slice(0,x[B].length))==r[r.length-1]){for(var y=l(v.line,
x[B].length),C=v.line-1,u=B-1;1<=u;--u,--C)if(r[u]!=w(f.getLine(C)))return;var u=f.getLine(C),S=u.length-x[0].length;if(w(u.slice(S))==r[0])return{from:l(C,S),to:y}}}else if(!(v.line+(r.length-1)>f.lastLine())&&(u=f.getLine(v.line),S=u.length-x[0].length,w(u.slice(S))==r[0])){y=l(v.line,S);C=v.line+1;for(u=1;u<B;++u,++C)if(r[u]!=w(f.getLine(C)))return;if(w(f.getLine(C).slice(0,x[B].length))==r[B])return{from:y,to:l(C,x[B].length)}}}}}}function I(f,l,y){if(f.length==l.length)return y;for(l=Math.min(y,
f.length);;){var B=f.slice(0,l).toLowerCase().length;if(B<y)++l;else if(B>y)--l;else return l}}var l=f.Pos;G.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(f){function n(f){f=l(f,0);y.pos={from:f,to:f};return y.atOccurrence=!1}for(var y=this,B=this.doc.clipPos(f?this.pos.from:this.pos.to);;){if(this.pos=this.matches(f,B))return this.atOccurrence=!0,this.pos.match||!0;if(f){if(!B.line)return n(0);B=l(B.line-1,this.doc.getLine(B.line-
1).length)}else{var H=this.doc.lineCount();if(B.line==H-1)return n(H);B=l(B.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(s,n){if(this.atOccurrence){var y=f.splitLines(s);this.doc.replaceRange(y,this.pos.from,this.pos.to,n);this.pos.to=l(this.pos.from.line+y.length-1,y[y.length-1].length+(1==y.length?this.pos.from.ch:0))}}};f.defineExtension("getSearchCursor",function(f,l,y){return new G(this.doc,f,l,
y)});f.defineDocExtension("getSearchCursor",function(f,l,y){return new G(this,f,l,y)});f.defineExtension("selectMatches",function(l,n){for(var y=[],B=this.getSearchCursor(l,this.getCursor("from"),n);B.findNext()&&!(0<f.cmpPos(B.to(),this.getCursor("to")));)y.push({anchor:B.from(),head:B.to()});y.length&&this.setSelections(y,0)})});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],f):f(CodeMirror)})(function(f){function G(f,l){"string"==typeof f?f=new RegExp(f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),l?"gi":"g"):f.global||(f=new RegExp(f.source,f.ignoreCase?"gi":"g"));return{token:function(l){f.lastIndex=l.pos;
var n=f.exec(l.string);if(n&&n.index==l.pos)return l.pos+=n[0].length,"searching";n?l.pos=n.index:l.skipToEnd()}}}function I(){this.overlay=this.posFrom=this.posTo=this.lastQuery=this.query=null}function l(f){return f.state.search||(f.state.search=new I)}function s(f){return"string"==typeof f&&f==f.toLowerCase()}function n(f,l,n){return f.getSearchCursor(l,n,s(l))}function y(f,l,n,r){f.openDialog(l,r,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){D(f)}})}function B(f,l,n,r,s){f.openDialog?
f.openDialog(l,s,{value:r,selectValueOnOpen:!0}):s(prompt(n,r))}function H(f,l,n,r){if(f.openConfirm)f.openConfirm(l,r);else if(confirm(n))r[0]()}function w(f){return f.replace(/\\(.)/g,function(f,l){return"n"==l?"\n":"r"==l?"\r":l})}function r(f){var l=f.match(/^\/(.*)\/([a-z]*)$/);if(l)try{f=new RegExp(l[1],-1==l[2].indexOf("i")?"":"i")}catch(n){}else f=w(f);if("string"==typeof f?""==f:f.test(""))f=/x^/;return f}function x(f,l,n){l.queryText=n;l.query=r(n);f.removeOverlay(l.overlay,s(l.query));
l.overlay=G(l.query,s(l.query));f.addOverlay(l.overlay);f.showMatchesOnScrollbar&&(l.annotate&&(l.annotate.clear(),l.annotate=null),l.annotate=f.showMatchesOnScrollbar(l.query,s(l.query)))}function T(n,r,s){var w=l(n);if(w.query)return v(n,r);var D=n.getSelection()||w.lastQuery;if(s&&n.openDialog){var C=null;y(n,'Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',D,function(l,
r){f.e_stop(r);l&&(l!=w.queryText&&x(n,w,l),C&&(C.style.opacity=1),v(n,r.shiftKey,function(f,l){var r;3>l.line&&document.querySelector&&(r=n.display.wrapper.querySelector(".CodeMirror-dialog"))&&r.getBoundingClientRect().bottom-4>n.cursorCoords(l,"window").top&&((C=r).style.opacity=.4)}))})}else B(n,'Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',"Search for:",D,function(f){f&&
!w.query&&n.operation(function(){x(n,w,f);w.posFrom=w.posTo=n.getCursor();v(n,r)})})}function v(r,s,x){r.operation(function(){var w=l(r),v=n(r,w.query,s?w.posFrom:w.posTo);if(!v.find(s)&&(v=n(r,w.query,s?f.Pos(r.lastLine()):f.Pos(r.firstLine(),0)),!v.find(s)))return;r.setSelection(v.from(),v.to());r.scrollIntoView({from:v.from(),to:v.to()},20);w.posFrom=v.from();w.posTo=v.to();x&&x(v.from(),v.to())})}function D(f){f.operation(function(){var n=l(f);if(n.lastQuery=n.query)n.query=n.queryText=null,f.removeOverlay(n.overlay),
n.annotate&&(n.annotate.clear(),n.annotate=null)})}function aa(f,l,r){f.operation(function(){for(var s=n(f,l);s.findNext();)if("string"!=typeof l){var v=f.getRange(s.from(),s.to()).match(l);s.replace(r.replace(/\$(\d)/g,function(f,l){return v[l]}))}else s.replace(r)})}function C(f,s){if(!f.getOption("readOnly")){var v=f.getSelection()||l(f).lastQuery,x=s?"Replace all:":"Replace:";B(f,x+' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',
x,v,function(l){l&&(l=r(l),B(f,'With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',"Replace with:","",function(r){r=w(r);if(s)aa(f,l,r);else{D(f);var v=n(f,l,f.getCursor()),x=function(){var s=v.from(),w;if(!(w=v.findNext())&&(v=n(f,l),!(w=v.findNext())||s&&v.from().line==s.line&&v.from().ch==s.ch))return;f.setSelection(v.from(),v.to());f.scrollIntoView({from:v.from(),to:v.to()});H(f,"Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>",
"Replace?",[function(){B(w)},x,function(){aa(f,l,r)}])},B=function(f){v.replace("string"==typeof l?r:r.replace(/\$(\d)/g,function(l,n){return f[n]}));x()};x()}}))})}}f.commands.find=function(f){D(f);T(f)};f.commands.findPersistent=function(f){D(f);T(f,!1,!0)};f.commands.findNext=T;f.commands.findPrev=function(f){T(f,!0)};f.commands.clearSearch=D;f.commands.replace=C;f.commands.replaceAll=function(f){C(f,!0)}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f){f.operation(function(){y(f)})}function I(f){f.state.markedSelection.length&&f.operation(function(){s(f)})}function l(f,l,n,s){if(0!=w(l,n))for(var y=f.state.markedSelection,G=f.state.markedSelectionStyle,C=l.line;;){var u=C==l.line?l:H(C,0),C=C+B,I=C>=n.line,Ha=I?n:H(C,0),u=f.markText(u,
Ha,{className:G});null==s?y.push(u):y.splice(s++,0,u);if(I)break}}function s(f){f=f.state.markedSelection;for(var l=0;l<f.length;++l)f[l].clear();f.length=0}function n(f){s(f);for(var n=f.listSelections(),w=0;w<n.length;w++)l(f,n[w].from(),n[w].to())}function y(f){if(!f.somethingSelected())return s(f);if(1<f.listSelections().length)return n(f);var x=f.getCursor("start"),y=f.getCursor("end"),v=f.state.markedSelection;if(!v.length)return l(f,x,y);var D=v[0].find(),H=v[v.length-1].find();if(!D||!H||
y.line-x.line<B||0<=w(x,H.to)||0>=w(y,D.from))return n(f);for(;0<w(x,D.from);)v.shift().clear(),D=v[0].find();0>w(x,D.from)&&(D.to.line-x.line<B?(v.shift().clear(),l(f,x,D.to,0)):l(f,x,D.from,0));for(;0>w(y,H.to);)v.pop().clear(),H=v[v.length-1].find();0<w(y,H.to)&&(y.line-H.from.line<B?(v.pop().clear(),l(f,H.from,y)):l(f,H.to,y))}f.defineOption("styleSelectedText",!1,function(l,w,B){B=B&&B!=f.Init;w&&!B?(l.state.markedSelection=[],l.state.markedSelectionStyle="string"==typeof w?w:"CodeMirror-selectedtext",
n(l),l.on("cursorActivity",G),l.on("change",I)):!w&&B&&(l.off("cursorActivity",G),l.off("change",I),s(l),l.state.markedSelection=l.state.markedSelectionStyle=null)});var B=8,H=f.Pos,w=f.cmpPos});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){f.overlayMode=function(G,I,l){return{startState:function(){return{base:f.startState(G),overlay:f.startState(I),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(l){return{base:f.copyState(G,l.base),overlay:f.copyState(I,l.overlay),basePos:l.basePos,baseCur:null,overlayPos:l.overlayPos,
overlayCur:null}},token:function(f,n){if(f!=n.streamSeen||Math.min(n.basePos,n.overlayPos)<f.start)n.streamSeen=f,n.basePos=n.overlayPos=f.start;f.start==n.basePos&&(n.baseCur=G.token(f,n.base),n.basePos=f.pos);f.start==n.overlayPos&&(f.pos=f.start,n.overlayCur=I.token(f,n.overlay),n.overlayPos=f.pos);f.pos=Math.min(n.basePos,n.overlayPos);return null==n.overlayCur?n.baseCur:null!=n.baseCur&&n.overlay.combineTokens||l&&null==n.overlay.combineTokens?n.baseCur+" "+n.overlayCur:n.overlayCur},indent:G.indent&&
function(f,l){return G.indent(f.base,l)},electricChars:G.electricChars,innerMode:function(f){return{state:f.base,mode:G}},blankLine:function(f){G.blankLine&&G.blankLine(f.base);I.blankLine&&I.blankLine(f.overlay)}}}});
(function(f){"object"==typeof exports&&"object"==typeof module?f(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],f):f(CodeMirror)})(function(f){function G(f,l){if(!f.hasOwnProperty(l))throw Error("Undefined state "+l+"in simple mode");}function I(f,l){if(!f)return/(?:)/;var n="";f instanceof RegExp?(f.ignoreCase&&(n="i"),f=f.source):f=String(f);return new RegExp((!1===l?"":"^")+"(?:"+f+")",n)}function l(f,l){(f.next||f.push)&&G(l,f.next||f.push);
this.regex=I(f.regex);var n;if(n=f.token)if("string"==typeof n)n=n.replace(/\./g," ");else{for(var r=[],s=0;s<n.length;s++)r.push(n[s]&&n[s].replace(/\./g," "));n=r}else n=null;this.token=n;this.data=f}function s(l,s){return function(w,r){if(r.pending){var x=r.pending.shift();0==r.pending.length&&(r.pending=null);w.pos+=x.text.length;return x.token}if(r.local){if(r.local.end&&w.match(r.local.end))x=r.local.endToken||null,r.local=r.localState=null;else{var x=r.local.mode.token(w,r.localState),y;r.local.endScan&&
(y=r.local.endScan.exec(w.current()))&&(w.pos=w.start+y.index)}return x}for(var v=l[r.state],D=0;D<v.length;D++)if(x=v[D],y=(!x.data.sol||w.sol())&&w.match(x.regex)){x.data.next?r.state=x.data.next:x.data.push?((r.stack||(r.stack=[])).push(r.state),r.state=x.data.push):x.data.pop&&r.stack&&r.stack.length&&(r.state=r.stack.pop());if(x.data.mode){var G=s,v=r,D=x.data.mode,C=x.token,u=void 0;if(D.persistent)for(var S=v.persistentStates;S&&!u;S=S.next)if(D.spec?n(D.spec,S.spec):D.mode==S.mode)u=S;G=u?
u.mode:D.mode||f.getMode(G,D.spec);S=u?u.state:f.startState(G);D.persistent&&!u&&(v.persistentStates={mode:G,spec:D.spec,state:S,next:v.persistentStates});v.localState=S;v.local={mode:G,end:D.end&&I(D.end),endScan:D.end&&!1!==D.forceEnd&&I(D.end,!1),endToken:C&&C.join?C[C.length-1]:C}}x.data.indent&&r.indent.push(w.indentation()+s.indentUnit);x.data.dedent&&r.indent.pop();if(2<y.length){r.pending=[];for(v=2;v<y.length;v++)y[v]&&r.pending.push({text:y[v],token:x.token[v-1]});w.backUp(y[0].length-(y[1]?
y[1].length:0));return x.token[0]}return x.token&&x.token.join?x.token[0]:x.token}w.next();return null}}function n(f,l){if(f===l)return!0;if(!f||"object"!=typeof f||!l||"object"!=typeof l)return!1;var s=0,r;for(r in f)if(f.hasOwnProperty(r)){if(!l.hasOwnProperty(r)||!n(f[r],l[r]))return!1;s++}for(r in l)l.hasOwnProperty(r)&&s--;return 0==s}function y(l,n){return function(s,r,x){if(s.local&&s.local.mode.indent)return s.local.mode.indent(s.localState,r,x);if(!(x=null==s.indent||s.local)&&(x=n.dontIndentStates)){a:{x=
n.dontIndentStates;for(var y=0;y<x.length;y++)if(x[y]===s.state){x=!0;break a}x=void 0}x=-1<x}if(x)return f.Pass;x=s.indent.length-1;y=l[s.state];a:for(;;){for(var v=0;v<y.length;v++){var D=y[v];if(D.data.dedent&&!1!==D.data.dedentIfLineStart){var G=D.regex.exec(r);if(G&&G[0]){x--;if(D.next||D.push)y=l[D.next||D.push];r=r.slice(G[0].length);continue a}}}break}return 0>x?0:s.indent[x]}}f.defineSimpleMode=function(l,n){f.defineMode(l,function(l){return f.simpleMode(l,n)})};f.simpleMode=function(n,H){G(H,
"start");var w={},r=H.meta||{},x=!1,I;for(I in H)if(I!=r&&H.hasOwnProperty(I))for(var v=w[I]=[],D=H[I],aa=0;aa<D.length;aa++){var C=D[aa];v.push(new l(C,H));if(C.indent||C.dedent)x=!0}w={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:x?[]:null}},copyState:function(l){var n={state:l.state,pending:l.pending,local:l.local,localState:null,indent:l.indent&&l.indent.slice(0)};l.localState&&(n.localState=f.copyState(l.local.mode,l.localState));l.stack&&(n.stack=
l.stack.slice(0));for(var r=l.persistentStates;r;r=r.next)n.persistentStates={mode:r.mode,spec:r.spec,state:r.state==l.localState?n.localState:f.copyState(r.mode,r.state),next:n.persistentStates};return n},token:s(w,n),innerMode:function(f){return f.local&&{mode:f.local.mode,state:f.localState}},indent:y(w,r)};if(r)for(var u in r)r.hasOwnProperty(u)&&(w[u]=r[u]);return w}});
